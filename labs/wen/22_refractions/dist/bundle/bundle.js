!function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t){window.bongiovi=t("./libs/bongiovi.js"),window.Sono=t("./libs/sono.min.js"),window.params={numBalls:10,sum:0,currSum:0},function(){var e=t("./SceneApp");App=function(){var t=new bongiovi.SimpleImageLoader,e=["assets/light.jpg"];t.load(e,this,this._onImageLoaded)};var i=App.prototype;i._onImageLoaded=function(t){window.images=t,document.body?this._init():window.addEventListener("load",this._init.bind(this))},i._init=function(){this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.canvas.className="Main-Canvas",document.body.appendChild(this.canvas),bongiovi.GL.init(this.canvas),this._scene=new e,bongiovi.Scheduler.addEF(this,this._loop)},i._loop=function(){this._scene.loop()}}(),new App},{"./SceneApp":3,"./libs/bongiovi.js":8,"./libs/sono.min.js":9}],2:[function(t,e){function i(){this.axis=r.fromValues(o(-1,1),o(-.1,.1),o(-1,1)),r.normalize(this.axis,this.axis),this.angle=Math.random()*Math.PI*2,this.speed=.2*o(.01,.02),this.pos=r.fromValues(o(-1,1),o(-.25,.25),o(-1,1)),r.scale(this.pos,this.pos,o(10,300)),this.finalPos=r.create(),this.quat=n.create(),this.radius=o(.2,1.1),this.update()}var n=bongiovi.glm.quat,r=bongiovi.glm.vec3,o=function(t,e){return t+Math.random()*(e-t)},s=i.prototype;s.update=function(){return this.angle+=this.speed,n.setAxisAngle(this.quat,this.axis,this.angle),r.transformQuat(this.finalPos,this.pos,this.quat),this.finalPos},e.exports=i},{}],3:[function(t,e){function i(){n=r.gl,this.count=0,this.sum=0,this.max=0,this.easeSum=new bongiovi.EaseNumber(0,.25),bongiovi.Scene.call(this),this._initSound(),window.addEventListener("resize",this.resize.bind(this))}var n,r=bongiovi.GL,o=t("./ViewBg"),s=t("./ViewBalls"),a=t("./ViewCubes"),u=t("./ViewPost"),h=i.prototype=new bongiovi.Scene;h._initSound=function(){var t=this;this.soundOffset=0,this.preSoundOffset=0,this.sound=Sono.load({url:["assets/audio/02.mp3"],volume:1,loop:!0,onComplete:function(e){console.debug("Sound Loaded"),t.analyser=e.effect.analyser(256),e.play()}})},h._initTextures=function(){this.textureLight=new bongiovi.GLTexture(images.light),console.log("Init Textures"),this._fboBg=new bongiovi.FrameBuffer(r.width,r.height),this._fboLight=new bongiovi.FrameBuffer(r.width,r.height),this._fboNormal=new bongiovi.FrameBuffer(r.width,r.height)},h._initViews=function(){console.log("Init Views"),this._vAxis=new bongiovi.ViewAxis,this._vDotPlane=new bongiovi.ViewDotPlane,this._vCopy=new bongiovi.ViewCopy,this._vBg=new o,this._vBalls=new s,this._vCubes=new a,this._vPost=new u},h.render=function(){this.count+=.01,this._getSoundData(),this.camera._ry.value+=.1*-params.sum-.01,this.camera._rx.value=.2*Math.sin(this.count),r.setMatrices(this.camera),r.rotate(this.sceneRotation.matrix),this._fboLight.bind(),r.clear(0,0,0,0),this._vBalls.render(this.textureLight),this._vCubes.render(this.textureLight),this._fboLight.unbind(),this._fboNormal.bind(),r.clear(0,0,0,0),this._vBalls.render(this.textureLight,!0),this._vCubes.render(this.textureLight,!0),this._fboNormal.unbind(),r.setMatrices(this.cameraOrtho),r.rotate(this.rotationFront),this._fboBg.bind(),r.clear(0,0,0,0),this._vBg.render(),this._fboBg.unbind(),r.clear(0,0,0,0),n.disable(n.DEPTH_TEST),this._vCopy.render(this._fboBg.getTexture()),this._vPost.render(this._fboLight.getTexture(),this._fboNormal.getTexture(),this._fboBg.getTexture()),n.enable(n.DEPTH_TEST)},h._getSoundData=function(){if(this.analyser){this.frequencies=this.analyser.getFrequencies();for(var t=this.analyser.getFrequencies(),e=0,i=150,n=0;n<t.length;n++){e+=t[n]}e/=t.length;var r=10,o=2;params.currSum=Math.min(i,e)/i,e>r?(this.sum+=1.5*e,this.easeSum.value=.1*Math.min(this.sum,o)):this.easeSum.value=0,this.sum+=.05*-this.sum,this.sum<0&&(this.sum=0),this.sum>this.max&&(this.max=this.sum),params.sum=Math.min(this.sum,i)/i}},h.resize=function(){r.setSize(window.innerWidth,window.innerHeight),this.camera.resize(r.aspectRatio),this._fboBg=new bongiovi.FrameBuffer(r.width,r.height),this._fboLight=new bongiovi.FrameBuffer(r.width,r.height),this._fboNormal=new bongiovi.FrameBuffer(r.width,r.height)},e.exports=i},{"./ViewBalls":4,"./ViewBg":5,"./ViewCubes":6,"./ViewPost":7}],4:[function(t,e){function i(){bongiovi.View.call(this,"#define GLSLIFY 1\n\n// balls.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 position;\nuniform float scale;\nuniform vec3 axis;\nuniform float angle;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vRotateNormal;\nvarying vec3 vEye;\n\n\nvec2 rotate(vec2 p, float a) {\n	float c = cos(a);\n	float s = sin(a);\n	mat2 r = mat2(s, c, -c, s);\n	return r * p;\n}\n\nvec4 quat_from_axis_angle(vec3 axis, float angle) { \n	vec4 qr;\n	float half_angle = (angle * 0.5) * 3.14159 / 180.0;\n	qr.x = axis.x * sin(half_angle);\n	qr.y = axis.y * sin(half_angle);\n	qr.z = axis.z * sin(half_angle);\n	qr.w = cos(half_angle);\n	return qr;\n}\n\n\nvec3 rotate_vertex_position(vec3 position, vec3 axis, float angle) { \n	vec4 q = quat_from_axis_angle(axis, angle);\n	vec3 v = position.xyz;\n	return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main(void) {\n	vec3 pos = aVertexPosition*scale + position;\n	vec4 mvPosition = uMVMatrix * vec4(pos, 1.0);\n    gl_Position = uPMatrix * mvPosition;\n    vTextureCoord = aTextureCoord;\n    vNormal = normalMatrix * normalize(aVertexPosition);\n    vEye = normalize(mvPosition.xyz);\n\n    vRotateNormal = vNormal;\n    vRotateNormal.xy = rotate(vNormal.xy, angle);\n    vRotateNormal.yz = rotate(vNormal.yz, angle * .25);\n}","#define GLSLIFY 1\n\n// balls.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float exportNormal;\nvarying vec3 vNormal;\nvarying vec3 vRotateNormal;\nvarying vec3 vEye;\n\nvec3 envLight(vec3 eye, vec3 normal) {\n	vec3 r = reflect( eye, normal );\n    float m = 2. * sqrt( pow( r.x, 2. ) + pow( r.y, 2. ) + pow( r.z + 1., 2. ) );\n    vec2 vN = r.xy / m + .5;\n    vec3 color = texture2D(texture, vN).rgb;\n    color.r = pow(color.r+.2, 3.0);\n\n    return color.rrr;\n}\n\nvoid main(void) {\n	vec3 env = envLight(vEye, vNormal);\n    gl_FragColor = vec4(env, 1.0);\n\n    if(exportNormal > 0.0) {\n    	gl_FragColor.rgb = vRotateNormal * .5 + .5;\n    }\n}")}var n,r=bongiovi.GL,o=t("./Dot"),s=i.prototype=new bongiovi.View;s.constructor=i,s._init=function(){n=r.gl,this._dots=[];for(var t=0;t<params.numBalls;t++){var e=new o;this._dots.push(e)}this.mesh=bongiovi.MeshUtils.createSphere(50,36)},s.render=function(t,e){e=void 0===e?!1:e,this.shader.bind(),this.shader.uniform("texture","uniform1i",0),this.shader.uniform("exportNormal","uniform1f",e?1:0),t.bind(0);for(var i=0;i<this._dots.length;i++){var n=this._dots[i];this.shader.uniform("position","uniform3fv",n.finalPos),this.shader.uniform("axis","uniform3fv",n.axis),this.shader.uniform("angle","uniform1f",n.angle),this.shader.uniform("scale","uniform1f",n.radius),this.shader.uniform("normalMatrix","uniformMatrix3fv",r.normalMatrix),r.draw(this.mesh)}},e.exports=i},{"./Dot":2}],5:[function(t,e){function i(){this.time=255*Math.random(),bongiovi.View.call(this,null,"#define GLSLIFY 1\n\n// bg.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\n\nvec4 permute(vec4 x) { return mod(((x*34.00)+1.00)*x, 289.00); }\nvec4 taylorInvSqrt(vec4 r) { return 1.79 - 0.85 * r; }\n\nfloat snoise(vec3 v){\n	const vec2 C = vec2(1.00/6.00, 1.00/3.00) ;\n	const vec4 D = vec4(0.00, 0.50, 1.00, 2.00);\n	\n	vec3 i = floor(v + dot(v, C.yyy) );\n	vec3 x0 = v - i + dot(i, C.xxx) ;\n	\n	vec3 g = step(x0.yzx, x0.xyz);\n	vec3 l = 1.00 - g;\n	vec3 i1 = min( g.xyz, l.zxy );\n	vec3 i2 = max( g.xyz, l.zxy );\n	\n	vec3 x1 = x0 - i1 + 1.00 * C.xxx;\n	vec3 x2 = x0 - i2 + 2.00 * C.xxx;\n	vec3 x3 = x0 - 1. + 3.00 * C.xxx;\n	\n	i = mod(i, 289.00 );\n	vec4 p = permute( permute( permute( i.z + vec4(0.00, i1.z, i2.z, 1.00 )) + i.y + vec4(0.00, i1.y, i2.y, 1.00 )) + i.x + vec4(0.00, i1.x, i2.x, 1.00 ));\n	\n	float n_ = 1.00/7.00;\n	vec3 ns = n_ * D.wyz - D.xzx;\n	\n	vec4 j = p - 49.00 * floor(p * ns.z *ns.z);\n	\n	vec4 x_ = floor(j * ns.z);\n	vec4 y_ = floor(j - 7.00 * x_ );\n	\n	vec4 x = x_ *ns.x + ns.yyyy;\n	vec4 y = y_ *ns.x + ns.yyyy;\n	vec4 h = 1.00 - abs(x) - abs(y);\n	\n	vec4 b0 = vec4( x.xy, y.xy );\n	vec4 b1 = vec4( x.zw, y.zw );\n	\n	vec4 s0 = floor(b0)*2.00 + 1.00;\n	vec4 s1 = floor(b1)*2.00 + 1.00;\n	vec4 sh = -step(h, vec4(0.00));\n	\n	vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n	vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n	\n	vec3 p0 = vec3(a0.xy,h.x);\n	vec3 p1 = vec3(a0.zw,h.y);\n	vec3 p2 = vec3(a1.xy,h.z);\n	vec3 p3 = vec3(a1.zw,h.w);\n	\n	vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n	p0 *= norm.x;\n	p1 *= norm.y;\n	p2 *= norm.z;\n	p3 *= norm.w;\n	\n	vec4 m = max(0.60 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.00);\n	m = m * m;\n	return 42.00 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), dot(p2,x2), dot(p3,x3) ) );\n}\n\nfloat snoise(float x, float y, float z){\n	return snoise(vec3(x, y, z));\n}\n\n\nvec2 rotate(vec2 pos, float angle) {\n	float c = cos(angle);\n	float s = sin(angle);\n	mat2 r = mat2(s, c, -c, s);\n\n	return r*pos;\n}\n\n\nuniform float time;\nuniform float sound0;\n\nvoid main(void) {\n	vec2 uv = vTextureCoord.xy;\n	uv = rotate(uv, time * .1);\n	float g = snoise(vec3(uv.yy * (10.0-sound0*4.0), time));\n	g = smoothstep(.25, .26, g);\n    gl_FragColor = vec4(g, g, g, 1.0);\n    // gl_FragColor = vec4(g, g, g, 1.0);\n}")}var n,r=bongiovi.GL,o=i.prototype=new bongiovi.View;o.constructor=i,o._init=function(){n=r.gl,this.mesh=bongiovi.MeshUtils.createPlane(2,2,1)},o.render=function(){this.time+=.01+.01*params.sum,this.shader.bind(),this.shader.uniform("time","uniform1f",this.time),this.shader.uniform("sound0","uniform1f",params.currSum),r.draw(this.mesh)},e.exports=i},{}],6:[function(t,e){function i(){bongiovi.View.call(this,"#define GLSLIFY 1\n\n// cubes.vert\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 position;\nuniform float scale;\nuniform vec3 axis;\nuniform float angle;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vRotateNormal;\nvarying vec3 vEye;\n\n\nvec2 rotate(vec2 p, float a) {\n	float c = cos(a);\n	float s = sin(a);\n	mat2 r = mat2(s, c, -c, s);\n	return r * p;\n}\n\nvec4 quat_from_axis_angle(vec3 axis, float angle) { \n	vec4 qr;\n	float half_angle = (angle * 0.5) * 3.14159 / 180.0;\n	qr.x = axis.x * sin(half_angle);\n	qr.y = axis.y * sin(half_angle);\n	qr.z = axis.z * sin(half_angle);\n	qr.w = cos(half_angle);\n	return qr;\n}\n\n\nvec3 rotate_vertex_position(vec3 position, vec3 axis, float angle) { \n	vec4 q = quat_from_axis_angle(axis, angle);\n	vec3 v = position.xyz;\n	return v + 2.0 * cross(q.xyz, cross(q.xyz, v) + q.w * v);\n}\n\nvoid main(void) {\n	vec3 pos = aVertexPosition*scale;\n	pos = rotate_vertex_position(pos, axis, angle*20.0);\n	pos +=  position;\n	vec4 mvPosition = uMVMatrix * vec4(pos, 1.0);\n    gl_Position = uPMatrix * mvPosition;\n    vTextureCoord = aTextureCoord;\n    vec3 N = rotate_vertex_position(aNormal, axis, angle*20.0);\n    vNormal = normalMatrix * normalize(N);\n    vEye = normalize(mvPosition.xyz);\n\n    vRotateNormal = vNormal;\n    vRotateNormal.xy = rotate(vNormal.xy, angle);\n    vRotateNormal.yz = rotate(vNormal.yz, angle * .25);\n}","#define GLSLIFY 1\n\n// balls.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float exportNormal;\nvarying vec3 vNormal;\nvarying vec3 vRotateNormal;\nvarying vec3 vEye;\n\nvec3 envLight(vec3 eye, vec3 normal) {\n	vec3 r = reflect( eye, normal );\n    float m = 2. * sqrt( pow( r.x, 2. ) + pow( r.y, 2. ) + pow( r.z + 1., 2. ) );\n    vec2 vN = r.xy / m + .5;\n    vec3 color = texture2D(texture, vN).rgb;\n    color.r = pow(color.r+.2, 3.0);\n\n    return color.rrr;\n}\n\nvoid main(void) {\n	vec3 env = envLight(vEye, vNormal);\n    gl_FragColor = vec4(env, 1.0);\n\n    if(exportNormal > 0.0) {\n    	gl_FragColor.rgb = vRotateNormal * .5 + .5;\n    }\n}")}var n,r=bongiovi.GL,o=t("./Dot"),s=i.prototype=new bongiovi.View;s.constructor=i,s._init=function(){n=r.gl,this._dots=[];for(var t=0;t<params.numBalls;t++){var e=new o;this._dots.push(e)}this.mesh=bongiovi.MeshUtils.createCube(50,50,50,!0)},s.render=function(t,e){e=void 0===e?!1:e,this.shader.bind(),this.shader.uniform("texture","uniform1i",0),this.shader.uniform("exportNormal","uniform1f",e?1:0),t.bind(0);for(var i=0;i<this._dots.length;i++){var n=this._dots[i];this.shader.uniform("position","uniform3fv",n.finalPos),this.shader.uniform("axis","uniform3fv",n.axis),this.shader.uniform("angle","uniform1f",n.angle),this.shader.uniform("scale","uniform1f",n.radius),this.shader.uniform("normalMatrix","uniformMatrix3fv",r.normalMatrix),r.draw(this.mesh)}},e.exports=i},{"./Dot":2}],7:[function(t,e){function i(){bongiovi.View.call(this,null,"#define GLSLIFY 1\n\nprecision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform sampler2D textureNormal;\nuniform sampler2D textureBg;\n\nvoid main(void) {\n	vec2 uv = vTextureCoord;\n	\n	vec4 color = texture2D(texture, uv);\n	vec3 normal = texture2D(textureNormal, uv).rgb;\n	normal = (normal - .5) * 2.0;\n\n	uv += normal.rg * .2;\n	vec3 refract = texture2D(textureBg, uv).rgb;\n	color.rgb += refract;\n\n    gl_FragColor = color;\n}")}var n,r=bongiovi.GL,o=i.prototype=new bongiovi.View;o.constructor=i,o._init=function(){n=r.gl,this.mesh=bongiovi.MeshUtils.createPlane(2,2,1)},o.render=function(t,e,i){this.shader.bind(),this.shader.uniform("texture","uniform1i",0),t.bind(0),this.shader.uniform("textureNormal","uniform1i",1),e.bind(1),this.shader.uniform("textureBg","uniform1i",2),i.bind(2),r.draw(this.mesh)},e.exports=i},{}],8:[function(t,e,i){(function(n){!function(t){if("object"==typeof i&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof n?n:"undefined"!=typeof self?self:this,r.bongiovi=t()}}(function(){var e;return function i(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var h="function"==typeof t&&t;if(!u&&h)return h(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var i=e[a][1][t];return o(i?i:t)},f,f.exports,i,e,n,r)}return n[a].exports}for(var s="function"==typeof t&&t,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e){"use strict";var i=t("./bongiovi/GLTools"),n={GL:i,GLTools:i,Scheduler:t("./bongiovi/Scheduler"),SimpleImageLoader:t("./bongiovi/SimpleImageLoader"),EaseNumber:t("./bongiovi/EaseNumber"),QuatRotation:t("./bongiovi/QuatRotation"),Scene:t("./bongiovi/Scene"),Camera:t("./bongiovi/Camera"),SimpleCamera:t("./bongiovi/SimpleCamera"),CameraOrtho:t("./bongiovi/CameraOrtho"),CameraPerspective:t("./bongiovi/CameraPerspective"),Mesh:t("./bongiovi/Mesh"),Face:t("./bongiovi/Face"),GLShader:t("./bongiovi/GLShader"),GLTexture:t("./bongiovi/GLTexture"),ShaderLibs:t("./bongiovi/ShaderLibs"),View:t("./bongiovi/View"),ViewCopy:t("./bongiovi/ViewCopy"),ViewAxis:t("./bongiovi/ViewAxis"),ViewDotPlane:t("./bongiovi/ViewDotPlanes"),MeshUtils:t("./bongiovi/MeshUtils"),FrameBuffer:t("./bongiovi/FrameBuffer"),EventDispatcher:t("./bongiovi/EventDispatcher"),ObjLoader:t("./bongiovi/ObjLoader"),glm:t("gl-matrix")};e.exports=n},{"./bongiovi/Camera":3,"./bongiovi/CameraOrtho":4,"./bongiovi/CameraPerspective":5,"./bongiovi/EaseNumber":6,"./bongiovi/EventDispatcher":7,"./bongiovi/Face":8,"./bongiovi/FrameBuffer":9,"./bongiovi/GLShader":10,"./bongiovi/GLTexture":11,"./bongiovi/GLTools":12,"./bongiovi/Mesh":13,"./bongiovi/MeshUtils":14,"./bongiovi/ObjLoader":15,"./bongiovi/QuatRotation":16,"./bongiovi/Scene":17,"./bongiovi/Scheduler":18,"./bongiovi/ShaderLibs":19,"./bongiovi/SimpleCamera":20,"./bongiovi/SimpleImageLoader":21,"./bongiovi/View":22,"./bongiovi/ViewAxis":23,"./bongiovi/ViewCopy":24,"./bongiovi/ViewDotPlanes":25,"gl-matrix":2}],2:[function(t,i,r){!function(o){"use strict";var s={};"undefined"==typeof r?"function"==typeof e&&"object"==typeof e.amd&&e.amd?(s.exports={},e(function(){return s.exports})):s.exports="undefined"!=typeof window?window:o:s.exports=r,function(r){if(!o)var o=1e-6;if(!s)var s="undefined"!=typeof Float32Array?Float32Array:Array;if(!a)var a=Math.random;var u={};u.setMatrixArrayType=function(t){s=t},"undefined"!=typeof r&&(r.glMatrix=u);var h=Math.PI/180;u.toRadian=function(t){return t*h};var c={};c.create=function(){var t=new s(2);return t[0]=0,t[1]=0,t},c.clone=function(t){var e=new s(2);return e[0]=t[0],e[1]=t[1],e},c.fromValues=function(t,e){var i=new s(2);return i[0]=t,i[1]=e,i},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},c.set=function(t,e,i){return t[0]=e,t[1]=i,t},c.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},c.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},c.sub=c.subtract,c.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},c.mul=c.multiply,c.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},c.div=c.divide,c.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},c.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},c.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},c.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},c.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},c.dist=c.distance,c.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},c.sqrDist=c.squaredDistance,c.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},c.len=c.length,c.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},c.sqrLen=c.squaredLength,c.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},c.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},c.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},c.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},c.lerp=function(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t},c.random=function(t,e){e=e||1;var i=2*a()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},c.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},c.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},c.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},c.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t},c.forEach=function(){var t=c.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=2),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),c.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof r&&(r.vec2=c);var f={};f.create=function(){var t=new s(3);return t[0]=0,t[1]=0,t[2]=0,t},f.clone=function(t){var e=new s(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},f.fromValues=function(t,e,i){var n=new s(3);return n[0]=t,n[1]=e,n[2]=i,n},f.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},f.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},f.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},f.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},f.sub=f.subtract,f.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},f.mul=f.multiply,f.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},f.div=f.divide,f.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},f.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},f.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},f.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},f.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},f.dist=f.distance,f.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},f.sqrDist=f.squaredDistance,f.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},f.len=f.length,f.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},f.sqrLen=f.squaredLength,f.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},f.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},f.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},f.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2];return t[0]=r*u-o*a,t[1]=o*s-n*u,t[2]=n*a-r*s,t},f.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t},f.random=function(t,e){e=e||1;var i=2*a()*Math.PI,n=2*a()-1,r=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(i)*r,t[1]=Math.sin(i)*r,t[2]=n*e,t},f.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12],t[1]=i[1]*n+i[5]*r+i[9]*o+i[13],t[2]=i[2]*n+i[6]*r+i[10]*o+i[14],t},f.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},f.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],h=i[3],c=h*n+a*o-u*r,f=h*r+u*n-s*o,l=h*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*h+d*-s+f*-u-l*-a,t[1]=f*h+d*-a+l*-s-c*-u,t[2]=l*h+d*-u+c*-a-f*-s,t},f.rotateX=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},f.rotateY=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},f.rotateZ=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},f.forEach=function(){var t=f.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=3),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),f.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof r&&(r.vec3=f);var l={};l.create=function(){var t=new s(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},l.clone=function(t){var e=new s(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},l.fromValues=function(t,e,i,n){var r=new s(4);return r[0]=t,r[1]=e,r[2]=i,r[3]=n,r},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},l.set=function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},l.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},l.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},l.sub=l.subtract,l.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},l.mul=l.multiply,l.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},l.div=l.divide,l.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},l.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},l.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},l.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},l.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)},l.dist=l.distance,l.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o},l.sqrDist=l.squaredDistance,l.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},l.len=l.length,l.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},l.sqrLen=l.squaredLength,l.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},l.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s),t},l.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},l.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t[3]=a+n*(i[3]-a),t},l.random=function(t,e){return e=e||1,t[0]=a(),t[1]=a(),t[2]=a(),t[3]=a(),l.normalize(t,t),l.scale(t,t,e),t},l.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*s,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*s,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*s,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*s,t},l.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],h=i[3],c=h*n+a*o-u*r,f=h*r+u*n-s*o,l=h*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*h+d*-s+f*-u-l*-a,t[1]=f*h+d*-a+l*-s-c*-u,t[2]=l*h+d*-u+c*-a-f*-s,t},l.forEach=function(){var t=l.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=4),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),l.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof r&&(r.vec4=l);var d={};d.create=function(){var t=new s(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},d.clone=function(t){var e=new s(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},d.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},d.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},d.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},d.invert=function(o,s){var a=s[0],u=s[1],h=s[2],c=s[3],f=a*c-h*u;return f?(f=1/f,o[0]=c*f,o[1]=-u*f,o[2]=-h*f,o[3]=a*f,o):function(t){if("object"==typeof r&&"undefined"!=typeof i)i.exports=t();else if("function"==typeof e&&e.amd)e([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof n?n:"undefined"!=typeof self?self:this,o.bongiovi=t()}}(function(){var e;return function i(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var h="function"==typeof t&&t;if(!u&&h)return h(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var i=e[a][1][t];return o(i?i:t)},f,f.exports,i,e,n,r)}return n[a].exports}for(var s="function"==typeof t&&t,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e){var i=t("./bongiovi/GLTools"),n={GL:i,GLTools:i,Scheduler:t("./bongiovi/Scheduler"),SimpleImageLoader:t("./bongiovi/SimpleImageLoader"),EaseNumber:t("./bongiovi/EaseNumber"),QuatRotation:t("./bongiovi/QuatRotation"),Scene:t("./bongiovi/Scene"),Camera:t("./bongiovi/Camera"),SimpleCamera:t("./bongiovi/SimpleCamera"),CameraOrtho:t("./bongiovi/CameraOrtho"),CameraPerspective:t("./bongiovi/CameraPerspective"),Mesh:t("./bongiovi/Mesh"),Face:t("./bongiovi/Face"),GLShader:t("./bongiovi/GLShader"),GLTexture:t("./bongiovi/GLTexture"),ShaderLibs:t("./bongiovi/ShaderLibs"),View:t("./bongiovi/View"),ViewCopy:t("./bongiovi/ViewCopy"),ViewAxis:t("./bongiovi/ViewAxis"),ViewDotPlane:t("./bongiovi/ViewDotPlanes"),MeshUtils:t("./bongiovi/MeshUtils"),FrameBuffer:t("./bongiovi/FrameBuffer"),EventDispatcher:t("./bongiovi/EventDispatcher"),ObjLoader:t("./bongiovi/ObjLoader"),glm:t("gl-matrix")};e.exports=n},{"./bongiovi/Camera":3,"./bongiovi/CameraOrtho":4,"./bongiovi/CameraPerspective":5,"./bongiovi/EaseNumber":6,"./bongiovi/EventDispatcher":7,"./bongiovi/Face":8,"./bongiovi/FrameBuffer":9,"./bongiovi/GLShader":10,"./bongiovi/GLTexture":11,"./bongiovi/GLTools":12,"./bongiovi/Mesh":13,"./bongiovi/MeshUtils":14,"./bongiovi/ObjLoader":15,"./bongiovi/QuatRotation":16,"./bongiovi/Scene":17,"./bongiovi/Scheduler":18,"./bongiovi/ShaderLibs":19,"./bongiovi/SimpleCamera":20,"./bongiovi/SimpleImageLoader":21,"./bongiovi/View":22,"./bongiovi/ViewAxis":23,"./bongiovi/ViewCopy":24,"./bongiovi/ViewDotPlanes":25,"gl-matrix":2}],2:[function(t,i,n){!function(t){var i={};"undefined"==typeof n?"function"==typeof e&&"object"==typeof e.amd&&e.amd?(i.exports={},e(function(){return i.exports})):i.exports="undefined"!=typeof window?window:t:i.exports=n,function(t){if(!e)var e=1e-6;if(!i)var i="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var r={};r.setMatrixArrayType=function(t){i=t},"undefined"!=typeof t&&(t.glMatrix=r);var o=Math.PI/180;r.toRadian=function(t){return t*o};var s={};s.create=function(){var t=new i(2);return t[0]=0,t[1]=0,t},s.clone=function(t){var e=new i(2);return e[0]=t[0],e[1]=t[1],e},s.fromValues=function(t,e){var n=new i(2);return n[0]=t,n[1]=e,n},s.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},s.set=function(t,e,i){return t[0]=e,t[1]=i,t},s.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t},s.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t},s.sub=s.subtract,s.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t},s.mul=s.multiply,s.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t},s.div=s.divide,s.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},s.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},s.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t},s.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t},s.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(i*i+n*n)},s.dist=s.distance,s.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1];return i*i+n*n},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],i=t[1];return Math.sqrt(e*e+i*i)},s.len=s.length,s.squaredLength=function(t){var e=t[0],i=t[1];return e*e+i*i},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var i=e[0],n=e[1],r=i*i+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.cross=function(t,e,i){var n=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=n,t},s.lerp=function(t,e,i,n){var r=e[0],o=e[1];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t},s.random=function(t,e){e=e||1;var i=2*n()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},s.transformMat2=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r,t[1]=i[1]*n+i[3]*r,t},s.transformMat2d=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[2]*r+i[4],t[1]=i[1]*n+i[3]*r+i[5],t},s.transformMat3=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[3]*r+i[6],t[1]=i[1]*n+i[4]*r+i[7],t},s.transformMat4=function(t,e,i){var n=e[0],r=e[1];return t[0]=i[0]*n+i[4]*r+i[12],t[1]=i[1]*n+i[5]*r+i[13],t
},s.forEach=function(){var t=s.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=2),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!=typeof t&&(t.vec2=s);var a={};a.create=function(){var t=new i(3);return t[0]=0,t[1]=0,t[2]=0,t},a.clone=function(t){var e=new i(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},a.fromValues=function(t,e,n){var r=new i(3);return r[0]=t,r[1]=e,r[2]=n,r},a.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},a.set=function(t,e,i,n){return t[0]=e,t[1]=i,t[2]=n,t},a.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},a.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},a.sub=a.subtract,a.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t},a.mul=a.multiply,a.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},a.div=a.divide,a.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},a.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},a.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},a.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t},a.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return Math.sqrt(i*i+n*n+r*r)},a.dist=a.distance,a.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2];return i*i+n*n+r*r},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],i=t[1],n=t[2];return Math.sqrt(e*e+i*i+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],i=t[1],n=t[2];return e*e+i*i+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=i*i+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2];return t[0]=r*u-o*a,t[1]=o*s-n*u,t[2]=n*a-r*s,t},a.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t},a.random=function(t,e){e=e||1;var i=2*n()*Math.PI,r=2*n()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*o,t[1]=Math.sin(i)*o,t[2]=r*e,t},a.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12],t[1]=i[1]*n+i[5]*r+i[9]*o+i[13],t[2]=i[2]*n+i[6]*r+i[10]*o+i[14],t},a.transformMat3=function(t,e,i){var n=e[0],r=e[1],o=e[2];return t[0]=n*i[0]+r*i[3]+o*i[6],t[1]=n*i[1]+r*i[4]+o*i[7],t[2]=n*i[2]+r*i[5]+o*i[8],t},a.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],h=i[3],c=h*n+a*o-u*r,f=h*r+u*n-s*o,l=h*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*h+d*-s+f*-u-l*-a,t[1]=f*h+d*-a+l*-s-c*-u,t[2]=l*h+d*-u+c*-a-f*-s,t},a.rotateX=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0],o[1]=r[1]*Math.cos(n)-r[2]*Math.sin(n),o[2]=r[1]*Math.sin(n)+r[2]*Math.cos(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},a.rotateY=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[2]*Math.sin(n)+r[0]*Math.cos(n),o[1]=r[1],o[2]=r[2]*Math.cos(n)-r[0]*Math.sin(n),t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},a.rotateZ=function(t,e,i,n){var r=[],o=[];return r[0]=e[0]-i[0],r[1]=e[1]-i[1],r[2]=e[2]-i[2],o[0]=r[0]*Math.cos(n)-r[1]*Math.sin(n),o[1]=r[0]*Math.sin(n)+r[1]*Math.cos(n),o[2]=r[2],t[0]=o[0]+i[0],t[1]=o[1]+i[1],t[2]=o[2]+i[2],t},a.forEach=function(){var t=a.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=3),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!=typeof t&&(t.vec3=a);var u={};u.create=function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},u.clone=function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},u.fromValues=function(t,e,n,r){var o=new i(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=r,o},u.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},u.set=function(t,e,i,n,r){return t[0]=e,t[1]=i,t[2]=n,t[3]=r,t},u.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t},u.subtract=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t},u.sub=u.subtract,u.multiply=function(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t},u.mul=u.multiply,u.divide=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t},u.div=u.divide,u.min=function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},u.max=function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},u.scale=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},u.scaleAndAdd=function(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t[2]=e[2]+i[2]*n,t[3]=e[3]+i[3]*n,t},u.distance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(i*i+n*n+r*r+o*o)},u.dist=u.distance,u.squaredDistance=function(t,e){var i=e[0]-t[0],n=e[1]-t[1],r=e[2]-t[2],o=e[3]-t[3];return i*i+n*n+r*r+o*o},u.sqrDist=u.squaredDistance,u.length=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return Math.sqrt(e*e+i*i+n*n+r*r)},u.len=u.length,u.squaredLength=function(t){var e=t[0],i=t[1],n=t[2],r=t[3];return e*e+i*i+n*n+r*r},u.sqrLen=u.squaredLength,u.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},u.normalize=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s),t},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},u.lerp=function(t,e,i,n){var r=e[0],o=e[1],s=e[2],a=e[3];return t[0]=r+n*(i[0]-r),t[1]=o+n*(i[1]-o),t[2]=s+n*(i[2]-s),t[3]=a+n*(i[3]-a),t},u.random=function(t,e){return e=e||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),u.normalize(t,t),u.scale(t,t,e),t},u.transformMat4=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3];return t[0]=i[0]*n+i[4]*r+i[8]*o+i[12]*s,t[1]=i[1]*n+i[5]*r+i[9]*o+i[13]*s,t[2]=i[2]*n+i[6]*r+i[10]*o+i[14]*s,t[3]=i[3]*n+i[7]*r+i[11]*o+i[15]*s,t},u.transformQuat=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=i[0],a=i[1],u=i[2],h=i[3],c=h*n+a*o-u*r,f=h*r+u*n-s*o,l=h*o+s*r-a*n,d=-s*n-a*r-u*o;return t[0]=c*h+d*-s+f*-u-l*-a,t[1]=f*h+d*-a+l*-s-c*-u,t[2]=l*h+d*-u+c*-a-f*-s,t},u.forEach=function(){var t=u.create();return function(e,i,n,r,o,s){var a,u;for(i||(i=4),n||(n=0),u=r?Math.min(r*i+n,e.length):e.length,a=n;u>a;a+=i)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.vec4=u);var h={};h.create=function(){var t=new i(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.clone=function(t){var e=new i(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},h.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},h.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},h.transpose=function(t,e){if(t===e){var i=e[1];t[1]=e[2],t[2]=i}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},h.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*o-r*n;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-r*s,t[3]=i*s,t):null},h.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},h.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},h.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],h=i[2],c=i[3];return t[0]=n*a+o*u,t[1]=r*a+s*u,t[2]=n*h+o*c,t[3]=r*h+s*c,t},h.mul=h.multiply,h.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*a,t[1]=r*u+s*a,t[2]=n*-a+o*u,t[3]=r*-a+s*u,t},h.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1];return t[0]=n*a,t[1]=r*a,t[2]=o*u,t[3]=s*u,t},h.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},h.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},"undefined"!=typeof t&&(t.mat2=h);var c={};c.create=function(){var t=new i(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.clone=function(t){var e=new i(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},c.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},c.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},c.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=i*o-n*r;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-r*u,t[3]=i*u,t[4]=(r*a-o*s)*u,t[5]=(n*s-i*a)*u,t):null},c.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},c.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1],f=i[2],l=i[3],d=i[4],p=i[5];return t[0]=n*h+o*c,t[1]=r*h+s*c,t[2]=n*f+o*l,t[3]=r*f+s*l,t[4]=n*d+o*p+a,t[5]=r*d+s*p+u,t},c.mul=c.multiply,c.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=Math.sin(i),c=Math.cos(i);return t[0]=n*c+o*h,t[1]=r*c+s*h,t[2]=n*-h+o*c,t[3]=r*-h+s*c,t[4]=a,t[5]=u,t},c.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1];return t[0]=n*h,t[1]=r*h,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=u,t},c.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=n*h+o*c+a,t[5]=r*h+s*c+u,t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof t&&(t.mat2d=c);var f={};f.create=function(){var t=new i(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},f.clone=function(t){var e=new i(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},f.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},f.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},f.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=c*s-a*h,l=-c*o+a*u,d=h*o-s*u,p=i*f+n*l+r*d;return p?(p=1/p,t[0]=f*p,t[1]=(-c*n+r*h)*p,t[2]=(a*n-r*s)*p,t[3]=l*p,t[4]=(c*i-r*u)*p,t[5]=(-a*i+r*o)*p,t[6]=d*p,t[7]=(-h*i+n*u)*p,t[8]=(s*i-n*o)*p,t):null},f.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8];return t[0]=s*c-a*h,t[1]=r*h-n*c,t[2]=n*a-r*s,t[3]=a*u-o*c,t[4]=i*c-r*u,t[5]=r*o-i*a,t[6]=o*h-s*u,t[7]=n*u-i*h,t[8]=i*s-n*o,t},f.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8];return e*(h*o-s*u)+i*(-h*r+s*a)+n*(u*r-o*a)},f.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=i[0],d=i[1],p=i[2],v=i[3],_=i[4],m=i[5],g=i[6],x=i[7],y=i[8];return t[0]=l*n+d*s+p*h,t[1]=l*r+d*a+p*c,t[2]=l*o+d*u+p*f,t[3]=v*n+_*s+m*h,t[4]=v*r+_*a+m*c,t[5]=v*o+_*u+m*f,t[6]=g*n+x*s+y*h,t[7]=g*r+x*a+y*c,t[8]=g*o+x*u+y*f,t},f.mul=f.multiply,f.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=i[0],d=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=l*n+d*s+h,t[7]=l*r+d*a+c,t[8]=l*o+d*u+f,t},f.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=Math.sin(i),d=Math.cos(i);return t[0]=d*n+l*s,t[1]=d*r+l*a,t[2]=d*o+l*u,t[3]=d*s-l*n,t[4]=d*a-l*r,t[5]=d*u-l*o,t[6]=h,t[7]=c,t[8]=f,t},f.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},f.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},f.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,h=i*s,c=n*s,f=n*a,l=r*s,d=r*a,p=r*u,v=o*s,_=o*a,m=o*u;return t[0]=1-f-p,t[3]=c-m,t[6]=l+_,t[1]=c+m,t[4]=1-h-p,t[7]=d-v,t[2]=l-_,t[5]=d+v,t[8]=1-h-f,t},f.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15],g=i*a-n*s,x=i*u-r*s,y=i*h-o*s,T=n*u-r*a,M=n*h-o*a,b=r*h-o*u,E=c*v-f*p,w=c*_-l*p,A=c*m-d*p,R=f*_-l*v,L=f*m-d*v,P=l*m-d*_,S=g*P-x*L+y*R+T*A-M*w+b*E;return S?(S=1/S,t[0]=(a*P-u*L+h*R)*S,t[1]=(u*A-s*P-h*w)*S,t[2]=(s*L-a*A+h*E)*S,t[3]=(r*L-n*P-o*R)*S,t[4]=(i*P-r*A+o*w)*S,t[5]=(n*A-i*L-o*E)*S,t[6]=(v*b-_*M+m*T)*S,t[7]=(_*y-p*b-m*x)*S,t[8]=(p*M-v*y+m*g)*S,t):null},f.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},f.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof t&&(t.mat3=f);var l={};l.create=function(){var t=new i(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.clone=function(t){var e=new i(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},l.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15],g=i*a-n*s,x=i*u-r*s,y=i*h-o*s,T=n*u-r*a,M=n*h-o*a,b=r*h-o*u,E=c*v-f*p,w=c*_-l*p,A=c*m-d*p,R=f*_-l*v,L=f*m-d*v,P=l*m-d*_,S=g*P-x*L+y*R+T*A-M*w+b*E;return S?(S=1/S,t[0]=(a*P-u*L+h*R)*S,t[1]=(r*L-n*P-o*R)*S,t[2]=(v*b-_*M+m*T)*S,t[3]=(l*M-f*b-d*T)*S,t[4]=(u*A-s*P-h*w)*S,t[5]=(i*P-r*A+o*w)*S,t[6]=(_*y-p*b-m*x)*S,t[7]=(c*b-l*y+d*x)*S,t[8]=(s*L-a*A+h*E)*S,t[9]=(n*A-i*L-o*E)*S,t[10]=(p*M-v*y+m*g)*S,t[11]=(f*y-c*M-d*g)*S,t[12]=(a*w-s*R-u*E)*S,t[13]=(i*R-n*w+r*E)*S,t[14]=(v*x-p*T-_*g)*S,t[15]=(c*T-f*x+l*g)*S,t):null},l.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15];return t[0]=a*(l*m-d*_)-f*(u*m-h*_)+v*(u*d-h*l),t[1]=-(n*(l*m-d*_)-f*(r*m-o*_)+v*(r*d-o*l)),t[2]=n*(u*m-h*_)-a*(r*m-o*_)+v*(r*h-o*u),t[3]=-(n*(u*d-h*l)-a*(r*d-o*l)+f*(r*h-o*u)),t[4]=-(s*(l*m-d*_)-c*(u*m-h*_)+p*(u*d-h*l)),t[5]=i*(l*m-d*_)-c*(r*m-o*_)+p*(r*d-o*l),t[6]=-(i*(u*m-h*_)-s*(r*m-o*_)+p*(r*h-o*u)),t[7]=i*(u*d-h*l)-s*(r*d-o*l)+c*(r*h-o*u),t[8]=s*(f*m-d*v)-c*(a*m-h*v)+p*(a*d-h*f),t[9]=-(i*(f*m-d*v)-c*(n*m-o*v)+p*(n*d-o*f)),t[10]=i*(a*m-h*v)-s*(n*m-o*v)+p*(n*h-o*a),t[11]=-(i*(a*d-h*f)-s*(n*d-o*f)+c*(n*h-o*a)),t[12]=-(s*(f*_-l*v)-c*(a*_-u*v)+p*(a*l-u*f)),t[13]=i*(f*_-l*v)-c*(n*_-r*v)+p*(n*l-r*f),t[14]=-(i*(a*_-u*v)-s*(n*_-r*v)+p*(n*u-r*a)),t[15]=i*(a*l-u*f)-s*(n*l-r*f)+c*(n*u-r*a),t},l.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8],c=t[9],f=t[10],l=t[11],d=t[12],p=t[13],v=t[14],_=t[15],m=e*s-i*o,g=e*a-n*o,x=e*u-r*o,y=i*a-n*s,T=i*u-r*s,M=n*u-r*a,b=h*p-c*d,E=h*v-f*d,w=h*_-l*d,A=c*v-f*p,R=c*_-l*p,L=f*_-l*v;return m*L-g*R+x*A+y*w-T*E+M*b},l.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=e[9],d=e[10],p=e[11],v=e[12],_=e[13],m=e[14],g=e[15],x=i[0],y=i[1],T=i[2],M=i[3];return t[0]=x*n+y*a+T*f+M*v,t[1]=x*r+y*u+T*l+M*_,t[2]=x*o+y*h+T*d+M*m,t[3]=x*s+y*c+T*p+M*g,x=i[4],y=i[5],T=i[6],M=i[7],t[4]=x*n+y*a+T*f+M*v,t[5]=x*r+y*u+T*l+M*_,t[6]=x*o+y*h+T*d+M*m,t[7]=x*s+y*c+T*p+M*g,x=i[8],y=i[9],T=i[10],M=i[11],t[8]=x*n+y*a+T*f+M*v,t[9]=x*r+y*u+T*l+M*_,t[10]=x*o+y*h+T*d+M*m,t[11]=x*s+y*c+T*p+M*g,x=i[12],y=i[13],T=i[14],M=i[15],t[12]=x*n+y*a+T*f+M*v,t[13]=x*r+y*u+T*l+M*_,t[14]=x*o+y*h+T*d+M*m,t[15]=x*s+y*c+T*p+M*g,t},l.mul=l.multiply,l.translate=function(t,e,i){var n,r,o,s,a,u,h,c,f,l,d,p,v=i[0],_=i[1],m=i[2];return e===t?(t[12]=e[0]*v+e[4]*_+e[8]*m+e[12],t[13]=e[1]*v+e[5]*_+e[9]*m+e[13],t[14]=e[2]*v+e[6]*_+e[10]*m+e[14],t[15]=e[3]*v+e[7]*_+e[11]*m+e[15]):(n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=e[9],d=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=h,t[7]=c,t[8]=f,t[9]=l,t[10]=d,t[11]=p,t[12]=n*v+a*_+f*m+e[12],t[13]=r*v+u*_+l*m+e[13],t[14]=o*v+h*_+d*m+e[14],t[15]=s*v+c*_+p*m+e[15]),t},l.scale=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.rotate=function(t,i,n,r){var o,s,a,u,h,c,f,l,d,p,v,_,m,g,x,y,T,M,b,E,w,A,R,L,P=r[0],S=r[1],F=r[2],D=Math.sqrt(P*P+S*S+F*F);return Math.abs(D)<e?null:(D=1/D,P*=D,S*=D,F*=D,o=Math.sin(n),s=Math.cos(n),a=1-s,u=i[0],h=i[1],c=i[2],f=i[3],l=i[4],d=i[5],p=i[6],v=i[7],_=i[8],m=i[9],g=i[10],x=i[11],y=P*P*a+s,T=S*P*a+F*o,M=F*P*a-S*o,b=P*S*a-F*o,E=S*S*a+s,w=F*S*a+P*o,A=P*F*a+S*o,R=S*F*a-P*o,L=F*F*a+s,t[0]=u*y+l*T+_*M,t[1]=h*y+d*T+m*M,t[2]=c*y+p*T+g*M,t[3]=f*y+v*T+x*M,t[4]=u*b+l*E+_*w,t[5]=h*b+d*E+m*w,t[6]=c*b+p*E+g*w,t[7]=f*b+v*E+x*w,t[8]=u*A+l*R+_*L,t[9]=h*A+d*R+m*L,t[10]=c*A+p*R+g*L,t[11]=f*A+v*R+x*L,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)},l.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],s=e[5],a=e[6],u=e[7],h=e[8],c=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+h*n,t[5]=s*r+c*n,t[6]=a*r+f*n,t[7]=u*r+l*n,t[8]=h*r-o*n,t[9]=c*r-s*n,t[10]=f*r-a*n,t[11]=l*r-u*n,t},l.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],h=e[8],c=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-h*n,t[1]=s*r-c*n,t[2]=a*r-f*n,t[3]=u*r-l*n,t[8]=o*n+h*r,t[9]=s*n+c*r,t[10]=a*n+f*r,t[11]=u*n+l*r,t},l.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],h=e[4],c=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+h*n,t[1]=s*r+c*n,t[2]=a*r+f*n,t[3]=u*r+l*n,t[4]=h*r-o*n,t[5]=c*r-s*n,t[6]=f*r-a*n,t[7]=l*r-u*n,t},l.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=n+n,u=r+r,h=o+o,c=n*a,f=n*u,l=n*h,d=r*u,p=r*h,v=o*h,_=s*a,m=s*u,g=s*h;return t[0]=1-(d+v),t[1]=f+g,t[2]=l-m,t[3]=0,t[4]=f-g,t[5]=1-(c+v),t[6]=p+_,t[7]=0,t[8]=l+m,t[9]=p-_,t[10]=1-(c+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},l.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,h=i*s,c=n*s,f=n*a,l=r*s,d=r*a,p=r*u,v=o*s,_=o*a,m=o*u;return t[0]=1-f-p,t[1]=c+m,t[2]=l-_,t[3]=0,t[4]=c-m,t[5]=1-h-p,t[6]=d+v,t[7]=0,t[8]=l+_,t[9]=d-v,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},l.frustum=function(t,e,i,n,r,o,s){var a=1/(i-e),u=1/(r-n),h=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t},l.perspective=function(t,e,i,n,r){var o=1/Math.tan(e/2),s=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*s,t[15]=0,t},l.ortho=function(t,e,i,n,r,o,s){var a=1/(e-i),u=1/(n-r),h=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*u,t[14]=(s+o)*h,t[15]=1,t},l.lookAt=function(t,i,n,r){var o,s,a,u,h,c,f,d,p,v,_=i[0],m=i[1],g=i[2],x=r[0],y=r[1],T=r[2],M=n[0],b=n[1],E=n[2];return Math.abs(_-M)<e&&Math.abs(m-b)<e&&Math.abs(g-E)<e?l.identity(t):(f=_-M,d=m-b,p=g-E,v=1/Math.sqrt(f*f+d*d+p*p),f*=v,d*=v,p*=v,o=y*p-T*d,s=T*f-x*p,a=x*d-y*f,v=Math.sqrt(o*o+s*s+a*a),v?(v=1/v,o*=v,s*=v,a*=v):(o=0,s=0,a=0),u=d*a-p*s,h=p*o-f*a,c=f*s-d*o,v=Math.sqrt(u*u+h*h+c*c),v?(v=1/v,u*=v,h*=v,c*=v):(u=0,h=0,c=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=s,t[5]=h,t[6]=d,t[7]=0,t[8]=a,t[9]=c,t[10]=p,t[11]=0,t[12]=-(o*_+s*m+a*g),t[13]=-(u*_+h*m+c*g),t[14]=-(f*_+d*m+p*g),t[15]=1,t)},l.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof t&&(t.mat4=l);var d={};d.create=function(){var t=new i(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),i=a.fromValues(0,1,0);return function(n,r,o){var s=a.dot(r,o);return-.999999>s?(a.cross(t,e,r),a.length(t)<1e-6&&a.cross(t,i,r),a.normalize(t,t),d.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(a.cross(t,r,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,d.normalize(n,n))}}(),d.setAxes=function(){var t=f.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],d.normalize(e,d.fromMat3(e,t))}}(),d.clone=u.clone,d.fromValues=u.fromValues,d.copy=u.copy,d.set=u.set,d.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},d.setAxisAngle=function(t,e,i){i=.5*i;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},d.add=u.add,d.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],h=i[2],c=i[3];return t[0]=n*c+s*a+r*h-o*u,t[1]=r*c+s*u+o*a-n*h,t[2]=o*c+s*h+n*u-r*a,t[3]=s*c-n*a-r*u-o*h,t},d.mul=d.multiply,d.scale=u.scale,d.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+s*a,t[1]=r*u+o*a,t[2]=o*u-r*a,t[3]=s*u-n*a,t},d.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u-o*a,t[1]=r*u+s*a,t[2]=o*u+n*a,t[3]=s*u-r*a,t},d.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+r*a,t[1]=r*u-n*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t},d.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},d.dot=u.dot,d.lerp=u.lerp,d.slerp=function(t,e,i,n){var r,o,s,a,u,h=e[0],c=e[1],f=e[2],l=e[3],d=i[0],p=i[1],v=i[2],_=i[3];return o=h*d+c*p+f*v+l*_,0>o&&(o=-o,d=-d,p=-p,v=-v,_=-_),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-n)*r)/s,u=Math.sin(n*r)/s):(a=1-n,u=n),t[0]=a*h+u*d,t[1]=a*c+u*p,t[2]=a*f+u*v,t[3]=a*l+u*_,t},d.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o,a=s?1/s:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=o*a,t},d.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},d.length=u.length,d.len=d.length,d.squaredLength=u.squaredLength,d.sqrLen=d.squaredLength,d.normalize=u.normalize,d.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[7]-e[5])*i,t[1]=(e[2]-e[6])*i,t[2]=(e[3]-e[1])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*s+o]-e[3*o+s])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[s]=(e[3*s+r]+e[3*r+s])*i}return t},d.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof t&&(t.quat=d)}(i.exports)}(this)},{}],3:[function(t,e){var i=t("gl-matrix"),n=function(){this.matrix=i.mat4.create(),i.mat4.identity(this.matrix),this.position=i.vec3.create()},r=n.prototype;r.lookAt=function(t,e,n){i.vec3.copy(this.position,t),i.mat4.identity(this.matrix),i.mat4.lookAt(this.matrix,t,e,n)},r.getMatrix=function(){return this.matrix},e.exports=n},{"gl-matrix":2}],4:[function(t,e){var i=t("./Camera"),n=t("gl-matrix"),r=function(){i.call(this);var t=n.vec3.clone([0,0,500]),e=n.vec3.create(),r=n.vec3.clone([0,-1,0]);this.lookAt(t,e,r),this.projection=n.mat4.create()},o=r.prototype=new i;o.setBoundary=function(t,e,i,r){this.left=t,this.right=e,this.top=i,this.bottom=r,n.mat4.ortho(this.projection,t,e,i,r,0,1e4)},o.ortho=o.setBoundary,o.getMatrix=function(){return this.matrix},o.resize=function(){n.mat4.ortho(this.projection,this.left,this.right,this.top,this.bottom,0,1e4)},e.exports=r},{"./Camera":3,"gl-matrix":2}],5:[function(t,e){var i=t("./Camera"),n=t("gl-matrix"),r=function(){i.call(this),this.projection=n.mat4.create(),this.mtxFinal=n.mat4.create()},o=r.prototype=new i;o.setPerspective=function(t,e,i,r){this._fov=t,this._near=i,this._far=r,this._aspect=e,n.mat4.perspective(this.projection,t,e,i,r)},o.getMatrix=function(){return this.matrix},o.resize=function(t){this._aspect=t,n.mat4.perspective(this.projection,this._fov,t,this._near,this._far)},o.__defineGetter__("near",function(){return this._near}),o.__defineGetter__("far",function(){return this._far}),e.exports=r},{"./Camera":3,"gl-matrix":2}],6:[function(t,e){function i(t,e){this._easing=e||.1,this._value=t,this._targetValue=t,n.addEF(this,this._update)}var n=t("./Scheduler"),r=i.prototype;r._update=function(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this._easing},r.setTo=function(t){this._targetValue=this._value=t},r.add=function(t){this._targetValue+=t},r.limit=function(t,e){this._min=t,this._max=e,this._checkLimit()},r.setEasing=function(t){this._easing=t},r._checkLimit=function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)},r.__defineGetter__("value",function(){return this._value}),r.__defineGetter__("targetValue",function(){return this._targetValue}),r.__defineSetter__("value",function(t){this._targetValue=t}),e.exports=i},{"./Scheduler":18}],7:[function(t,e){function i(){this._eventListeners=null}var n=!0;try{var r=document.createEvent("CustomEvent");r=null}catch(o){n=!1}var s=i.prototype;s.addEventListener=function(t,e){return null===this._eventListeners&&(this._eventListeners={}),this._eventListeners[t]||(this._eventListeners[t]=[]),this._eventListeners[t].push(e),this},s.removeEventListener=function(t,e){null===this._eventListeners&&(this._eventListeners={});var i=this._eventListeners[t];if("undefined"==typeof i)return this;for(var n=i.length,r=0;n>r;r++)i[r]===e&&(i.splice(r,1),r--,n--);return this},s.dispatchEvent=function(t){null===this._eventListeners&&(this._eventListeners={});var e=t.type;try{null===t.target&&(t.target=this),t.currentTarget=this}catch(i){var n={type:e,detail:t.detail,dispatcher:this};return this.dispatchEvent(n)}var r=this._eventListeners[e];if(null!==r&&void 0!==r)for(var o=this._copyArray(r),s=o.length,a=0;s>a;a++){var u=o[a];u.call(this,t)}return this},s.dispatchCustomEvent=function(t,e){var i;return n?(i=document.createEvent("CustomEvent"),i.dispatcher=this,i.initCustomEvent(t,!1,!1,e)):i={type:t,detail:e,dispatcher:this},this.dispatchEvent(i)},s._destroy=function(){if(null!==this._eventListeners){for(var t in this._eventListeners)if(this._eventListeners.hasOwnProperty(t)){for(var e=this._eventListeners[t],i=e.length,n=0;i>n;n++)e[n]=null;delete this._eventListeners[t]}this._eventListeners=null}},s._copyArray=function(t){for(var e=new Array(t.length),i=e.length,n=0;i>n;n++)e[n]=t[n];return e},e.exports=i},{}],8:[function(t,e){var i=t("gl-matrix"),n=function(t,e,i){this._vertexA=t,this._vertexB=e,this._vertexC=i,this._init()},r=n.prototype;r._init=function(){var t=i.vec3.create(),e=i.vec3.create();i.vec3.sub(t,this._vertexB,this._vertexA),i.vec3.sub(e,this._vertexC,this._vertexA),this._faceNormal=i.vec3.create(),i.vec3.cross(this._faceNormal,t,e),i.vec3.normalize(this._faceNormal,this._faceNormal)},r.contains=function(t){return o(t,this._vertexA)||o(t,this._vertexB)||o(t,this._vertexC)},r.__defineGetter__("faceNormal",function(){return this._faceNormal});var o=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]};e.exports=n},{"gl-matrix":2}],9:[function(t,e){var i,n=t("./GLTools"),r=t("./GLTexture"),o=function(t){return 0!==t&&!(t&t-1)},s=function(t,e,r){i=n.gl,r=r||{},this.width=t,this.height=e,this.magFilter=r.magFilter||i.LINEAR,this.minFilter=r.minFilter||i.LINEAR,this.wrapS=r.wrapS||i.MIRRORED_REPEAT,this.wrapT=r.wrapT||i.MIRRORED_REPEAT,o(t)&&o(e)||(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)),this._init()},a=s.prototype;a._init=function(){if(this.texture=i.createTexture(),this.glTexture=new r(this.texture,!0),this.frameBuffer=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer),this.frameBuffer.width=this.width,this.frameBuffer.height=this.height,i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n.depthTextureExt?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,i.RGBA,i.FLOAT,null):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,i.RGBA,i.FLOAT,null),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0),null===n.depthTextureExt){var t=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,t),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,this.frameBuffer.width,this.frameBuffer.height),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,t)}else this.depthTexture=i.createTexture(),this.glDepthTexture=new r(this.depthTexture,!0),i.bindTexture(i.TEXTURE_2D,this.depthTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,i.DEPTH_COMPONENT,this.width,this.height,0,i.DEPTH_COMPONENT,i.UNSIGNED_SHORT,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,this.depthTexture,0);i.bindTexture(i.TEXTURE_2D,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null)},a.bind=function(){i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer)},a.unbind=function(){i.bindFramebuffer(i.FRAMEBUFFER,null)
},a.getTexture=function(){return this.glTexture},a.getDepthTexture=function(){return this.glDepthTexture},a.destroy=function(){i.deleteFramebuffer(this.frameBuffer),this.glTexture.destroy(),this.glDepthTexture&&this.glDepthTexture.destroy()},e.exports=s},{"./GLTexture":11,"./GLTools":12}],10:[function(t,e){var i,n=t("./GLTools"),r=t("./ShaderLibs"),o=function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")},s=function(t,e){i=n.gl,this.idVertex=t,this.idFragment=e,this.parameters=[],this.uniformValues={},this.uniformTextures=[],this.vertexShader=void 0,this.fragmentShader=void 0,this._isReady=!1,this._loadedCount=0,(void 0===t||null===t)&&this.createVertexShaderProgram(r.getShader("copyVert")),(void 0===e||null===t)&&this.createFragmentShaderProgram(r.getShader("copyFrag")),this.init()},a=s.prototype;a.init=function(){this.idVertex&&this.idVertex.indexOf("main(void)")>-1?this.createVertexShaderProgram(this.idVertex):this.getShader(this.idVertex,!0),this.idFragment&&this.idFragment.indexOf("main(void)")>-1?this.createFragmentShaderProgram(this.idFragment):this.getShader(this.idFragment,!1)},a.getShader=function(t,e){if(t){var i=new XMLHttpRequest;i.hasCompleted=!1;var n=this;i.onreadystatechange=function(t){4===t.target.readyState&&(e?n.createVertexShaderProgram(t.target.responseText):n.createFragmentShaderProgram(t.target.responseText))},i.open("GET",t,!0),i.send(null)}},a.createVertexShaderProgram=function(t){if(i){var e=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(e,t),i.compileShader(e),!i.getShaderParameter(e,i.COMPILE_STATUS))return console.warn("Error in Vertex Shader : ",this.idVertex,":",i.getShaderInfoLog(e)),console.log(o(t)),null;this.vertexShader=e,void 0!==this.vertexShader&&void 0!==this.fragmentShader&&this.attachShaderProgram(),this._loadedCount++}},a.createFragmentShaderProgram=function(t){if(i){var e=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(e,t),i.compileShader(e),!i.getShaderParameter(e,i.COMPILE_STATUS))return console.warn("Error in Fragment Shader: ",this.idFragment,":",i.getShaderInfoLog(e)),console.log(o(t)),null;this.fragmentShader=e,void 0!==this.vertexShader&&void 0!==this.fragmentShader&&this.attachShaderProgram(),this._loadedCount++}},a.attachShaderProgram=function(){this._isReady=!0,this.shaderProgram=i.createProgram(),i.attachShader(this.shaderProgram,this.vertexShader),i.attachShader(this.shaderProgram,this.fragmentShader),i.linkProgram(this.shaderProgram)},a.bind=function(){this._isReady&&(i.useProgram(this.shaderProgram),void 0===this.shaderProgram.pMatrixUniform&&(this.shaderProgram.pMatrixUniform=i.getUniformLocation(this.shaderProgram,"uPMatrix")),void 0===this.shaderProgram.mvMatrixUniform&&(this.shaderProgram.mvMatrixUniform=i.getUniformLocation(this.shaderProgram,"uMVMatrix")),n.setShader(this),n.setShaderProgram(this.shaderProgram),this.uniformTextures=[])},a.isReady=function(){return this._isReady},a.clearUniforms=function(){this.parameters=[],this.uniformValues={}},a.uniform=function(t,e,n){if(this._isReady){"texture"===e&&(e="uniform1i");for(var r,o=!1,s=0;s<this.parameters.length;s++)if(r=this.parameters[s],r.name===t){r.value=n,o=!0;break}if(o?this.shaderProgram[t]=r.uniformLoc:(this.shaderProgram[t]=i.getUniformLocation(this.shaderProgram,t),this.parameters.push({name:t,type:e,value:n,uniformLoc:this.shaderProgram[t]})),-1===e.indexOf("Matrix"))if(o)this.checkUniform(t,e,n)&&i[e](this.shaderProgram[t],n);else{var a=Array.isArray(n);this.uniformValues[t]=a?n.concat():n,i[e](this.shaderProgram[t],n)}else i[e](this.shaderProgram[t],!1,n),o||(i[e](this.shaderProgram[t],!1,n),this.uniformValues[t]=n);"uniform1i"===e&&(this.uniformTextures[n]=this.shaderProgram[t])}},a.checkUniform=function(t,e,i){var n=Array.isArray(i);if(!this.uniformValues[t])return this.uniformValues[t]=i,!0;if("uniform1i"===e)return this.uniformValues[t]=i,!0;var r=this.uniformValues[t],o=!1;if(n){for(var s=0;s<r.length;s++)if(r[s]!==i[s]){o=!0;break}}else o=r!==i;return o&&(this.uniformValues[t]=n?i.concat():i),o},a.unbind=function(){},a.destroy=function(){i.detachShader(this.shaderProgram,this.vertexShader),i.detachShader(this.shaderProgram,this.fragmentShader),i.deleteShader(this.vertexShader),i.deleteShader(this.fragmentShader),i.deleteProgram(this.shaderProgram)},e.exports=s},{"./GLTools":12,"./ShaderLibs":19}],11:[function(t,e){var i,n=t("./GLTools"),r=function(t){var e=0!==t&&!(t&t-1);return e},o=function(t){var e=t.width||t.videoWidth,i=t.height||t.videoHeight;return e&&i?r(e)&&r(i):!1},s=function(t,e,r){if(e=e||!1,r=r||{},i=n.gl,e)this.texture=t;else{this._source=t,this.texture=i.createTexture(),this._isVideo="VIDEO"===t.tagName,this.magFilter=r.magFilter||i.LINEAR,this.minFilter=r.minFilter||i.LINEAR_MIPMAP_NEAREST,this.wrapS=r.wrapS||i.MIRRORED_REPEAT,this.wrapT=r.wrapT||i.MIRRORED_REPEAT;var s=t.width||t.videoWidth;s?o(t)||(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)):(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,this.wrapS),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,this.wrapT),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)}},a=s.prototype;a.updateTexture=function(t){t&&(this._source=t),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)},a.bind=function(t){void 0===t&&(t=0),n.shader&&(i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,this.texture),i.uniform1i(n.shader.uniformTextures[t],t),this._bindIndex=t)},a.unbind=function(){i.bindTexture(i.TEXTURE_2D,null)},a.destroy=function(){i.deleteTexture(this.texture)},e.exports=s},{"./GLTools":12}],12:[function(t,e){function i(){this.aspectRatio=1,this.fieldOfView=45,this.zNear=5,this.zFar=3e3,this.canvas=null,this.gl=null,this.shader=null,this.shaderProgram=null}var n=t("gl-matrix"),r=i.prototype;r.init=function(t,e,i,r){null===this.canvas&&(this.canvas=t||document.createElement("canvas"));var o=r||{};o.antialias=!0,this.gl=this.canvas.getContext("webgl",o)||this.canvas.getContext("experimental-webgl",o),console.log("GL TOOLS : ",this.gl),void 0!==e&&void 0!==i?this.setSize(e,i):this.setSize(window.innerWidth,window.innerHeight),this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,1),this.gl.clearDepth(1),this.matrix=n.mat4.create(),n.mat4.identity(this.matrix),this.normalMatrix=n.mat3.create(),this.depthTextureExt=this.gl.getExtension("WEBKIT_WEBGL_depth_texture"),this.floatTextureExt=this.gl.getExtension("OES_texture_float"),this.floatTextureLinearExt=this.gl.getExtension("OES_texture_float_linear"),this.standardDerivativesExt=this.gl.getExtension("OES_standard_derivatives"),this.enabledVertexAttribute=[],this.enableAlphaBlending(),this._viewport=[0,0,this.width,this.height]},r.getGL=function(){return this.gl},r.setShader=function(t){this.shader=t},r.setShaderProgram=function(t){this.shaderProgram=t},r.setViewport=function(t,e,i,n){var r=!1;t!==this._viewport[0]&&(r=!0),e!==this._viewport[1]&&(r=!0),i!==this._viewport[2]&&(r=!0),n!==this._viewport[3]&&(r=!0),r&&(this.gl.viewport(t,e,i,n),this._viewport=[t,e,i,n])},r.setMatrices=function(t){this.camera=t},r.rotate=function(t){n.mat4.copy(this.matrix,t),n.mat4.multiply(this.matrix,this.camera.getMatrix(),this.matrix),n.mat3.fromMat4(this.normalMatrix,this.matrix),n.mat3.invert(this.normalMatrix,this.normalMatrix),n.mat3.transpose(this.normalMatrix,this.normalMatrix)},r.enableAlphaBlending=function(){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)},r.enableAdditiveBlending=function(){this.gl.blendFunc(this.gl.ONE,this.gl.ONE)},r.clear=function(t,e,i,n){this.gl.clearColor(t,e,i,n),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)},r.draw=function(t){function e(t,e,i){return void 0===e.cacheAttribLoc&&(e.cacheAttribLoc={}),void 0===e.cacheAttribLoc[i]&&(e.cacheAttribLoc[i]=t.getAttribLocation(e,i)),e.cacheAttribLoc[i]}if(!this.shaderProgram)return void console.warn("Shader program not ready yet");if(this.shaderProgram.pMatrixValue){var i=this.camera.projection||this.camera.getMatrix();n.mat4.str(this.shaderProgram.pMatrixValue)!==n.mat4.str(i)&&(this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.camera.projection||this.camera.getMatrix()),n.mat4.copy(this.shaderProgram.pMatrixValue,i))}else this.shaderProgram.pMatrixValue=n.mat4.create(),this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.camera.projection||this.camera.getMatrix()),n.mat4.copy(this.shaderProgram.pMatrixValue,this.camera.projection||this.camera.getMatrix());this.shaderProgram.mvMatrixValue?n.mat4.str(this.shaderProgram.mvMatrixValue)!==n.mat4.str(this.matrix)&&(this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix),n.mat4.copy(this.shaderProgram.mvMatrixValue,this.matrix)):(this.shaderProgram.mvMatrixValue=n.mat4.create(),this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix),n.mat4.copy(this.shaderProgram.mvMatrixValue,this.matrix)),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.vBufferPos);var r=e(this.gl,this.shaderProgram,"aVertexPosition");this.gl.vertexAttribPointer(r,t.vBufferPos.itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(r)&&(this.gl.enableVertexAttribArray(r),this.enabledVertexAttribute.push(r)),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.vBufferUV);var o=e(this.gl,this.shaderProgram,"aTextureCoord");this.gl.vertexAttribPointer(o,t.vBufferUV.itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(o)&&(this.gl.enableVertexAttribArray(o),this.enabledVertexAttribute.push(o)),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.iBuffer);for(var s=0;s<t.extraAttributes.length;s++){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.extraAttributes[s].buffer);var a=e(this.gl,this.shaderProgram,t.extraAttributes[s].name);this.gl.vertexAttribPointer(a,t.extraAttributes[s].itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(a)&&(this.gl.enableVertexAttribArray(a),this.enabledVertexAttribute.push(a))}t.drawType===this.gl.POINTS?this.gl.drawArrays(t.drawType,0,t.vertexSize):this.gl.drawElements(t.drawType,t.iBuffer.numItems,this.gl.UNSIGNED_SHORT,0)},r.setSize=function(t,e){this._width=t,this._height=e,this.canvas.width=this._width,this.canvas.height=this._height,this.gl.viewportWidth=this._width,this.gl.viewportHeight=this._height,this.gl.viewport(0,0,this._width,this._height),this.aspectRatio=this._width/this._height},r.__defineGetter__("width",function(){return this._width}),r.__defineGetter__("height",function(){return this._height}),r.__defineGetter__("viewport",function(){return this._viewport});var o=null;i.getInstance=function(){return null===o&&(o=new i),o},e.exports=i.getInstance()},{"gl-matrix":2}],13:[function(t,e){var i=t("./Face"),n=t("./GLTools"),r=t("gl-matrix"),o=function(t,e,i){this.gl=n.gl,this.vertexSize=t,this.indexSize=e,this.drawType=i,this.extraAttributes=[],this.vBufferPos=void 0,this._floatArrayVertex=void 0,this._init()},s=o.prototype;s._init=function(){},s.bufferVertex=function(t,e){var i=[],n=e?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW;this._vertices=[];for(var o=0;o<t.length;o++){for(var s=0;s<t[o].length;s++)i.push(t[o][s]);this._vertices.push(r.vec3.clone(t[o]))}if(void 0===this.vBufferPos&&(this.vBufferPos=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferPos),void 0===this._floatArrayVertex)this._floatArrayVertex=new Float32Array(i);else if(t.length!==this._floatArrayVertex.length)this._floatArrayVertex=new Float32Array(i);else for(var a=0;a<t.length;a++)this._floatArrayVertex[a]=t[a];this.gl.bufferData(this.gl.ARRAY_BUFFER,this._floatArrayVertex,n),this.vBufferPos.itemSize=3},s.bufferTexCoords=function(t){for(var e=[],i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)e.push(t[i][n]);this.vBufferUV=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferUV),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW),this.vBufferUV.itemSize=2},s.bufferData=function(t,e,i,n){var r=-1,o=n?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,s=0;for(s=0;s<this.extraAttributes.length;s++)if(this.extraAttributes[s].name===e){this.extraAttributes[s].data=t,r=s;break}var a=[];for(s=0;s<t.length;s++)for(var u=0;u<t[s].length;u++)a.push(t[s][u]);var h,c;if(-1===r)h=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h),c=new Float32Array(a),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,o),this.extraAttributes.push({name:e,data:t,itemSize:i,buffer:h,floatArray:c});else{for(h=this.extraAttributes[r].buffer,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h),c=this.extraAttributes[r].floatArray,s=0;s<a.length;s++)c[s]=a[s];this.gl.bufferData(this.gl.ARRAY_BUFFER,c,o)}},s.bufferIndices=function(t){this._indices=t,this.iBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.iBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.gl.STATIC_DRAW),this.iBuffer.itemSize=1,this.iBuffer.numItems=t.length},s.computeNormals=function(){if(this.drawType===this.gl.TRIANGLES){void 0===this._faces&&this._generateFaces(),console.log("Start computing");var t=(new Date).getTime(),e=0;this._normals=[];for(var i=0;i<this._vertices.length;i++){var n=r.vec3.create(),o=0;for(e=0;e<this._faces.length;e++)this._faces[e].contains(this._vertices[i])&&(r.vec3.add(n,n,this._faces[e].faceNormal),o++);r.vec3.normalize(n,n),this._normals.push(n)}this.bufferData(this._normals,"aNormal",3);var s=(new Date).getTime()-t;console.log("Total Time : ",s)}},s.computeTangent=function(){},s._generateFaces=function(){this._faces=[];for(var t=0;t<this._indices.length;t+=3){var e=this._vertices[this._indices[t+0]],n=this._vertices[this._indices[t+1]],r=this._vertices[this._indices[t+2]];this._faces.push(new i(e,n,r))}},e.exports=o},{"./Face":8,"./GLTools":12,"gl-matrix":2}],14:[function(t,e){var i=t("./GLTools"),n=t("./Mesh"),r={};r.createPlane=function(t,e,r,o,s){s=void 0===s?"xy":s,o=void 0===o?!1:o;for(var a=[],u=[],h=[],c=[],f=t/r,l=e/r,d=1/r,p=0,v=.5*-t,_=.5*-e,m=0;r>m;m++)for(var g=0;r>g;g++){var x=f*m+v,y=l*g+_;"xz"===s?(a.push([x,0,y+l]),a.push([x+f,0,y+l]),a.push([x+f,0,y]),a.push([x,0,y]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0])):"yz"===s?(a.push([0,x,y]),a.push([0,x+f,y]),a.push([0,x+f,y+l]),a.push([0,x,y+l]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0])):(a.push([x,y,0]),a.push([x+f,y,0]),a.push([x+f,y+l,0]),a.push([x,y+l,0]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]));var T=m/r,M=g/r;u.push([T,M]),u.push([T+d,M]),u.push([T+d,M+d]),u.push([T,M+d]),h.push(4*p+0),h.push(4*p+1),h.push(4*p+2),h.push(4*p+0),h.push(4*p+2),h.push(4*p+3),p++}var b=new n(a.length,h.length,i.gl.TRIANGLES);return b.bufferVertex(a),b.bufferTexCoords(u),b.bufferIndices(h),o&&b.bufferData(c,"aNormal",3),b},r.createSphere=function(t,e,r){r=void 0===r?!1:r;for(var o=[],s=[],a=[],u=[],h=0,c=1/e,f=function(i,n,r){r=void 0===r?!1:r;var o=i/e*Math.PI-.5*Math.PI,s=n/e*Math.PI*2,a=r?1:t,u=[];u[1]=Math.sin(o)*a;var h=Math.cos(o)*a;u[0]=Math.cos(s)*h,u[2]=Math.sin(s)*h;var c=1e4;return u[0]=Math.floor(u[0]*c)/c,u[1]=Math.floor(u[1]*c)/c,u[2]=Math.floor(u[2]*c)/c,u},l=0;e>l;l++)for(var d=0;e>d;d++){o.push(f(l,d)),o.push(f(l+1,d)),o.push(f(l+1,d+1)),o.push(f(l,d+1)),r&&(u.push(f(l,d,!0)),u.push(f(l+1,d,!0)),u.push(f(l+1,d+1,!0)),u.push(f(l,d+1,!0)));var p=d/e,v=l/e;s.push([1-p,v]),s.push([1-p,v+c]),s.push([1-p-c,v+c]),s.push([1-p-c,v]),a.push(4*h+0),a.push(4*h+1),a.push(4*h+2),a.push(4*h+0),a.push(4*h+2),a.push(4*h+3),h++}var _=new n(o.length,a.length,i.gl.TRIANGLES);return _.bufferVertex(o),_.bufferTexCoords(s),_.bufferIndices(a),console.log("With normals :",r),r&&_.bufferData(u,"aNormal",3),_},r.createCube=function(t,e,r,o){o=void 0===o?!1:o,e=e||t,r=r||t;var s=t/2,a=e/2,u=r/2,h=[],c=[],f=[],l=[],d=0;h.push([-s,a,-u]),h.push([s,a,-u]),h.push([s,-a,-u]),h.push([-s,-a,-u]),l.push([0,0,-1]),l.push([0,0,-1]),l.push([0,0,-1]),l.push([0,0,-1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([s,a,-u]),h.push([s,a,u]),h.push([s,-a,u]),h.push([s,-a,-u]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([s,a,u]),h.push([-s,a,u]),h.push([-s,-a,u]),h.push([s,-a,u]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,a,u]),h.push([-s,a,-u]),h.push([-s,-a,-u]),h.push([-s,-a,u]),l.push([-1,0,0]),l.push([-1,0,0]),l.push([-1,0,0]),l.push([-1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,a,u]),h.push([s,a,u]),h.push([s,a,-u]),h.push([-s,a,-u]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,-a,-u]),h.push([s,-a,-u]),h.push([s,-a,u]),h.push([-s,-a,u]),l.push([0,-1,0]),l.push([0,-1,0]),l.push([0,-1,0]),l.push([0,-1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++;var p=new n(h.length,f.length,i.gl.TRIANGLES);return p.bufferVertex(h),p.bufferTexCoords(c),p.bufferIndices(f),o&&p.bufferData(l,"aNormal",3),p},e.exports=r},{"./GLTools":12,"./Mesh":13}],15:[function(t,e){function i(){this._clearAll()}var n,r=t("./GLTools"),o=t("./Mesh"),s=i.prototype;s._clearAll=function(){this._callback=null,this._callbackError=null,this._mesh=[],this._drawingType=""},s.load=function(t,e,i,o,s){this._clearAll(),n||(n=r.gl),this._drawingType=void 0===s?n.TRIANGLES:s,this._ignoreNormals=void 0===o?!0:o,this._callback=e,this._callbackError=i;var a=new XMLHttpRequest;a.onreadystatechange=this._onXHTPState.bind(this),a.open("GET",t,!0),a.send()},s._onXHTPState=function(t){4===t.target.readyState&&this._parseObj(t.target.response)},s.parse=function(t,e,i,r,o){this._clearAll(),this._drawingType=void 0===o?n.TRIANGLES:o,this._ignoreNormals=void 0===r?!0:r,this._parseObj(t)},s._parseObj=function(t){function e(t){var e=parseInt(t);return 3*(e>=0?e-1:e+d.length/3)}function i(t){var e=parseInt(t);return 3*(e>=0?e-1:e+p.length/3)}function n(t){var e=parseInt(t);return 2*(e>=0?e-1:e+v.length/2)}function r(t,e,i){c.push([d[t],d[t+1],d[t+2]]),c.push([d[e],d[e+1],d[e+2]]),c.push([d[i],d[i+1],d[i+2]]),_.push(3*m+0),_.push(3*m+1),_.push(3*m+2),m++}function o(t,e,i){f.push([v[t],v[t+1]]),f.push([v[e],v[e+1]]),f.push([v[i],v[i+1]])}function s(t,e,i){l.push([p[t],p[t+1],p[t+2]]),l.push([p[e],p[e+1],p[e+2]]),l.push([p[i],p[i+1],p[i+2]])}function a(t,a,u,h,c,f,l,d,p,v,_,m){var g,x=e(t),y=e(a),T=e(u);void 0===h?r(x,y,T):(g=e(h),r(x,y,g),r(y,T,g)),void 0!==c&&(x=n(c),y=n(f),T=n(l),void 0===h?o(x,y,T):(g=n(d),o(x,y,g),o(y,T,g))),void 0!==p&&(x=i(p),y=i(v),T=i(_),void 0===h?s(x,y,T):(g=i(m),s(x,y,g),s(y,T,g)))}for(var u,h=t.split("\n"),c=[],f=[],l=[],d=[],p=[],v=[],_=[],m=0,g=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,x=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,y=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,T=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,M=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,b=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,E=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,w=0;w<h.length;w++){var A=h[w];A=A.trim(),0!==A.length&&"#"!==A.charAt(0)&&(null!==(u=g.exec(A))?d.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])):null!==(u=x.exec(A))?p.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])):null!==(u=y.exec(A))?v.push(parseFloat(u[1]),parseFloat(u[2])):null!==(u=T.exec(A))?a(u[1],u[2],u[3],u[4]):null!==(u=M.exec(A))?a(u[2],u[5],u[8],u[11],u[3],u[6],u[9],u[12]):null!==(u=b.exec(A))?a(u[2],u[6],u[10],u[14],u[3],u[7],u[11],u[15],u[4],u[8],u[12],u[16]):null!==(u=E.exec(A))&&a(u[2],u[5],u[8],u[11],void 0,void 0,void 0,void 0,u[3],u[6],u[9],u[12]))}this._generateMeshes({positions:c,coords:f,normals:l,indices:_})},s._generateMeshes=function(t){n=r.gl;var e=new o(t.positions.length,t.indices.length,this._drawingType);e.bufferVertex(t.positions),e.bufferTexCoords(t.coords),e.bufferIndices(t.indices),this._ignoreNormals||e.bufferData(t.normals,"aNormal",3),this._callback&&this._callback(e,t)},e.exports=i},{"./GLTools":12,"./Mesh":13}],16:[function(t,e){function i(t){void 0===t&&(t=document),this._isRotateZ=0,this.matrix=n.mat4.create(),this.m=n.mat4.create(),this._vZaxis=n.vec3.clone([0,0,0]),this._zAxis=n.vec3.clone([0,0,-1]),this.preMouse={x:0,y:0},this.mouse={x:0,y:0},this._isMouseDown=!1,this._rotation=n.quat.clone([0,0,1,0]),this.tempRotation=n.quat.clone([0,0,0,0]),this._rotateZMargin=0,this.diffX=0,this.diffY=0,this._currDiffX=0,this._currDiffY=0,this._offset=.004,this._easing=.1,this._slerp=-1,this._isLocked=!1;var e=this;t.addEventListener("mousedown",function(t){e._onMouseDown(t)}),t.addEventListener("touchstart",function(t){e._onMouseDown(t)}),t.addEventListener("mouseup",function(t){e._onMouseUp(t)}),t.addEventListener("touchend",function(t){e._onMouseUp(t)}),t.addEventListener("mousemove",function(t){e._onMouseMove(t)}),t.addEventListener("touchmove",function(t){e._onMouseMove(t)})}var n=t("gl-matrix"),r=i.prototype;r.inverseControl=function(t){this._isInvert=void 0===t?!0:t},r.lock=function(t){this._isLocked=void 0===t?!0:t},r.getMousePos=function(t){var e,i;return void 0!==t.changedTouches?(e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY):(e=t.clientX,i=t.clientY),{x:e,y:i}},r._onMouseDown=function(t){if(!this._isLocked&&!this._isMouseDown){var e=this.getMousePos(t),i=n.quat.clone(this._rotation);this._updateRotation(i),this._rotation=i,this._isMouseDown=!0,this._isRotateZ=0,this.preMouse={x:e.x,y:e.y},e.y<this._rotateZMargin||e.y>window.innerHeight-this._rotateZMargin?this._isRotateZ=1:(e.x<this._rotateZMargin||e.x>window.innerWidth-this._rotateZMargin)&&(this._isRotateZ=2),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0}},r._onMouseMove=function(t){this._isLocked||(t.touches&&t.preventDefault(),this.mouse=this.getMousePos(t))},r._onMouseUp=function(){this._isLocked||this._isMouseDown&&(this._isMouseDown=!1)},r.setCameraPos=function(t,e){if(e=e||this._easing,this._easing=e,!(this._slerp>0)){var i=n.quat.clone(this._rotation);this._updateRotation(i),this._rotation=n.quat.clone(i),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0,this._isMouseDown=!1,this._isRotateZ=0,this._targetQuat=n.quat.clone(t),this._slerp=1}},r.resetQuat=function(){this._rotation=n.quat.clone([0,0,1,0]),this.tempRotation=n.quat.clone([0,0,0,0]),this._targetQuat=void 0,this._slerp=-1},r.update=function(){n.mat4.identity(this.m),void 0===this._targetQuat?(n.quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=.1*(0-this._slerp),this._slerp<.001?(n.quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(n.quat.set(this.tempRotation,0,0,0,0),n.quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp))),n.vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation),n.mat4.fromQuat(this.matrix,this.tempRotation)},r._updateRotation=function(t){this._isMouseDown&&!this._isLocked&&(this.diffX=-(this.mouse.x-this.preMouse.x),this.diffY=this.mouse.y-this.preMouse.y,this._isInvert&&(this.diffX=-this.diffX,this.diffY=-this.diffY)),this._currDiffX+=(this.diffX-this._currDiffX)*this._easing,this._currDiffY+=(this.diffY-this._currDiffY)*this._easing;var e,i;if(this._isRotateZ>0)1===this._isRotateZ?(e=-this._currDiffX*this._offset,e*=this.preMouse.y<this._rotateZMargin?-1:1,i=n.quat.clone([0,0,Math.sin(e),Math.cos(e)]),n.quat.multiply(i,t,i)):(e=-this._currDiffY*this._offset,e*=this.preMouse.x<this._rotateZMargin?1:-1,i=n.quat.clone([0,0,Math.sin(e),Math.cos(e)]),n.quat.multiply(i,t,i));else{var r=n.vec3.clone([this._currDiffX,this._currDiffY,0]),o=n.vec3.create();n.vec3.cross(o,r,this._zAxis),n.vec3.normalize(o,o),e=n.vec3.length(r)*this._offset,i=n.quat.clone([Math.sin(e)*o[0],Math.sin(e)*o[1],Math.sin(e)*o[2],Math.cos(e)]),n.quat.multiply(t,i,t)}},e.exports=i},{"gl-matrix":2}],17:[function(t,e){var i=t("./GLTools"),n=t("./QuatRotation"),r=t("./CameraOrtho"),o=t("./SimpleCamera"),s=t("gl-matrix"),a=function(){null!==i.canvas&&(this.gl=i.gl,this._children=[],this._init())},u=a.prototype;u._init=function(){this.camera=new o(i.canvas),this.camera.setPerspective(45*Math.PI/180,i.aspectRatio,5,3e3),this.camera.lockRotation();var t=s.vec3.clone([0,0,500]),e=s.vec3.create(),a=s.vec3.clone([0,-1,0]);this.camera.lookAt(t,e,a),this.sceneRotation=new n(i.canvas),this.rotationFront=s.mat4.create(),s.mat4.identity(this.rotationFront),this.cameraOrtho=new r,this.cameraOrthoScreen=new r,this.cameraOtho=this.cameraOrtho,this.cameraOrtho.lookAt(t,e,a),this.cameraOrtho.ortho(1,-1,1,-1),this.cameraOrthoScreen.lookAt(t,e,a),this.cameraOrthoScreen.ortho(0,i.width,i.height,0),this._initTextures(),this._initViews(),window.addEventListener("resize",this._onResize.bind(this))},u._initTextures=function(){},u._initViews=function(){},u.loop=function(){this.update(),this.render()},u.update=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.sceneRotation.update(),i.setViewport(0,0,i.width,i.height),i.setMatrices(this.camera),i.rotate(this.sceneRotation.matrix)},u.resize=function(){},u.render=function(){},u._onResize=function(){this.cameraOrthoScreen.ortho(0,i.width,i.height,0)},e.exports=a},{"./CameraOrtho":4,"./GLTools":12,"./QuatRotation":16,"./SimpleCamera":20,"gl-matrix":2}],18:[function(t,e){function i(){this.FRAMERATE=60,this._delayTasks=[],this._nextTasks=[],this._deferTasks=[],this._highTasks=[],this._usurpTask=[],this._enterframeTasks=[],this._idTable=0,window.requestAnimFrame(this._loop.bind(this))}void 0===window.requestAnimFrame&&(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}());var n=i.prototype;n._loop=function(){window.requestAnimFrame(this._loop.bind(this)),this._process()},n._process=function(){var t,e,i,n=0;for(n=0;n<this._enterframeTasks.length;n++)t=this._enterframeTasks[n],null!==t&&void 0!==t&&t.func.apply(t.scope,t.params);for(;this._highTasks.length>0;)t=this._highTasks.pop(),t.func.apply(t.scope,t.params);var r=(new Date).getTime();for(n=0;n<this._delayTasks.length;n++)t=this._delayTasks[n],r-t.time>t.delay&&(t.func.apply(t.scope,t.params),this._delayTasks.splice(n,1));for(r=(new Date).getTime(),e=1e3/this.FRAMERATE;this._deferTasks.length>0;){if(t=this._deferTasks.shift(),i=(new Date).getTime(),!(e>i-r)){this._deferTasks.unshift(t);break}t.func.apply(t.scope,t.params)}for(r=(new Date).getTime(),e=1e3/this.FRAMERATE;this._usurpTask.length>0&&(t=this._usurpTask.shift(),i=(new Date).getTime(),e>i-r);)t.func.apply(t.scope,t.params);this._highTasks=this._highTasks.concat(this._nextTasks),this._nextTasks=[],this._usurpTask=[]},n.addEF=function(t,e,i){i=i||[];var n=this._idTable;return this._enterframeTasks[n]={scope:t,func:e,params:i},this._idTable++,n},n.removeEF=function(t){return void 0!==this._enterframeTasks[t]&&(this._enterframeTasks[t]=null),-1},n.delay=function(t,e,i,n){var r=(new Date).getTime(),o={scope:t,func:e,params:i,delay:n,time:r};this._delayTasks.push(o)},n.defer=function(t,e,i){var n={scope:t,func:e,params:i};this._deferTasks.push(n)},n.next=function(t,e,i){var n={scope:t,func:e,params:i};this._nextTasks.push(n)},n.usurp=function(t,e,i){var n={scope:t,func:e,params:i};this._usurpTask.push(n)};var r=null;i.getInstance=function(){return null===r&&(r=new i),r},e.exports=i.getInstance()},{}],19:[function(t,e){var i=function(){};i.shaders={},i.shaders.copyVert="#define GLSLIFY 1\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i.shaders.copyNormalVert="#define GLSLIFY 1\n\n// copyWithNormals.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vVertex;\n\nvoid main(void) {\n	gl_Position   = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n	vTextureCoord = aTextureCoord;\n	vNormal       = aNormal;\n	vVertex 	  = aVertexPosition;\n}",i.shaders.generalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec3 pos = aVertexPosition;\n    pos *= scale;\n    pos += position;\n    gl_Position = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i.shaders.generalNormalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n	vec3 pos      = aVertexPosition;\n	pos           *= scale;\n	pos           += position;\n	gl_Position   = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n	vTextureCoord = aTextureCoord;\n	\n	vNormal       = aNormal;\n	vVertex       = pos;\n}",i.shaders.generalWithNormalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n	vec3 pos      = aVertexPosition;\n	pos           *= scale;\n	pos           += position;\n	gl_Position   = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n	vTextureCoord = aTextureCoord;\n	\n	vNormal       = aNormal;\n	vVertex       = pos;\n}",i.shaders.copyFrag="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n}\n",i.shaders.alphaFrag="#define GLSLIFY 1\n\n#define SHADER_NAME TEXTURE_WITH_ALPHA\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n    gl_FragColor.a *= opacity;\n}",i.shaders.simpleColorFrag="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_COLOR_FRAGMENT\n\nprecision highp float;\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = vec4(color, opacity);\n}",i.shaders.depthFrag="#define GLSLIFY 1\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float n;\nuniform float f;\n\nfloat getDepth(float z) {\n	return (6.0 * n) / (f + n - z*(f-n));\n}\n\nvoid main(void) {\n    float r = texture2D(texture, vTextureCoord).r;\n    float grey = getDepth(r);\n    gl_FragColor = vec4(grey, grey, grey, 1.0);\n}",i.shaders.simpleCopyLighting="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_TEXTURE_LIGHTING\n\nprecision highp float;\n\nuniform vec3 ambient;\nuniform vec3 lightPosition;\nuniform vec3 lightColor;\nuniform float lightWeight;\n\nuniform sampler2D texture;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n	vec3 L        = normalize(lightPosition-vVertex);\n	float lambert = max(dot(vNormal, L), .0);\n	vec3 light    = ambient + lightColor * lambert * lightWeight;\n	vec4 color 	  = texture2D(texture, vTextureCoord);\n	color.rgb 	  *= light;\n	\n	gl_FragColor  = color;\n}",i.shaders.simpleColorLighting="#define GLSLIFY 1\n\n// simpleColorLighting.frag\n\n#define SHADER_NAME SIMPLE_COLOR_LIGHTING\n\nprecision highp float;\n\nuniform vec3 ambient;\nuniform vec3 lightPosition;\nuniform vec3 lightColor;\nuniform float lightWeight;\n\nuniform vec3 color;\nuniform float opacity;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n	vec3 L        = normalize(lightPosition-vVertex);\n	float lambert = max(dot(vNormal, L), .0);\n	vec3 light    = ambient + lightColor * lambert * lightWeight;\n	\n	gl_FragColor  = vec4(color * light, opacity);\n}",i.getShader=function(t){return this.shaders[t]
},i.get=i.getShader,e.exports=i},{}],20:[function(t,e){var i=t("gl-matrix"),n=t("./CameraPerspective"),r=t("./EaseNumber"),o=function(t){this._listenerTarget=t||window,n.call(this),this._init()},s=o.prototype=new n,a=n.prototype;s._init=function(){this.radius=new r(500),this.position[2]=this.radius.value,this.center=i.vec3.create(),this.up=i.vec3.clone([0,-1,0]),this.lookAt(this.position,this.center,this.up),this._mouse={},this._preMouse={},this._isMouseDown=!1,this._rx=new r(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new r(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this._listenerTarget.addEventListener("mousewheel",this._onWheel.bind(this)),this._listenerTarget.addEventListener("DOMMouseScroll",this._onWheel.bind(this)),this._listenerTarget.addEventListener("mousedown",this._onMouseDown.bind(this)),this._listenerTarget.addEventListener("touchstart",this._onMouseDown.bind(this)),this._listenerTarget.addEventListener("mousemove",this._onMouseMove.bind(this)),this._listenerTarget.addEventListener("touchmove",this._onMouseMove.bind(this)),window.addEventListener("mouseup",this._onMouseUp.bind(this)),window.addEventListener("touchend",this._onMouseUp.bind(this))},s.inverseControl=function(t){this._isInvert=void 0===t?!0:t},s.lock=function(t){void 0===t?(this._isLockZoom=!0,this._isLockRotation=!0):(this._isLockZoom=t,this._isLockRotation=t)},s.lockRotation=function(t){this._isLockRotation=void 0===t?!0:t},s.lockZoom=function(t){this._isLockZoom=void 0===t?!0:t},s._onMouseDown=function(t){this._isLockRotation||(this._isMouseDown=!0,u(t,this._mouse),u(t,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)},s._onMouseMove=function(t){if(!this._isLockRotation&&(u(t,this._mouse),t.touches&&t.preventDefault(),this._isMouseDown)){var e=this._mouse.x-this._preMouse.x;this._isInvert&&(e*=-1),this._ry.value=this._preRY-.01*e;var i=this._mouse.y-this._preMouse.y;this._isInvert&&(i*=-1),this._rx.value=this._preRX-.01*i}},s._onMouseUp=function(){this._isLockRotation||(this._isMouseDown=!1)},s._onWheel=function(t){if(!this._isLockZoom){var e=t.wheelDelta,i=t.detail,n=0;n=i?e?e/i/40*i>0?1:-1:-i/3:e/120,this.radius.add(5*-n)}},s.getMatrix=function(){return this._updateCameraPosition(),this.lookAt(this.position,this.center,this.up),a.getMatrix.call(this)},s._updateCameraPosition=function(){this.position[2]=this.radius.value,this.position[1]=Math.sin(this._rx.value)*this.radius.value;var t=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*t,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*t};var u=function(t,e){var i=e||{};return t.touches?(i.x=t.touches[0].pageX,i.y=t.touches[0].pageY):(i.x=t.clientX,i.y=t.clientY),i};s.__defineGetter__("rx",function(){return this._rx.targetValue}),s.__defineSetter__("rx",function(t){this._rx.value=t}),s.__defineGetter__("ry",function(){return this._ry.targetValue}),s.__defineSetter__("ry",function(t){this._ry.value=t}),e.exports=o},{"./CameraPerspective":5,"./EaseNumber":6,"gl-matrix":2}],21:[function(t,e){var i=function(){this._imgs={},this._loadedCount=0,this._toLoadCount=0,this._scope=void 0,this._callback=void 0,this._callbackProgress=void 0},n=i.prototype;n.load=function(t,e,i,n){this._imgs={},this._loadedCount=0,this._toLoadCount=t.length,this._scope=e,this._callback=i,this._callbackProgress=n,this._imgLoadedBind=this._onImageLoaded.bind(this);for(var r=0;r<t.length;r++){var o=new Image;o.onload=this._imgLoadedBind;var s=t[r],a=s.split("/"),u=a[a.length-1].split(".")[0];this._imgs[u]=o,o.src=s}},n._onImageLoaded=function(){if(this._loadedCount++,this._loadedCount===this._toLoadCount)this._callback.call(this._scope,this._imgs);else{var t=this._loadedCount/this._toLoadCount;this._callbackProgress&&this._callbackProgress.call(this._scope,t)}},e.exports=i},{}],22:[function(t,e){var i=t("./GLShader"),n=function(t,e){this.shader=new i(t,e),this._init()},r=n.prototype;r._init=function(){},r.render=function(){},e.exports=n},{"./GLShader":10}],23:[function(t,e){var i=t("./GLTools"),n=t("./View"),r=t("./Mesh"),o="precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;attribute vec3 aColor;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vTextureCoord;varying vec3 vColor;void main(void) {    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);    vTextureCoord = aTextureCoord;    vColor = aColor;}",s="precision mediump float;varying vec3 vColor;void main(void) {    gl_FragColor = vec4(vColor, 1.0);}",a=function(t,e){this.lineWidth=void 0===t?2:t;var i=void 0===e?s:e;n.call(this,o,i)},u=a.prototype=new n;u._init=function(){var t=[],e=[],n=[],o=[0,1,2,3,4,5],s=9999;t.push([-s,0,0]),t.push([s,0,0]),t.push([0,-s,0]),t.push([0,s,0]),t.push([0,0,-s]),t.push([0,0,s]),e.push([1,0,0]),e.push([1,0,0]),e.push([0,1,0]),e.push([0,1,0]),e.push([0,0,1]),e.push([0,0,1]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),this.mesh=new r(t.length,o.length,i.gl.LINES),this.mesh.bufferVertex(t),this.mesh.bufferTexCoords(n),this.mesh.bufferIndices(o),this.mesh.bufferData(e,"aColor",3,!1)},u.render=function(){this.shader.isReady()&&(this.shader.bind(),i.gl.lineWidth(this.lineWidth),i.draw(this.mesh),i.gl.lineWidth(1))},e.exports=a},{"./GLTools":12,"./Mesh":13,"./View":22}],24:[function(t,e){var i=t("./View"),n=t("./GLTools"),r=t("./MeshUtils"),o=function(t,e){i.call(this,t,e)},s=o.prototype=new i;s._init=function(){n.gl&&(this.mesh=r.createPlane(2,2,1))},s.render=function(t){this.shader.isReady()&&(this.shader.bind(),this.shader.uniform("texture","uniform1i",0),t.bind(0),n.draw(this.mesh))},e.exports=o},{"./GLTools":12,"./MeshUtils":14,"./View":22}],25:[function(t,e){var i=t("./GLTools"),n=t("./View"),r=t("./ShaderLibs"),o=t("./Mesh"),s=function(t,e){var i=.75;this.color=void 0===t?[i,i,i]:t;var o=void 0===e?r.get("simpleColorFrag"):e;n.call(this,null,o)},a=s.prototype=new n;a._init=function(){var t,e,n=[],r=[],s=[],a=0,u=100,h=3e3,c=h/u;for(t=-h/2;h>t;t+=c)for(e=-h/2;h>e;e+=c)n.push([t,e,0]),r.push([0,0]),s.push(a),a++,n.push([t,0,e]),r.push([0,0]),s.push(a),a++;this.mesh=new o(n.length,s.length,i.gl.DOTS),this.mesh.bufferVertex(n),this.mesh.bufferTexCoords(r),this.mesh.bufferIndices(s)},a.render=function(){this.shader.bind(),this.shader.uniform("color","uniform3fv",this.color),this.shader.uniform("opacity","uniform1f",1),i.draw(this.mesh)},e.exports=s},{"./GLTools":12,"./Mesh":13,"./ShaderLibs":19,"./View":22}]},{},[1])(1)})},d.adjoint=function(t,e){var i=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=i,t},d.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},d.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],h=i[2],c=i[3];return t[0]=n*a+o*u,t[1]=r*a+s*u,t[2]=n*h+o*c,t[3]=r*h+s*c,t},d.mul=d.multiply,d.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+o*a,t[1]=r*u+s*a,t[2]=n*-a+o*u,t[3]=r*-a+s*u,t},d.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1];return t[0]=n*a,t[1]=r*a,t[2]=o*u,t[3]=s*u,t},d.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},d.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},d.LDU=function(t,e,i,n){return t[2]=n[2]/n[0],i[0]=n[0],i[1]=n[1],i[3]=n[3]-t[2]*i[1],[t,e,i]},"undefined"!=typeof r&&(r.mat2=d);var p={};p.create=function(){var t=new s(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},p.clone=function(t){var e=new s(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},p.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},p.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},p.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=i*o-n*r;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-r*u,t[3]=i*u,t[4]=(r*a-o*s)*u,t[5]=(n*s-i*a)*u,t):null},p.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},p.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1],f=i[2],l=i[3],d=i[4],p=i[5];return t[0]=n*h+o*c,t[1]=r*h+s*c,t[2]=n*f+o*l,t[3]=r*f+s*l,t[4]=n*d+o*p+a,t[5]=r*d+s*p+u,t},p.mul=p.multiply,p.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=Math.sin(i),c=Math.cos(i);return t[0]=n*c+o*h,t[1]=r*c+s*h,t[2]=n*-h+o*c,t[3]=r*-h+s*c,t[4]=a,t[5]=u,t},p.scale=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1];return t[0]=n*h,t[1]=r*h,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=u,t},p.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=i[0],c=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=n*h+o*c+a,t[5]=r*h+s*c+u,t},p.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},p.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!=typeof r&&(r.mat2d=p);var v={};v.create=function(){var t=new s(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},v.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},v.clone=function(t){var e=new s(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},v.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},v.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},v.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=n,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},v.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=c*s-a*h,l=-c*o+a*u,d=h*o-s*u,p=i*f+n*l+r*d;return p?(p=1/p,t[0]=f*p,t[1]=(-c*n+r*h)*p,t[2]=(a*n-r*s)*p,t[3]=l*p,t[4]=(c*i-r*u)*p,t[5]=(-a*i+r*o)*p,t[6]=d*p,t[7]=(-h*i+n*u)*p,t[8]=(s*i-n*o)*p,t):null},v.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8];return t[0]=s*c-a*h,t[1]=r*h-n*c,t[2]=n*a-r*s,t[3]=a*u-o*c,t[4]=i*c-r*u,t[5]=r*o-i*a,t[6]=o*h-s*u,t[7]=n*u-i*h,t[8]=i*s-n*o,t},v.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8];return e*(h*o-s*u)+i*(-h*r+s*a)+n*(u*r-o*a)},v.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=i[0],d=i[1],p=i[2],v=i[3],_=i[4],m=i[5],g=i[6],x=i[7],y=i[8];return t[0]=l*n+d*s+p*h,t[1]=l*r+d*a+p*c,t[2]=l*o+d*u+p*f,t[3]=v*n+_*s+m*h,t[4]=v*r+_*a+m*c,t[5]=v*o+_*u+m*f,t[6]=g*n+x*s+y*h,t[7]=g*r+x*a+y*c,t[8]=g*o+x*u+y*f,t},v.mul=v.multiply,v.translate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=i[0],d=i[1];return t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=l*n+d*s+h,t[7]=l*r+d*a+c,t[8]=l*o+d*u+f,t},v.rotate=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=Math.sin(i),d=Math.cos(i);return t[0]=d*n+l*s,t[1]=d*r+l*a,t[2]=d*o+l*u,t[3]=d*s-l*n,t[4]=d*a-l*r,t[5]=d*u-l*o,t[6]=h,t[7]=c,t[8]=f,t},v.scale=function(t,e,i){var n=i[0],r=i[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},v.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},v.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,h=i*s,c=n*s,f=n*a,l=r*s,d=r*a,p=r*u,v=o*s,_=o*a,m=o*u;return t[0]=1-f-p,t[3]=c-m,t[6]=l+_,t[1]=c+m,t[4]=1-h-p,t[7]=d-v,t[2]=l-_,t[5]=d+v,t[8]=1-h-f,t},v.normalFromMat4=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15],g=i*a-n*s,x=i*u-r*s,y=i*h-o*s,T=n*u-r*a,M=n*h-o*a,b=r*h-o*u,E=c*v-f*p,w=c*_-l*p,A=c*m-d*p,R=f*_-l*v,L=f*m-d*v,P=l*m-d*_,S=g*P-x*L+y*R+T*A-M*w+b*E;return S?(S=1/S,t[0]=(a*P-u*L+h*R)*S,t[1]=(u*A-s*P-h*w)*S,t[2]=(s*L-a*A+h*E)*S,t[3]=(r*L-n*P-o*R)*S,t[4]=(i*P-r*A+o*w)*S,t[5]=(n*A-i*L-o*E)*S,t[6]=(v*b-_*M+m*T)*S,t[7]=(_*y-p*b-m*x)*S,t[8]=(p*M-v*y+m*g)*S,t):null},v.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},v.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!=typeof r&&(r.mat3=v);var _={};_.create=function(){var t=new s(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},_.clone=function(t){var e=new s(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},_.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},_.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},_.transpose=function(t,e){if(t===e){var i=e[1],n=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},_.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15],g=i*a-n*s,x=i*u-r*s,y=i*h-o*s,T=n*u-r*a,M=n*h-o*a,b=r*h-o*u,E=c*v-f*p,w=c*_-l*p,A=c*m-d*p,R=f*_-l*v,L=f*m-d*v,P=l*m-d*_,S=g*P-x*L+y*R+T*A-M*w+b*E;return S?(S=1/S,t[0]=(a*P-u*L+h*R)*S,t[1]=(r*L-n*P-o*R)*S,t[2]=(v*b-_*M+m*T)*S,t[3]=(l*M-f*b-d*T)*S,t[4]=(u*A-s*P-h*w)*S,t[5]=(i*P-r*A+o*w)*S,t[6]=(_*y-p*b-m*x)*S,t[7]=(c*b-l*y+d*x)*S,t[8]=(s*L-a*A+h*E)*S,t[9]=(n*A-i*L-o*E)*S,t[10]=(p*M-v*y+m*g)*S,t[11]=(f*y-c*M-d*g)*S,t[12]=(a*w-s*R-u*E)*S,t[13]=(i*R-n*w+r*E)*S,t[14]=(v*x-p*T-_*g)*S,t[15]=(c*T-f*x+l*g)*S,t):null},_.adjoint=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=e[4],a=e[5],u=e[6],h=e[7],c=e[8],f=e[9],l=e[10],d=e[11],p=e[12],v=e[13],_=e[14],m=e[15];return t[0]=a*(l*m-d*_)-f*(u*m-h*_)+v*(u*d-h*l),t[1]=-(n*(l*m-d*_)-f*(r*m-o*_)+v*(r*d-o*l)),t[2]=n*(u*m-h*_)-a*(r*m-o*_)+v*(r*h-o*u),t[3]=-(n*(u*d-h*l)-a*(r*d-o*l)+f*(r*h-o*u)),t[4]=-(s*(l*m-d*_)-c*(u*m-h*_)+p*(u*d-h*l)),t[5]=i*(l*m-d*_)-c*(r*m-o*_)+p*(r*d-o*l),t[6]=-(i*(u*m-h*_)-s*(r*m-o*_)+p*(r*h-o*u)),t[7]=i*(u*d-h*l)-s*(r*d-o*l)+c*(r*h-o*u),t[8]=s*(f*m-d*v)-c*(a*m-h*v)+p*(a*d-h*f),t[9]=-(i*(f*m-d*v)-c*(n*m-o*v)+p*(n*d-o*f)),t[10]=i*(a*m-h*v)-s*(n*m-o*v)+p*(n*h-o*a),t[11]=-(i*(a*d-h*f)-s*(n*d-o*f)+c*(n*h-o*a)),t[12]=-(s*(f*_-l*v)-c*(a*_-u*v)+p*(a*l-u*f)),t[13]=i*(f*_-l*v)-c*(n*_-r*v)+p*(n*l-r*f),t[14]=-(i*(a*_-u*v)-s*(n*_-r*v)+p*(n*u-r*a)),t[15]=i*(a*l-u*f)-s*(n*l-r*f)+c*(n*u-r*a),t},_.determinant=function(t){var e=t[0],i=t[1],n=t[2],r=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8],c=t[9],f=t[10],l=t[11],d=t[12],p=t[13],v=t[14],_=t[15],m=e*s-i*o,g=e*a-n*o,x=e*u-r*o,y=i*a-n*s,T=i*u-r*s,M=n*u-r*a,b=h*p-c*d,E=h*v-f*d,w=h*_-l*d,A=c*v-f*p,R=c*_-l*p,L=f*_-l*v;return m*L-g*R+x*A+y*w-T*E+M*b},_.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=e[9],d=e[10],p=e[11],v=e[12],_=e[13],m=e[14],g=e[15],x=i[0],y=i[1],T=i[2],M=i[3];return t[0]=x*n+y*a+T*f+M*v,t[1]=x*r+y*u+T*l+M*_,t[2]=x*o+y*h+T*d+M*m,t[3]=x*s+y*c+T*p+M*g,x=i[4],y=i[5],T=i[6],M=i[7],t[4]=x*n+y*a+T*f+M*v,t[5]=x*r+y*u+T*l+M*_,t[6]=x*o+y*h+T*d+M*m,t[7]=x*s+y*c+T*p+M*g,x=i[8],y=i[9],T=i[10],M=i[11],t[8]=x*n+y*a+T*f+M*v,t[9]=x*r+y*u+T*l+M*_,t[10]=x*o+y*h+T*d+M*m,t[11]=x*s+y*c+T*p+M*g,x=i[12],y=i[13],T=i[14],M=i[15],t[12]=x*n+y*a+T*f+M*v,t[13]=x*r+y*u+T*l+M*_,t[14]=x*o+y*h+T*d+M*m,t[15]=x*s+y*c+T*p+M*g,t},_.mul=_.multiply,_.translate=function(t,e,i){var n,r,o,s,a,u,h,c,f,l,d,p,v=i[0],_=i[1],m=i[2];return e===t?(t[12]=e[0]*v+e[4]*_+e[8]*m+e[12],t[13]=e[1]*v+e[5]*_+e[9]*m+e[13],t[14]=e[2]*v+e[6]*_+e[10]*m+e[14],t[15]=e[3]*v+e[7]*_+e[11]*m+e[15]):(n=e[0],r=e[1],o=e[2],s=e[3],a=e[4],u=e[5],h=e[6],c=e[7],f=e[8],l=e[9],d=e[10],p=e[11],t[0]=n,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=h,t[7]=c,t[8]=f,t[9]=l,t[10]=d,t[11]=p,t[12]=n*v+a*_+f*m+e[12],t[13]=r*v+u*_+l*m+e[13],t[14]=o*v+h*_+d*m+e[14],t[15]=s*v+c*_+p*m+e[15]),t},_.scale=function(t,e,i){var n=i[0],r=i[1],o=i[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},_.rotate=function(t,e,i,n){var r,s,a,u,h,c,f,l,d,p,v,_,m,g,x,y,T,M,b,E,w,A,R,L,P=n[0],S=n[1],F=n[2],D=Math.sqrt(P*P+S*S+F*F);return Math.abs(D)<o?null:(D=1/D,P*=D,S*=D,F*=D,r=Math.sin(i),s=Math.cos(i),a=1-s,u=e[0],h=e[1],c=e[2],f=e[3],l=e[4],d=e[5],p=e[6],v=e[7],_=e[8],m=e[9],g=e[10],x=e[11],y=P*P*a+s,T=S*P*a+F*r,M=F*P*a-S*r,b=P*S*a-F*r,E=S*S*a+s,w=F*S*a+P*r,A=P*F*a+S*r,R=S*F*a-P*r,L=F*F*a+s,t[0]=u*y+l*T+_*M,t[1]=h*y+d*T+m*M,t[2]=c*y+p*T+g*M,t[3]=f*y+v*T+x*M,t[4]=u*b+l*E+_*w,t[5]=h*b+d*E+m*w,t[6]=c*b+p*E+g*w,t[7]=f*b+v*E+x*w,t[8]=u*A+l*R+_*L,t[9]=h*A+d*R+m*L,t[10]=c*A+p*R+g*L,t[11]=f*A+v*R+x*L,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},_.rotateX=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[4],s=e[5],a=e[6],u=e[7],h=e[8],c=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+h*n,t[5]=s*r+c*n,t[6]=a*r+f*n,t[7]=u*r+l*n,t[8]=h*r-o*n,t[9]=c*r-s*n,t[10]=f*r-a*n,t[11]=l*r-u*n,t},_.rotateY=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],h=e[8],c=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-h*n,t[1]=s*r-c*n,t[2]=a*r-f*n,t[3]=u*r-l*n,t[8]=o*n+h*r,t[9]=s*n+c*r,t[10]=a*n+f*r,t[11]=u*n+l*r,t},_.rotateZ=function(t,e,i){var n=Math.sin(i),r=Math.cos(i),o=e[0],s=e[1],a=e[2],u=e[3],h=e[4],c=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+h*n,t[1]=s*r+c*n,t[2]=a*r+f*n,t[3]=u*r+l*n,t[4]=h*r-o*n,t[5]=c*r-s*n,t[6]=f*r-a*n,t[7]=l*r-u*n,t},_.fromRotationTranslation=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=n+n,u=r+r,h=o+o,c=n*a,f=n*u,l=n*h,d=r*u,p=r*h,v=o*h,_=s*a,m=s*u,g=s*h;return t[0]=1-(d+v),t[1]=f+g,t[2]=l-m,t[3]=0,t[4]=f-g,t[5]=1-(c+v),t[6]=p+_,t[7]=0,t[8]=l+m,t[9]=p-_,t[10]=1-(c+d),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},_.fromQuat=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i+i,a=n+n,u=r+r,h=i*s,c=n*s,f=n*a,l=r*s,d=r*a,p=r*u,v=o*s,_=o*a,m=o*u;return t[0]=1-f-p,t[1]=c+m,t[2]=l-_,t[3]=0,t[4]=c-m,t[5]=1-h-p,t[6]=d+v,t[7]=0,t[8]=l+_,t[9]=d-v,t[10]=1-h-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},_.frustum=function(t,e,i,n,r,o,s){var a=1/(i-e),u=1/(r-n),h=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(r+n)*u,t[10]=(s+o)*h,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*h,t[15]=0,t},_.perspective=function(t,e,i,n,r){var o=1/Math.tan(e/2),s=1/(n-r);return t[0]=o/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(r+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*r*n*s,t[15]=0,t},_.ortho=function(t,e,i,n,r,o,s){var a=1/(e-i),u=1/(n-r),h=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*h,t[11]=0,t[12]=(e+i)*a,t[13]=(r+n)*u,t[14]=(s+o)*h,t[15]=1,t},_.lookAt=function(t,e,i,n){var r,s,a,u,h,c,f,l,d,p,v=e[0],m=e[1],g=e[2],x=n[0],y=n[1],T=n[2],M=i[0],b=i[1],E=i[2];return Math.abs(v-M)<o&&Math.abs(m-b)<o&&Math.abs(g-E)<o?_.identity(t):(f=v-M,l=m-b,d=g-E,p=1/Math.sqrt(f*f+l*l+d*d),f*=p,l*=p,d*=p,r=y*d-T*l,s=T*f-x*d,a=x*l-y*f,p=Math.sqrt(r*r+s*s+a*a),p?(p=1/p,r*=p,s*=p,a*=p):(r=0,s=0,a=0),u=l*a-d*s,h=d*r-f*a,c=f*s-l*r,p=Math.sqrt(u*u+h*h+c*c),p?(p=1/p,u*=p,h*=p,c*=p):(u=0,h=0,c=0),t[0]=r,t[1]=u,t[2]=f,t[3]=0,t[4]=s,t[5]=h,t[6]=l,t[7]=0,t[8]=a,t[9]=c,t[10]=d,t[11]=0,t[12]=-(r*v+s*m+a*g),t[13]=-(u*v+h*m+c*g),t[14]=-(f*v+l*m+d*g),t[15]=1,t)},_.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},_.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!=typeof r&&(r.mat4=_);var m={};m.create=function(){var t=new s(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.rotationTo=function(){var t=f.create(),e=f.fromValues(1,0,0),i=f.fromValues(0,1,0);return function(n,r,o){var s=f.dot(r,o);return-.999999>s?(f.cross(t,e,r),f.length(t)<1e-6&&f.cross(t,i,r),f.normalize(t,t),m.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(f.cross(t,r,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,m.normalize(n,n))}}(),m.setAxes=function(){var t=v.create();return function(e,i,n,r){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],m.normalize(e,m.fromMat3(e,t))}}(),m.clone=l.clone,m.fromValues=l.fromValues,m.copy=l.copy,m.set=l.set,m.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},m.setAxisAngle=function(t,e,i){i=.5*i;var n=Math.sin(i);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(i),t},m.add=l.add,m.multiply=function(t,e,i){var n=e[0],r=e[1],o=e[2],s=e[3],a=i[0],u=i[1],h=i[2],c=i[3];return t[0]=n*c+s*a+r*h-o*u,t[1]=r*c+s*u+o*a-n*h,t[2]=o*c+s*h+n*u-r*a,t[3]=s*c-n*a-r*u-o*h,t},m.mul=m.multiply,m.scale=l.scale,m.rotateX=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+s*a,t[1]=r*u+o*a,t[2]=o*u-r*a,t[3]=s*u-n*a,t},m.rotateY=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u-o*a,t[1]=r*u+s*a,t[2]=o*u+n*a,t[3]=s*u-r*a,t},m.rotateZ=function(t,e,i){i*=.5;var n=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(i),u=Math.cos(i);return t[0]=n*u+r*a,t[1]=r*u-n*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t},m.calculateW=function(t,e){var i=e[0],n=e[1],r=e[2];return t[0]=i,t[1]=n,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-i*i-n*n-r*r)),t},m.dot=l.dot,m.lerp=l.lerp,m.slerp=function(t,e,i,n){var r,o,s,a,u,h=e[0],c=e[1],f=e[2],l=e[3],d=i[0],p=i[1],v=i[2],_=i[3];return o=h*d+c*p+f*v+l*_,0>o&&(o=-o,d=-d,p=-p,v=-v,_=-_),1-o>1e-6?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-n)*r)/s,u=Math.sin(n*r)/s):(a=1-n,u=n),t[0]=a*h+u*d,t[1]=a*c+u*p,t[2]=a*f+u*v,t[3]=a*l+u*_,t},m.invert=function(t,e){var i=e[0],n=e[1],r=e[2],o=e[3],s=i*i+n*n+r*r+o*o,a=s?1/s:0;return t[0]=-i*a,t[1]=-n*a,t[2]=-r*a,t[3]=o*a,t},m.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},m.length=l.length,m.len=m.length,m.squaredLength=l.squaredLength,m.sqrLen=m.squaredLength,m.normalize=l.normalize,m.fromMat3=function(t,e){var i,n=e[0]+e[4]+e[8];if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[7]-e[5])*i,t[1]=(e[2]-e[6])*i,t[2]=(e[3]-e[1])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;i=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*i,i=.5/i,t[3]=(e[3*s+o]-e[3*o+s])*i,t[o]=(e[3*o+r]+e[3*r+o])*i,t[s]=(e[3*s+r]+e[3*r+s])*i}return t},m.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!=typeof r&&(r.quat=m)}(s.exports)}(this)},{}],3:[function(t,e){"use strict";var i=t("gl-matrix"),n=function(){this.matrix=i.mat4.create(),i.mat4.identity(this.matrix),this.position=i.vec3.create()},r=n.prototype;r.lookAt=function(t,e,n){i.vec3.copy(this.position,t),i.mat4.identity(this.matrix),i.mat4.lookAt(this.matrix,t,e,n)},r.getMatrix=function(){return this.matrix},e.exports=n},{"gl-matrix":2}],4:[function(t,e){"use strict";var i=t("./Camera"),n=t("gl-matrix"),r=function(){i.call(this);var t=n.vec3.clone([0,0,500]),e=n.vec3.create(),r=n.vec3.clone([0,-1,0]);this.lookAt(t,e,r),this.projection=n.mat4.create()},o=r.prototype=new i;o.setBoundary=function(t,e,i,r){this.left=t,this.right=e,this.top=i,this.bottom=r,n.mat4.ortho(this.projection,t,e,i,r,0,1e4)},o.ortho=o.setBoundary,o.getMatrix=function(){return this.matrix},o.resize=function(){n.mat4.ortho(this.projection,this.left,this.right,this.top,this.bottom,0,1e4)},e.exports=r},{"./Camera":3,"gl-matrix":2}],5:[function(t,e){"use strict";var i=t("./Camera"),n=t("gl-matrix"),r=function(){i.call(this),this.projection=n.mat4.create(),this.mtxFinal=n.mat4.create()},o=r.prototype=new i;o.setPerspective=function(t,e,i,r){this._fov=t,this._near=i,this._far=r,this._aspect=e,n.mat4.perspective(this.projection,t,e,i,r)},o.getMatrix=function(){return this.matrix},o.resize=function(t){this._aspect=t,n.mat4.perspective(this.projection,this._fov,t,this._near,this._far)},o.__defineGetter__("near",function(){return this._near}),o.__defineGetter__("far",function(){return this._far}),e.exports=r},{"./Camera":3,"gl-matrix":2}],6:[function(t,e){"use strict";function i(t,e){this._easing=e||.1,this._value=t,this._targetValue=t,n.addEF(this,this._update)}var n=t("./Scheduler"),r=i.prototype;r._update=function(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this._easing},r.setTo=function(t){this._targetValue=this._value=t},r.add=function(t){this._targetValue+=t},r.limit=function(t,e){this._min=t,this._max=e,this._checkLimit()},r.setEasing=function(t){this._easing=t},r._checkLimit=function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)},r.__defineGetter__("value",function(){return this._value}),r.__defineGetter__("targetValue",function(){return this._targetValue}),r.__defineSetter__("value",function(t){this._targetValue=t}),e.exports=i},{"./Scheduler":18}],7:[function(t,e){"use strict";function i(){this._eventListeners=null}var n=!0;try{var r=document.createEvent("CustomEvent");r=null}catch(o){n=!1}var s=i.prototype;s.addEventListener=function(t,e){return null===this._eventListeners&&(this._eventListeners={}),this._eventListeners[t]||(this._eventListeners[t]=[]),this._eventListeners[t].push(e),this},s.removeEventListener=function(t,e){null===this._eventListeners&&(this._eventListeners={});var i=this._eventListeners[t];if("undefined"==typeof i)return this;for(var n=i.length,r=0;n>r;r++)i[r]===e&&(i.splice(r,1),r--,n--);return this},s.dispatchEvent=function(t){null===this._eventListeners&&(this._eventListeners={});var e=t.type;try{null===t.target&&(t.target=this),t.currentTarget=this}catch(i){var n={type:e,detail:t.detail,dispatcher:this};return this.dispatchEvent(n)}var r=this._eventListeners[e];if(null!==r&&void 0!==r)for(var o=this._copyArray(r),s=o.length,a=0;s>a;a++){var u=o[a];u.call(this,t)}return this},s.dispatchCustomEvent=function(t,e){var i;return n?(i=document.createEvent("CustomEvent"),i.dispatcher=this,i.initCustomEvent(t,!1,!1,e)):i={type:t,detail:e,dispatcher:this},this.dispatchEvent(i)},s._destroy=function(){if(null!==this._eventListeners){for(var t in this._eventListeners)if(this._eventListeners.hasOwnProperty(t)){for(var e=this._eventListeners[t],i=e.length,n=0;i>n;n++)e[n]=null;delete this._eventListeners[t]}this._eventListeners=null}},s._copyArray=function(t){for(var e=new Array(t.length),i=e.length,n=0;i>n;n++)e[n]=t[n];return e},e.exports=i},{}],8:[function(t,e){"use strict";var i=t("gl-matrix"),n=function(t,e,i){this._vertexA=t,this._vertexB=e,this._vertexC=i,this._init()},r=n.prototype;r._init=function(){var t=i.vec3.create(),e=i.vec3.create();i.vec3.sub(t,this._vertexB,this._vertexA),i.vec3.sub(e,this._vertexC,this._vertexA),this._faceNormal=i.vec3.create(),i.vec3.cross(this._faceNormal,t,e),i.vec3.normalize(this._faceNormal,this._faceNormal)},r.contains=function(t){return o(t,this._vertexA)||o(t,this._vertexB)||o(t,this._vertexC)},r.__defineGetter__("faceNormal",function(){return this._faceNormal});var o=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]};e.exports=n},{"gl-matrix":2}],9:[function(t,e){"use strict";var i,n=t("./GLTools"),r=t("./GLTexture"),o=function(t){return 0!==t&&!(t&t-1)},s=function(t,e,r){i=n.gl,r=r||{},this.width=t,this.height=e,this.magFilter=r.magFilter||i.LINEAR,this.minFilter=r.minFilter||i.LINEAR,this.wrapS=r.wrapS||i.MIRRORED_REPEAT,this.wrapT=r.wrapT||i.MIRRORED_REPEAT,o(t)&&o(e)||(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)),this._init()},a=s.prototype;a._init=function(){if(this.texture=i.createTexture(),this.glTexture=new r(this.texture,!0),this.frameBuffer=i.createFramebuffer(),i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer),this.frameBuffer.width=this.width,this.frameBuffer.height=this.height,i.bindTexture(i.TEXTURE_2D,this.texture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),n.depthTextureExt?i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,i.RGBA,i.FLOAT,null):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.frameBuffer.width,this.frameBuffer.height,0,i.RGBA,i.FLOAT,null),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0),null===n.depthTextureExt){var t=i.createRenderbuffer();i.bindRenderbuffer(i.RENDERBUFFER,t),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_COMPONENT16,this.frameBuffer.width,this.frameBuffer.height),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,this.texture,0),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,t)}else this.depthTexture=i.createTexture(),this.glDepthTexture=new r(this.depthTexture,!0),i.bindTexture(i.TEXTURE_2D,this.depthTexture),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,i.DEPTH_COMPONENT,this.width,this.height,0,i.DEPTH_COMPONENT,i.UNSIGNED_SHORT,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,this.depthTexture,0);i.bindTexture(i.TEXTURE_2D,null),i.bindRenderbuffer(i.RENDERBUFFER,null),i.bindFramebuffer(i.FRAMEBUFFER,null)},a.bind=function(){i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer)},a.unbind=function(){i.bindFramebuffer(i.FRAMEBUFFER,null)},a.getTexture=function(){return this.glTexture},a.getDepthTexture=function(){return this.glDepthTexture},a.destroy=function(){i.deleteFramebuffer(this.frameBuffer),this.glTexture.destroy(),this.glDepthTexture&&this.glDepthTexture.destroy()},e.exports=s},{"./GLTexture":11,"./GLTools":12}],10:[function(t,e){"use strict";var i,n=t("./GLTools"),r=t("./ShaderLibs"),o=function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")},s=function(t,e){i=n.gl,this.idVertex=t,this.idFragment=e,this.parameters=[],this.uniformValues={},this.uniformTextures=[],this.vertexShader=void 0,this.fragmentShader=void 0,this._isReady=!1,this._loadedCount=0,(void 0===t||null===t)&&this.createVertexShaderProgram(r.getShader("copyVert")),(void 0===e||null===t)&&this.createFragmentShaderProgram(r.getShader("copyFrag")),this.init()},a=s.prototype;a.init=function(){this.idVertex&&this.idVertex.indexOf("main(void)")>-1?this.createVertexShaderProgram(this.idVertex):this.getShader(this.idVertex,!0),this.idFragment&&this.idFragment.indexOf("main(void)")>-1?this.createFragmentShaderProgram(this.idFragment):this.getShader(this.idFragment,!1)
},a.getShader=function(t,e){if(t){var i=new XMLHttpRequest;i.hasCompleted=!1;var n=this;i.onreadystatechange=function(t){4===t.target.readyState&&(e?n.createVertexShaderProgram(t.target.responseText):n.createFragmentShaderProgram(t.target.responseText))},i.open("GET",t,!0),i.send(null)}},a.createVertexShaderProgram=function(t){if(i){var e=i.createShader(i.VERTEX_SHADER);if(i.shaderSource(e,t),i.compileShader(e),!i.getShaderParameter(e,i.COMPILE_STATUS))return console.warn("Error in Vertex Shader : ",this.idVertex,":",i.getShaderInfoLog(e)),console.log(o(t)),null;this.vertexShader=e,void 0!==this.vertexShader&&void 0!==this.fragmentShader&&this.attachShaderProgram(),this._loadedCount++}},a.createFragmentShaderProgram=function(t){if(i){var e=i.createShader(i.FRAGMENT_SHADER);if(i.shaderSource(e,t),i.compileShader(e),!i.getShaderParameter(e,i.COMPILE_STATUS))return console.warn("Error in Fragment Shader: ",this.idFragment,":",i.getShaderInfoLog(e)),console.log(o(t)),null;this.fragmentShader=e,void 0!==this.vertexShader&&void 0!==this.fragmentShader&&this.attachShaderProgram(),this._loadedCount++}},a.attachShaderProgram=function(){this._isReady=!0,this.shaderProgram=i.createProgram(),i.attachShader(this.shaderProgram,this.vertexShader),i.attachShader(this.shaderProgram,this.fragmentShader),i.linkProgram(this.shaderProgram)},a.bind=function(){this._isReady&&(i.useProgram(this.shaderProgram),void 0===this.shaderProgram.pMatrixUniform&&(this.shaderProgram.pMatrixUniform=i.getUniformLocation(this.shaderProgram,"uPMatrix")),void 0===this.shaderProgram.mvMatrixUniform&&(this.shaderProgram.mvMatrixUniform=i.getUniformLocation(this.shaderProgram,"uMVMatrix")),n.setShader(this),n.setShaderProgram(this.shaderProgram),this.uniformTextures=[])},a.isReady=function(){return this._isReady},a.clearUniforms=function(){this.parameters=[],this.uniformValues={}},a.uniform=function(t,e,n){if(this._isReady){"texture"===e&&(e="uniform1i");for(var r,o=!1,s=0;s<this.parameters.length;s++)if(r=this.parameters[s],r.name===t){r.value=n,o=!0;break}if(o?this.shaderProgram[t]=r.uniformLoc:(this.shaderProgram[t]=i.getUniformLocation(this.shaderProgram,t),this.parameters.push({name:t,type:e,value:n,uniformLoc:this.shaderProgram[t]})),-1===e.indexOf("Matrix"))if(o)this.checkUniform(t,e,n)&&i[e](this.shaderProgram[t],n);else{var a=Array.isArray(n);this.uniformValues[t]=a?n.concat():n,i[e](this.shaderProgram[t],n)}else i[e](this.shaderProgram[t],!1,n),o||(i[e](this.shaderProgram[t],!1,n),this.uniformValues[t]=n);"uniform1i"===e&&(this.uniformTextures[n]=this.shaderProgram[t])}},a.checkUniform=function(t,e,i){var n=Array.isArray(i);if(!this.uniformValues[t])return this.uniformValues[t]=i,!0;if("uniform1i"===e)return this.uniformValues[t]=i,!0;var r=this.uniformValues[t],o=!1;if(n){for(var s=0;s<r.length;s++)if(r[s]!==i[s]){o=!0;break}}else o=r!==i;return o&&(this.uniformValues[t]=n?i.concat():i),o},a.unbind=function(){},a.destroy=function(){i.detachShader(this.shaderProgram,this.vertexShader),i.detachShader(this.shaderProgram,this.fragmentShader),i.deleteShader(this.vertexShader),i.deleteShader(this.fragmentShader),i.deleteProgram(this.shaderProgram)},e.exports=s},{"./GLTools":12,"./ShaderLibs":19}],11:[function(t,e){"use strict";var i,n=t("./GLTools"),r=function(t){var e=0!==t&&!(t&t-1);return e},o=function(t){var e=t.width||t.videoWidth,i=t.height||t.videoHeight;return e&&i?r(e)&&r(i):!1},s=function(t,e,r){if(e=e||!1,r=r||{},i=n.gl,e)this.texture=t;else{this._source=t,this.texture=i.createTexture(),this._isVideo="VIDEO"===t.tagName,this.magFilter=r.magFilter||i.LINEAR,this.minFilter=r.minFilter||i.LINEAR_MIPMAP_NEAREST,this.wrapS=r.wrapS||i.MIRRORED_REPEAT,this.wrapT=r.wrapT||i.MIRRORED_REPEAT;var s=t.width||t.videoWidth;s?o(t)||(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)):(this.wrapS=this.wrapT=i.CLAMP_TO_EDGE,this.minFilter===i.LINEAR_MIPMAP_NEAREST&&(this.minFilter=i.LINEAR)),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,this.wrapS),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,this.wrapT),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)}},a=s.prototype;a.updateTexture=function(t){t&&(this._source=t),i.bindTexture(i.TEXTURE_2D,this.texture),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,this.magFilter),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,this.minFilter),this.minFilter===i.LINEAR_MIPMAP_NEAREST&&i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)},a.bind=function(t){void 0===t&&(t=0),n.shader&&(i.activeTexture(i.TEXTURE0+t),i.bindTexture(i.TEXTURE_2D,this.texture),i.uniform1i(n.shader.uniformTextures[t],t),this._bindIndex=t)},a.unbind=function(){i.bindTexture(i.TEXTURE_2D,null)},a.destroy=function(){i.deleteTexture(this.texture)},e.exports=s},{"./GLTools":12}],12:[function(t,e){"use strict";function i(){this.aspectRatio=1,this.fieldOfView=45,this.zNear=5,this.zFar=3e3,this.canvas=null,this.gl=null,this.shader=null,this.shaderProgram=null}var n=t("gl-matrix"),r=i.prototype;r.init=function(t,e,i,r){null===this.canvas&&(this.canvas=t||document.createElement("canvas"));var o=r||{};o.antialias=!0,this.gl=this.canvas.getContext("webgl",o)||this.canvas.getContext("experimental-webgl",o),console.log("GL TOOLS : ",this.gl),void 0!==e&&void 0!==i?this.setSize(e,i):this.setSize(window.innerWidth,window.innerHeight),this.gl.viewport(0,0,this.gl.viewportWidth,this.gl.viewportHeight),this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.clearColor(0,0,0,1),this.gl.clearDepth(1),this.matrix=n.mat4.create(),n.mat4.identity(this.matrix),this.normalMatrix=n.mat3.create(),this.depthTextureExt=this.gl.getExtension("WEBKIT_WEBGL_depth_texture"),this.floatTextureExt=this.gl.getExtension("OES_texture_float"),this.floatTextureLinearExt=this.gl.getExtension("OES_texture_float_linear"),this.standardDerivativesExt=this.gl.getExtension("OES_standard_derivatives"),this.enabledVertexAttribute=[],this.enableAlphaBlending(),this._viewport=[0,0,this.width,this.height]},r.getGL=function(){return this.gl},r.setShader=function(t){this.shader=t},r.setShaderProgram=function(t){this.shaderProgram=t},r.setViewport=function(t,e,i,n){var r=!1;t!==this._viewport[0]&&(r=!0),e!==this._viewport[1]&&(r=!0),i!==this._viewport[2]&&(r=!0),n!==this._viewport[3]&&(r=!0),r&&(this.gl.viewport(t,e,i,n),this._viewport=[t,e,i,n])},r.setMatrices=function(t){this.camera=t},r.rotate=function(t){n.mat4.copy(this.matrix,t),n.mat4.multiply(this.matrix,this.camera.getMatrix(),this.matrix),n.mat3.fromMat4(this.normalMatrix,this.matrix),n.mat3.invert(this.normalMatrix,this.normalMatrix),n.mat3.transpose(this.normalMatrix,this.normalMatrix)},r.enableAlphaBlending=function(){this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)},r.enableAdditiveBlending=function(){this.gl.blendFunc(this.gl.ONE,this.gl.ONE)},r.clear=function(t,e,i,n){this.gl.clearColor(t,e,i,n),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)},r.draw=function(t){function e(t,e,i){return void 0===e.cacheAttribLoc&&(e.cacheAttribLoc={}),void 0===e.cacheAttribLoc[i]&&(e.cacheAttribLoc[i]=t.getAttribLocation(e,i)),e.cacheAttribLoc[i]}if(!this.shaderProgram)return void console.warn("Shader program not ready yet");if(this.shaderProgram.pMatrixValue){var i=this.camera.projection||this.camera.getMatrix();n.mat4.str(this.shaderProgram.pMatrixValue)!==n.mat4.str(i)&&(this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.camera.projection||this.camera.getMatrix()),n.mat4.copy(this.shaderProgram.pMatrixValue,i))}else this.shaderProgram.pMatrixValue=n.mat4.create(),this.gl.uniformMatrix4fv(this.shaderProgram.pMatrixUniform,!1,this.camera.projection||this.camera.getMatrix()),n.mat4.copy(this.shaderProgram.pMatrixValue,this.camera.projection||this.camera.getMatrix());this.shaderProgram.mvMatrixValue?n.mat4.str(this.shaderProgram.mvMatrixValue)!==n.mat4.str(this.matrix)&&(this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix),n.mat4.copy(this.shaderProgram.mvMatrixValue,this.matrix)):(this.shaderProgram.mvMatrixValue=n.mat4.create(),this.gl.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.matrix),n.mat4.copy(this.shaderProgram.mvMatrixValue,this.matrix)),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.vBufferPos);var r=e(this.gl,this.shaderProgram,"aVertexPosition");this.gl.vertexAttribPointer(r,t.vBufferPos.itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(r)&&(this.gl.enableVertexAttribArray(r),this.enabledVertexAttribute.push(r)),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.vBufferUV);var o=e(this.gl,this.shaderProgram,"aTextureCoord");this.gl.vertexAttribPointer(o,t.vBufferUV.itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(o)&&(this.gl.enableVertexAttribArray(o),this.enabledVertexAttribute.push(o)),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.iBuffer);for(var s=0;s<t.extraAttributes.length;s++){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t.extraAttributes[s].buffer);var a=e(this.gl,this.shaderProgram,t.extraAttributes[s].name);this.gl.vertexAttribPointer(a,t.extraAttributes[s].itemSize,this.gl.FLOAT,!1,0,0),-1===this.enabledVertexAttribute.indexOf(a)&&(this.gl.enableVertexAttribArray(a),this.enabledVertexAttribute.push(a))}t.drawType===this.gl.POINTS?this.gl.drawArrays(t.drawType,0,t.vertexSize):this.gl.drawElements(t.drawType,t.iBuffer.numItems,this.gl.UNSIGNED_SHORT,0)},r.setSize=function(t,e){this._width=t,this._height=e,this.canvas.width=this._width,this.canvas.height=this._height,this.gl.viewportWidth=this._width,this.gl.viewportHeight=this._height,this.gl.viewport(0,0,this._width,this._height),this.aspectRatio=this._width/this._height},r.__defineGetter__("width",function(){return this._width}),r.__defineGetter__("height",function(){return this._height}),r.__defineGetter__("viewport",function(){return this._viewport});var o=null;i.getInstance=function(){return null===o&&(o=new i),o},e.exports=i.getInstance()},{"gl-matrix":2}],13:[function(t,e){"use strict";var i=t("./Face"),n=t("./GLTools"),r=t("gl-matrix"),o=function(t,e,i){this.gl=n.gl,this.vertexSize=t,this.indexSize=e,this.drawType=i,this.extraAttributes=[],this.vBufferPos=void 0,this._floatArrayVertex=void 0,this._init()},s=o.prototype;s._init=function(){},s.bufferVertex=function(t,e){var i=[],n=e?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW;this._vertices=[];for(var o=0;o<t.length;o++){for(var s=0;s<t[o].length;s++)i.push(t[o][s]);this._vertices.push(r.vec3.clone(t[o]))}if(void 0===this.vBufferPos&&(this.vBufferPos=this.gl.createBuffer()),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferPos),void 0===this._floatArrayVertex)this._floatArrayVertex=new Float32Array(i);else if(t.length!==this._floatArrayVertex.length)this._floatArrayVertex=new Float32Array(i);else for(var a=0;a<t.length;a++)this._floatArrayVertex[a]=t[a];this.gl.bufferData(this.gl.ARRAY_BUFFER,this._floatArrayVertex,n),this.vBufferPos.itemSize=3},s.bufferTexCoords=function(t){for(var e=[],i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++)e.push(t[i][n]);this.vBufferUV=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vBufferUV),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(e),this.gl.STATIC_DRAW),this.vBufferUV.itemSize=2},s.bufferData=function(t,e,i,n){var r=-1,o=n?this.gl.DYNAMIC_DRAW:this.gl.STATIC_DRAW,s=0;for(s=0;s<this.extraAttributes.length;s++)if(this.extraAttributes[s].name===e){this.extraAttributes[s].data=t,r=s;break}var a=[];for(s=0;s<t.length;s++)for(var u=0;u<t[s].length;u++)a.push(t[s][u]);var h,c;if(-1===r)h=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h),c=new Float32Array(a),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,o),this.extraAttributes.push({name:e,data:t,itemSize:i,buffer:h,floatArray:c});else{for(h=this.extraAttributes[r].buffer,this.gl.bindBuffer(this.gl.ARRAY_BUFFER,h),c=this.extraAttributes[r].floatArray,s=0;s<a.length;s++)c[s]=a[s];this.gl.bufferData(this.gl.ARRAY_BUFFER,c,o)}},s.bufferIndices=function(t){this._indices=t,this.iBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.iBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t),this.gl.STATIC_DRAW),this.iBuffer.itemSize=1,this.iBuffer.numItems=t.length},s.computeNormals=function(){if(this.drawType===this.gl.TRIANGLES){void 0===this._faces&&this._generateFaces(),console.log("Start computing");var t=(new Date).getTime(),e=0;this._normals=[];for(var i=0;i<this._vertices.length;i++){var n=r.vec3.create(),o=0;for(e=0;e<this._faces.length;e++)this._faces[e].contains(this._vertices[i])&&(r.vec3.add(n,n,this._faces[e].faceNormal),o++);r.vec3.normalize(n,n),this._normals.push(n)}this.bufferData(this._normals,"aNormal",3);var s=(new Date).getTime()-t;console.log("Total Time : ",s)}},s.computeTangent=function(){},s._generateFaces=function(){this._faces=[];for(var t=0;t<this._indices.length;t+=3){var e=this._vertices[this._indices[t+0]],n=this._vertices[this._indices[t+1]],r=this._vertices[this._indices[t+2]];this._faces.push(new i(e,n,r))}},e.exports=o},{"./Face":8,"./GLTools":12,"gl-matrix":2}],14:[function(t,e){"use strict";var i=t("./GLTools"),n=t("./Mesh"),r={};r.createPlane=function(t,e,r,o,s){s=void 0===s?"xy":s,o=void 0===o?!1:o;for(var a=[],u=[],h=[],c=[],f=t/r,l=e/r,d=1/r,p=0,v=.5*-t,_=.5*-e,m=0;r>m;m++)for(var g=0;r>g;g++){var x=f*m+v,y=l*g+_;"xz"===s?(a.push([x,0,y+l]),a.push([x+f,0,y+l]),a.push([x+f,0,y]),a.push([x,0,y]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0])):"yz"===s?(a.push([0,x,y]),a.push([0,x+f,y]),a.push([0,x+f,y+l]),a.push([0,x,y+l]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0])):(a.push([x,y,0]),a.push([x+f,y,0]),a.push([x+f,y+l,0]),a.push([x,y+l,0]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]));var T=m/r,M=g/r;u.push([T,M]),u.push([T+d,M]),u.push([T+d,M+d]),u.push([T,M+d]),h.push(4*p+0),h.push(4*p+1),h.push(4*p+2),h.push(4*p+0),h.push(4*p+2),h.push(4*p+3),p++}var b=new n(a.length,h.length,i.gl.TRIANGLES);return b.bufferVertex(a),b.bufferTexCoords(u),b.bufferIndices(h),o&&b.bufferData(c,"aNormal",3),b},r.createSphere=function(t,e,r){r=void 0===r?!1:r;for(var o=[],s=[],a=[],u=[],h=0,c=1/e,f=function(i,n,r){r=void 0===r?!1:r;var o=i/e*Math.PI-.5*Math.PI,s=n/e*Math.PI*2,a=r?1:t,u=[];u[1]=Math.sin(o)*a;var h=Math.cos(o)*a;u[0]=Math.cos(s)*h,u[2]=Math.sin(s)*h;var c=1e4;return u[0]=Math.floor(u[0]*c)/c,u[1]=Math.floor(u[1]*c)/c,u[2]=Math.floor(u[2]*c)/c,u},l=0;e>l;l++)for(var d=0;e>d;d++){o.push(f(l,d)),o.push(f(l+1,d)),o.push(f(l+1,d+1)),o.push(f(l,d+1)),r&&(u.push(f(l,d,!0)),u.push(f(l+1,d,!0)),u.push(f(l+1,d+1,!0)),u.push(f(l,d+1,!0)));var p=d/e,v=l/e;s.push([1-p,v]),s.push([1-p,v+c]),s.push([1-p-c,v+c]),s.push([1-p-c,v]),a.push(4*h+0),a.push(4*h+1),a.push(4*h+2),a.push(4*h+0),a.push(4*h+2),a.push(4*h+3),h++}var _=new n(o.length,a.length,i.gl.TRIANGLES);return _.bufferVertex(o),_.bufferTexCoords(s),_.bufferIndices(a),console.log("With normals :",r),r&&_.bufferData(u,"aNormal",3),_},r.createCube=function(t,e,r,o){o=void 0===o?!1:o,e=e||t,r=r||t;var s=t/2,a=e/2,u=r/2,h=[],c=[],f=[],l=[],d=0;h.push([-s,a,-u]),h.push([s,a,-u]),h.push([s,-a,-u]),h.push([-s,-a,-u]),l.push([0,0,-1]),l.push([0,0,-1]),l.push([0,0,-1]),l.push([0,0,-1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([s,a,-u]),h.push([s,a,u]),h.push([s,-a,u]),h.push([s,-a,-u]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([s,a,u]),h.push([-s,a,u]),h.push([-s,-a,u]),h.push([s,-a,u]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,a,u]),h.push([-s,a,-u]),h.push([-s,-a,-u]),h.push([-s,-a,u]),l.push([-1,0,0]),l.push([-1,0,0]),l.push([-1,0,0]),l.push([-1,0,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,a,u]),h.push([s,a,u]),h.push([s,a,-u]),h.push([-s,a,-u]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++,h.push([-s,-a,-u]),h.push([s,-a,-u]),h.push([s,-a,u]),h.push([-s,-a,u]),l.push([0,-1,0]),l.push([0,-1,0]),l.push([0,-1,0]),l.push([0,-1,0]),c.push([0,0]),c.push([1,0]),c.push([1,1]),c.push([0,1]),f.push(4*d+0),f.push(4*d+1),f.push(4*d+2),f.push(4*d+0),f.push(4*d+2),f.push(4*d+3),d++;var p=new n(h.length,f.length,i.gl.TRIANGLES);return p.bufferVertex(h),p.bufferTexCoords(c),p.bufferIndices(f),o&&p.bufferData(l,"aNormal",3),p},e.exports=r},{"./GLTools":12,"./Mesh":13}],15:[function(t,e){"use strict";function i(){this._clearAll()}var n,r=t("./GLTools"),o=t("./Mesh"),s=i.prototype;s._clearAll=function(){this._callback=null,this._callbackError=null,this._mesh=[],this._drawingType=""},s.load=function(t,e,i,o,s){this._clearAll(),n||(n=r.gl),this._drawingType=void 0===s?n.TRIANGLES:s,this._ignoreNormals=void 0===o?!0:o,this._callback=e,this._callbackError=i;var a=new XMLHttpRequest;a.onreadystatechange=this._onXHTPState.bind(this),a.open("GET",t,!0),a.send()},s._onXHTPState=function(t){4===t.target.readyState&&this._parseObj(t.target.response)},s.parse=function(t,e,i,r,o){this._clearAll(),this._drawingType=void 0===o?n.TRIANGLES:o,this._ignoreNormals=void 0===r?!0:r,this._parseObj(t)},s._parseObj=function(t){function e(t){var e=parseInt(t);return 3*(e>=0?e-1:e+d.length/3)}function i(t){var e=parseInt(t);return 3*(e>=0?e-1:e+p.length/3)}function n(t){var e=parseInt(t);return 2*(e>=0?e-1:e+v.length/2)}function r(t,e,i){c.push([d[t],d[t+1],d[t+2]]),c.push([d[e],d[e+1],d[e+2]]),c.push([d[i],d[i+1],d[i+2]]),_.push(3*m+0),_.push(3*m+1),_.push(3*m+2),m++}function o(t,e,i){f.push([v[t],v[t+1]]),f.push([v[e],v[e+1]]),f.push([v[i],v[i+1]])}function s(t,e,i){l.push([p[t],p[t+1],p[t+2]]),l.push([p[e],p[e+1],p[e+2]]),l.push([p[i],p[i+1],p[i+2]])}function a(t,a,u,h,c,f,l,d,p,v,_,m){var g,x=e(t),y=e(a),T=e(u);void 0===h?r(x,y,T):(g=e(h),r(x,y,g),r(y,T,g)),void 0!==c&&(x=n(c),y=n(f),T=n(l),void 0===h?o(x,y,T):(g=n(d),o(x,y,g),o(y,T,g))),void 0!==p&&(x=i(p),y=i(v),T=i(_),void 0===h?s(x,y,T):(g=i(m),s(x,y,g),s(y,T,g)))}for(var u,h=t.split("\n"),c=[],f=[],l=[],d=[],p=[],v=[],_=[],m=0,g=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,x=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,y=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,T=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,M=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,b=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,E=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,w=0;w<h.length;w++){var A=h[w];A=A.trim(),0!==A.length&&"#"!==A.charAt(0)&&(null!==(u=g.exec(A))?d.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])):null!==(u=x.exec(A))?p.push(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])):null!==(u=y.exec(A))?v.push(parseFloat(u[1]),parseFloat(u[2])):null!==(u=T.exec(A))?a(u[1],u[2],u[3],u[4]):null!==(u=M.exec(A))?a(u[2],u[5],u[8],u[11],u[3],u[6],u[9],u[12]):null!==(u=b.exec(A))?a(u[2],u[6],u[10],u[14],u[3],u[7],u[11],u[15],u[4],u[8],u[12],u[16]):null!==(u=E.exec(A))&&a(u[2],u[5],u[8],u[11],void 0,void 0,void 0,void 0,u[3],u[6],u[9],u[12]))}this._generateMeshes({positions:c,coords:f,normals:l,indices:_})},s._generateMeshes=function(t){n=r.gl;var e=new o(t.positions.length,t.indices.length,this._drawingType);e.bufferVertex(t.positions),e.bufferTexCoords(t.coords),e.bufferIndices(t.indices),this._ignoreNormals||e.bufferData(t.normals,"aNormal",3),this._callback&&this._callback(e,t)},e.exports=i},{"./GLTools":12,"./Mesh":13}],16:[function(t,e){"use strict";function i(t){void 0===t&&(t=document),this._isRotateZ=0,this.matrix=n.mat4.create(),this.m=n.mat4.create(),this._vZaxis=n.vec3.clone([0,0,0]),this._zAxis=n.vec3.clone([0,0,-1]),this.preMouse={x:0,y:0},this.mouse={x:0,y:0},this._isMouseDown=!1,this._rotation=n.quat.clone([0,0,1,0]),this.tempRotation=n.quat.clone([0,0,0,0]),this._rotateZMargin=0,this.diffX=0,this.diffY=0,this._currDiffX=0,this._currDiffY=0,this._offset=.004,this._easing=.1,this._slerp=-1,this._isLocked=!1;var e=this;t.addEventListener("mousedown",function(t){e._onMouseDown(t)}),t.addEventListener("touchstart",function(t){e._onMouseDown(t)}),t.addEventListener("mouseup",function(t){e._onMouseUp(t)}),t.addEventListener("touchend",function(t){e._onMouseUp(t)}),t.addEventListener("mousemove",function(t){e._onMouseMove(t)}),t.addEventListener("touchmove",function(t){e._onMouseMove(t)})}var n=t("gl-matrix"),r=i.prototype;r.inverseControl=function(t){this._isInvert=void 0===t?!0:t},r.lock=function(t){this._isLocked=void 0===t?!0:t},r.getMousePos=function(t){var e,i;return void 0!==t.changedTouches?(e=t.changedTouches[0].pageX,i=t.changedTouches[0].pageY):(e=t.clientX,i=t.clientY),{x:e,y:i}},r._onMouseDown=function(t){if(!this._isLocked&&!this._isMouseDown){var e=this.getMousePos(t),i=n.quat.clone(this._rotation);this._updateRotation(i),this._rotation=i,this._isMouseDown=!0,this._isRotateZ=0,this.preMouse={x:e.x,y:e.y},e.y<this._rotateZMargin||e.y>window.innerHeight-this._rotateZMargin?this._isRotateZ=1:(e.x<this._rotateZMargin||e.x>window.innerWidth-this._rotateZMargin)&&(this._isRotateZ=2),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0}},r._onMouseMove=function(t){this._isLocked||(t.touches&&t.preventDefault(),this.mouse=this.getMousePos(t))},r._onMouseUp=function(){this._isLocked||this._isMouseDown&&(this._isMouseDown=!1)},r.setCameraPos=function(t,e){if(e=e||this._easing,this._easing=e,!(this._slerp>0)){var i=n.quat.clone(this._rotation);this._updateRotation(i),this._rotation=n.quat.clone(i),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0,this._isMouseDown=!1,this._isRotateZ=0,this._targetQuat=n.quat.clone(t),this._slerp=1}},r.resetQuat=function(){this._rotation=n.quat.clone([0,0,1,0]),this.tempRotation=n.quat.clone([0,0,0,0]),this._targetQuat=void 0,this._slerp=-1},r.update=function(){n.mat4.identity(this.m),void 0===this._targetQuat?(n.quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=.1*(0-this._slerp),this._slerp<.001?(n.quat.set(this._rotation,this._targetQuat[0],this._targetQuat[1],this._targetQuat[2],this._targetQuat[3]),this._targetQuat=void 0,this._slerp=-1):(n.quat.set(this.tempRotation,0,0,0,0),n.quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp))),n.vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation),n.mat4.fromQuat(this.matrix,this.tempRotation)},r._updateRotation=function(t){this._isMouseDown&&!this._isLocked&&(this.diffX=-(this.mouse.x-this.preMouse.x),this.diffY=this.mouse.y-this.preMouse.y,this._isInvert&&(this.diffX=-this.diffX,this.diffY=-this.diffY)),this._currDiffX+=(this.diffX-this._currDiffX)*this._easing,this._currDiffY+=(this.diffY-this._currDiffY)*this._easing;var e,i;if(this._isRotateZ>0)1===this._isRotateZ?(e=-this._currDiffX*this._offset,e*=this.preMouse.y<this._rotateZMargin?-1:1,i=n.quat.clone([0,0,Math.sin(e),Math.cos(e)]),n.quat.multiply(i,t,i)):(e=-this._currDiffY*this._offset,e*=this.preMouse.x<this._rotateZMargin?1:-1,i=n.quat.clone([0,0,Math.sin(e),Math.cos(e)]),n.quat.multiply(i,t,i));else{var r=n.vec3.clone([this._currDiffX,this._currDiffY,0]),o=n.vec3.create();n.vec3.cross(o,r,this._zAxis),n.vec3.normalize(o,o),e=n.vec3.length(r)*this._offset,i=n.quat.clone([Math.sin(e)*o[0],Math.sin(e)*o[1],Math.sin(e)*o[2],Math.cos(e)]),n.quat.multiply(t,i,t)}},e.exports=i},{"gl-matrix":2}],17:[function(t,e){"use strict";var i=t("./GLTools"),n=t("./QuatRotation"),r=t("./CameraOrtho"),o=t("./SimpleCamera"),s=t("gl-matrix"),a=function(){null!==i.canvas&&(this.gl=i.gl,this._children=[],this._init())},u=a.prototype;u._init=function(){this.camera=new o(i.canvas),this.camera.setPerspective(45*Math.PI/180,i.aspectRatio,5,3e3),this.camera.lockRotation();var t=s.vec3.clone([0,0,500]),e=s.vec3.create(),a=s.vec3.clone([0,-1,0]);this.camera.lookAt(t,e,a),this.sceneRotation=new n(i.canvas),this.rotationFront=s.mat4.create(),s.mat4.identity(this.rotationFront),this.cameraOrtho=new r,this.cameraOrthoScreen=new r,this.cameraOtho=this.cameraOrtho,this.cameraOrtho.lookAt(t,e,a),this.cameraOrtho.ortho(1,-1,1,-1),this.cameraOrthoScreen.lookAt(t,e,a),this.cameraOrthoScreen.ortho(0,i.width,i.height,0),this._initTextures(),this._initViews(),window.addEventListener("resize",this._onResize.bind(this))},u._initTextures=function(){},u._initViews=function(){},u.loop=function(){this.update(),this.render()},u.update=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.sceneRotation.update(),i.setViewport(0,0,i.width,i.height),i.setMatrices(this.camera),i.rotate(this.sceneRotation.matrix)},u.resize=function(){},u.render=function(){},u._onResize=function(){this.cameraOrthoScreen.ortho(0,i.width,i.height,0)},e.exports=a},{"./CameraOrtho":4,"./GLTools":12,"./QuatRotation":16,"./SimpleCamera":20,"gl-matrix":2}],18:[function(t,e){"use strict";function i(){this.FRAMERATE=60,this._delayTasks=[],this._nextTasks=[],this._deferTasks=[],this._highTasks=[],this._usurpTask=[],this._enterframeTasks=[],this._idTable=0,window.requestAnimFrame(this._loop.bind(this))}void 0===window.requestAnimFrame&&(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}());var n=i.prototype;n._loop=function(){window.requestAnimFrame(this._loop.bind(this)),this._process()},n._process=function(){var t,e,i,n=0;for(n=0;n<this._enterframeTasks.length;n++)t=this._enterframeTasks[n],null!==t&&void 0!==t&&t.func.apply(t.scope,t.params);for(;this._highTasks.length>0;)t=this._highTasks.pop(),t.func.apply(t.scope,t.params);var r=(new Date).getTime();for(n=0;n<this._delayTasks.length;n++)t=this._delayTasks[n],r-t.time>t.delay&&(t.func.apply(t.scope,t.params),this._delayTasks.splice(n,1));for(r=(new Date).getTime(),e=1e3/this.FRAMERATE;this._deferTasks.length>0;){if(t=this._deferTasks.shift(),i=(new Date).getTime(),!(e>i-r)){this._deferTasks.unshift(t);break}t.func.apply(t.scope,t.params)}for(r=(new Date).getTime(),e=1e3/this.FRAMERATE;this._usurpTask.length>0&&(t=this._usurpTask.shift(),i=(new Date).getTime(),e>i-r);)t.func.apply(t.scope,t.params);this._highTasks=this._highTasks.concat(this._nextTasks),this._nextTasks=[],this._usurpTask=[]},n.addEF=function(t,e,i){i=i||[];var n=this._idTable;return this._enterframeTasks[n]={scope:t,func:e,params:i},this._idTable++,n},n.removeEF=function(t){return void 0!==this._enterframeTasks[t]&&(this._enterframeTasks[t]=null),-1},n.delay=function(t,e,i,n){var r=(new Date).getTime(),o={scope:t,func:e,params:i,delay:n,time:r};this._delayTasks.push(o)},n.defer=function(t,e,i){var n={scope:t,func:e,params:i};this._deferTasks.push(n)},n.next=function(t,e,i){var n={scope:t,func:e,params:i};this._nextTasks.push(n)},n.usurp=function(t,e,i){var n={scope:t,func:e,params:i};this._usurpTask.push(n)};var r=null;i.getInstance=function(){return null===r&&(r=new i),r},e.exports=i.getInstance()},{}],19:[function(t,e){"use strict";var i=function(){};i.shaders={},i.shaders.copyVert="#define GLSLIFY 1\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i.shaders.copyNormalVert="#define GLSLIFY 1\n\n// copyWithNormals.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vVertex;\n\nvoid main(void) {\n	gl_Position   = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n	vTextureCoord = aTextureCoord;\n	vNormal       = aNormal;\n	vVertex 	  = aVertexPosition;\n}",i.shaders.generalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    vec3 pos = aVertexPosition;\n    pos *= scale;\n    pos += position;\n    gl_Position = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i.shaders.generalNormalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n	vec3 pos      = aVertexPosition;\n	pos           *= scale;\n	pos           += position;\n	gl_Position   = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n	vTextureCoord = aTextureCoord;\n	\n	vNormal       = aNormal;\n	vVertex       = pos;\n}",i.shaders.generalWithNormalVert="#define GLSLIFY 1\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n	vec3 pos      = aVertexPosition;\n	pos           *= scale;\n	pos           += position;\n	gl_Position   = uPMatrix * uMVMatrix * vec4(pos, 1.0);\n	vTextureCoord = aTextureCoord;\n	\n	vNormal       = aNormal;\n	vVertex       = pos;\n}",i.shaders.copyFrag="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n}\n",i.shaders.alphaFrag="#define GLSLIFY 1\n\n#define SHADER_NAME TEXTURE_WITH_ALPHA\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n    gl_FragColor.a *= opacity;\n}",i.shaders.simpleColorFrag="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_COLOR_FRAGMENT\n\nprecision highp float;\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = vec4(color, opacity);\n}",i.shaders.depthFrag="#define GLSLIFY 1\n\nprecision highp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform float n;\nuniform float f;\n\nfloat getDepth(float z) {\n	return (6.0 * n) / (f + n - z*(f-n));\n}\n\nvoid main(void) {\n    float r = texture2D(texture, vTextureCoord).r;\n    float grey = getDepth(r);\n    gl_FragColor = vec4(grey, grey, grey, 1.0);\n}",i.shaders.simpleCopyLighting="#define GLSLIFY 1\n\n#define SHADER_NAME SIMPLE_TEXTURE_LIGHTING\n\nprecision highp float;\n\nuniform vec3 ambient;\nuniform vec3 lightPosition;\nuniform vec3 lightColor;\nuniform float lightWeight;\n\nuniform sampler2D texture;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n	vec3 L        = normalize(lightPosition-vVertex);\n	float lambert = max(dot(vNormal, L), .0);\n	vec3 light    = ambient + lightColor * lambert * lightWeight;\n	vec4 color 	  = texture2D(texture, vTextureCoord);\n	color.rgb 	  *= light;\n	\n	gl_FragColor  = color;\n}",i.shaders.simpleColorLighting="#define GLSLIFY 1\n\n// simpleColorLighting.frag\n\n#define SHADER_NAME SIMPLE_COLOR_LIGHTING\n\nprecision highp float;\n\nuniform vec3 ambient;\nuniform vec3 lightPosition;\nuniform vec3 lightColor;\nuniform float lightWeight;\n\nuniform vec3 color;\nuniform float opacity;\n\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n	vec3 L        = normalize(lightPosition-vVertex);\n	float lambert = max(dot(vNormal, L), .0);\n	vec3 light    = ambient + lightColor * lambert * lightWeight;\n	\n	gl_FragColor  = vec4(color * light, opacity);\n}",i.getShader=function(t){return this.shaders[t]
},i.get=i.getShader,e.exports=i},{}],20:[function(t,e){"use strict";var i=t("gl-matrix"),n=t("./CameraPerspective"),r=t("./EaseNumber"),o=function(t){this._listenerTarget=t||window,n.call(this),this._init()},s=o.prototype=new n,a=n.prototype;s._init=function(){this.radius=new r(500),this.position[2]=this.radius.value,this.center=i.vec3.create(),this.up=i.vec3.clone([0,-1,0]),this.lookAt(this.position,this.center,this.up),this._mouse={},this._preMouse={},this._isMouseDown=!1,this._rx=new r(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new r(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this._listenerTarget.addEventListener("mousewheel",this._onWheel.bind(this)),this._listenerTarget.addEventListener("DOMMouseScroll",this._onWheel.bind(this)),this._listenerTarget.addEventListener("mousedown",this._onMouseDown.bind(this)),this._listenerTarget.addEventListener("touchstart",this._onMouseDown.bind(this)),this._listenerTarget.addEventListener("mousemove",this._onMouseMove.bind(this)),this._listenerTarget.addEventListener("touchmove",this._onMouseMove.bind(this)),window.addEventListener("mouseup",this._onMouseUp.bind(this)),window.addEventListener("touchend",this._onMouseUp.bind(this))},s.inverseControl=function(t){this._isInvert=void 0===t?!0:t},s.lock=function(t){void 0===t?(this._isLockZoom=!0,this._isLockRotation=!0):(this._isLockZoom=t,this._isLockRotation=t)},s.lockRotation=function(t){this._isLockRotation=void 0===t?!0:t},s.lockZoom=function(t){this._isLockZoom=void 0===t?!0:t},s._onMouseDown=function(t){this._isLockRotation||(this._isMouseDown=!0,u(t,this._mouse),u(t,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)},s._onMouseMove=function(t){if(!this._isLockRotation&&(u(t,this._mouse),t.touches&&t.preventDefault(),this._isMouseDown)){var e=this._mouse.x-this._preMouse.x;this._isInvert&&(e*=-1),this._ry.value=this._preRY-.01*e;var i=this._mouse.y-this._preMouse.y;this._isInvert&&(i*=-1),this._rx.value=this._preRX-.01*i}},s._onMouseUp=function(){this._isLockRotation||(this._isMouseDown=!1)},s._onWheel=function(t){if(!this._isLockZoom){var e=t.wheelDelta,i=t.detail,n=0;n=i?e?e/i/40*i>0?1:-1:-i/3:e/120,this.radius.add(5*-n)}},s.getMatrix=function(){return this._updateCameraPosition(),this.lookAt(this.position,this.center,this.up),a.getMatrix.call(this)},s._updateCameraPosition=function(){this.position[2]=this.radius.value,this.position[1]=Math.sin(this._rx.value)*this.radius.value;var t=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*t,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*t};var u=function(t,e){var i=e||{};return t.touches?(i.x=t.touches[0].pageX,i.y=t.touches[0].pageY):(i.x=t.clientX,i.y=t.clientY),i};s.__defineGetter__("rx",function(){return this._rx.targetValue}),s.__defineSetter__("rx",function(t){this._rx.value=t}),s.__defineGetter__("ry",function(){return this._ry.targetValue}),s.__defineSetter__("ry",function(t){this._ry.value=t}),e.exports=o},{"./CameraPerspective":5,"./EaseNumber":6,"gl-matrix":2}],21:[function(t,e){"use strict";var i=function(){this._imgs={},this._loadedCount=0,this._toLoadCount=0,this._scope=void 0,this._callback=void 0,this._callbackProgress=void 0},n=i.prototype;n.load=function(t,e,i,n){this._imgs={},this._loadedCount=0,this._toLoadCount=t.length,this._scope=e,this._callback=i,this._callbackProgress=n,this._imgLoadedBind=this._onImageLoaded.bind(this);for(var r=0;r<t.length;r++){var o=new Image;o.onload=this._imgLoadedBind;var s=t[r],a=s.split("/"),u=a[a.length-1].split(".")[0];this._imgs[u]=o,o.src=s}},n._onImageLoaded=function(){if(this._loadedCount++,this._loadedCount===this._toLoadCount)this._callback.call(this._scope,this._imgs);else{var t=this._loadedCount/this._toLoadCount;this._callbackProgress&&this._callbackProgress.call(this._scope,t)}},e.exports=i},{}],22:[function(t,e){"use strict";var i=t("./GLShader"),n=function(t,e){this.shader=new i(t,e),this._init()},r=n.prototype;r._init=function(){},r.render=function(){},e.exports=n},{"./GLShader":10}],23:[function(t,e){"use strict";var i=t("./GLTools"),n=t("./View"),r=t("./Mesh"),o="precision highp float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;attribute vec3 aColor;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vTextureCoord;varying vec3 vColor;void main(void) {    gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);    vTextureCoord = aTextureCoord;    vColor = aColor;}",s="precision mediump float;varying vec3 vColor;void main(void) {    gl_FragColor = vec4(vColor, 1.0);}",a=function(t,e){this.lineWidth=void 0===t?2:t;var i=void 0===e?s:e;n.call(this,o,i)},u=a.prototype=new n;u._init=function(){var t=[],e=[],n=[],o=[0,1,2,3,4,5],s=9999;t.push([-s,0,0]),t.push([s,0,0]),t.push([0,-s,0]),t.push([0,s,0]),t.push([0,0,-s]),t.push([0,0,s]),e.push([1,0,0]),e.push([1,0,0]),e.push([0,1,0]),e.push([0,1,0]),e.push([0,0,1]),e.push([0,0,1]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),n.push([0,0]),this.mesh=new r(t.length,o.length,i.gl.LINES),this.mesh.bufferVertex(t),this.mesh.bufferTexCoords(n),this.mesh.bufferIndices(o),this.mesh.bufferData(e,"aColor",3,!1)},u.render=function(){this.shader.isReady()&&(this.shader.bind(),i.gl.lineWidth(this.lineWidth),i.draw(this.mesh),i.gl.lineWidth(1))},e.exports=a},{"./GLTools":12,"./Mesh":13,"./View":22}],24:[function(t,e){"use strict";var i=t("./View"),n=t("./GLTools"),r=t("./MeshUtils"),o=function(t,e){i.call(this,t,e)},s=o.prototype=new i;s._init=function(){n.gl&&(this.mesh=r.createPlane(2,2,1))},s.render=function(t){this.shader.isReady()&&(this.shader.bind(),this.shader.uniform("texture","uniform1i",0),t.bind(0),n.draw(this.mesh))},e.exports=o},{"./GLTools":12,"./MeshUtils":14,"./View":22}],25:[function(t,e){"use strict";var i=t("./GLTools"),n=t("./View"),r=t("./ShaderLibs"),o=t("./Mesh"),s=function(t,e){var i=.75;this.color=void 0===t?[i,i,i]:t;var o=void 0===e?r.get("simpleColorFrag"):e;n.call(this,null,o)},a=s.prototype=new n;a._init=function(){var t,e,n=[],r=[],s=[],a=0,u=100,h=3e3,c=h/u;for(t=-h/2;h>t;t+=c)for(e=-h/2;h>e;e+=c)n.push([t,e,0]),r.push([0,0]),s.push(a),a++,n.push([t,0,e]),r.push([0,0]),s.push(a),a++;this.mesh=new o(n.length,s.length,i.gl.DOTS),this.mesh.bufferVertex(n),this.mesh.bufferTexCoords(r),this.mesh.bufferIndices(s)},a.render=function(){this.shader.bind(),this.shader.uniform("color","uniform3fv",this.color),this.shader.uniform("opacity","uniform1f",1),i.draw(this.mesh)},e.exports=s},{"./GLTools":12,"./Mesh":13,"./ShaderLibs":19,"./View":22}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(t,e,i){(function(n){!function(t){if("object"==typeof i&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof n?r=n:"undefined"!=typeof self&&(r=self),r.Sono=t()}}(function(){var e;return function i(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var h="function"==typeof t&&t;if(!u&&h)return h(a,!0);if(s)return s(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[a]={exports:{}};e[a][0].call(f.exports,function(t){var i=e[a][1][t];return o(i?i:t)},f,f.exports,i,e,n,r)}return n[a].exports}for(var s="function"==typeof t&&t,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e){"use strict";function i(){this.VERSION="0.0.6",window.AudioContext=window.AudioContext||window.webkitAudioContext;var t=window.AudioContext?new window.AudioContext:null,e=t?t.destination:null;this._group=new o(t,e),this._gain=this._group.gain,this._sounds=this._group.sounds,this._context=t,h.setContext(t),this._handleTouchlock(),this._handlePageVisibility()}var n=t("./lib/utils/browser.js"),r=t("./lib/utils/file.js"),o=t("./lib/group.js"),s=t("./lib/utils/loader.js"),a=t("./lib/sound.js"),u=t("./lib/utils/sound-group.js"),h=t("./lib/utils/utils.js");i.prototype.createSound=function(t){if(r.containsURL(t))return this.load(t);var e=t&&t.noWebAudio?null:this._context,i=new a(e,this._gain);return i.isTouchLocked=this._isTouchLocked,t&&(i.data=t.data||t,i.id=void 0!==t.id?t.id:"",i.loop=!!t.loop,i.volume=t.volume),this._group.add(i),i},i.prototype.destroySound=function(t){return t?(this._sounds.some(function(e,i,n){return e===t||e.id===t?(n.splice(i,1),e.loader&&(e.loader.destroy(),e.loader=null),e.destroy(),!0):void 0}),this):void 0},i.prototype.destroyAll=function(){return this._group.destroy(),this},i.prototype.getSound=function(t){var e=null;return this._sounds.some(function(i){return i.id===t?(e=i,!0):void 0}),e},i.prototype.createGroup=function(t){var e=new u(this._context,this._gain);return t&&t.forEach(function(t){e.add(t)}),e},i.prototype.load=function(t){if(!t)throw new Error("ArgumentException: Sono.load: param config is undefined");var e,i,n=!!t.noWebAudio||!!t.asMediaElement,o=t.onProgress,a=t.onComplete,u=t.thisArg||t.context||this,h=t.url||t;if(r.containsURL(h))e=this._queue(t,n),i=e.loader;else{if(!Array.isArray(h)||!r.containsURL(h[0].url))return null;e=[],i=new s.Group,h.forEach(function(t){e.push(this._queue(t,n,i))},this)}return o&&i.onProgress.add(o,u),a&&i.onComplete.addOnce(function(){a.call(u,e)}),i.start(),e},i.prototype._queue=function(t,e,i){var n=r.getSupportedFile(t.url||t),o=t&&t.noWebAudio?null:this._context,u=new a(o,this._gain);u.isTouchLocked=this._isTouchLocked,this._group.add(u),u.id=void 0!==t.id?t.id:"",u.loop=!!t.loop,u.volume=t.volume;var h=new s(n);return h.audioContext=e?null:this._context,h.isTouchLocked=this._isTouchLocked,h.onBeforeComplete.addOnce(function(t){u.data=t}),u.loader=h,i&&i.add(h),u},i.prototype.mute=function(){return this._group.mute(),this},i.prototype.unMute=function(){return this._group.unMute(),this},Object.defineProperty(i.prototype,"volume",{get:function(){return this._group.volume},set:function(t){this._group.volume=t}}),i.prototype.fade=function(t,e){return this._group.fade(t,e),this},i.prototype.pauseAll=function(){return this._group.pause(),this},i.prototype.resumeAll=function(){return this._group.resume(),this},i.prototype.stopAll=function(){return this._group.stop(),this},i.prototype.play=function(t,e,i){return this.getSound(t).play(e,i),this},i.prototype.pause=function(t){return this.getSound(t).pause(),this},i.prototype.stop=function(t){return this.getSound(t).stop(),this},i.prototype._handleTouchlock=function(){var t=function(){this._isTouchLocked=!1,this._sounds.forEach(function(t){t.isTouchLocked=!1,t.loader&&(t.loader.isTouchLocked=!1)})};this._isTouchLocked=n.handleTouchLock(t,this)},i.prototype._handlePageVisibility=function(){function t(){r.forEach(function(t){t.playing&&(t.pause(),i.push(t))})}function e(){for(;i.length;)i.pop().play()}var i=[],r=this._sounds;n.handlePageVisibility(t,e,this)},i.prototype.log=function(){var t="Sono "+this.VERSION,e="Supported:"+this.isSupported+" WebAudioAPI:"+this.hasWebAudio+" TouchLocked:"+this._isTouchLocked+" Extensions:"+r.extensions;if(navigator.userAgent.indexOf("Chrome")>-1){var i=["%c ♫ "+t+" ♫ %c "+e+" ","color: #FFFFFF; background: #379F7A","color: #1F1C0D; background: #E0FBAC"];console.log.apply(console,i)}else window.console&&window.console.log.call&&console.log.call(console,t+" "+e)},Object.defineProperties(i.prototype,{canPlay:{get:function(){return r.canPlay}},context:{get:function(){return this._context}},effect:{get:function(){return this._group.effect}},extensions:{get:function(){return r.extensions}},hasWebAudio:{get:function(){return!!this._context}},isSupported:{get:function(){return r.extensions.length>0}},gain:{get:function(){return this._gain}},sounds:{get:function(){return this._group.sounds.slice(0)}},utils:{get:function(){return h}}}),e.exports=new i},{"./lib/group.js":14,"./lib/sound.js":15,"./lib/utils/browser.js":21,"./lib/utils/file.js":22,"./lib/utils/loader.js":23,"./lib/utils/sound-group.js":25,"./lib/utils/utils.js":26}],2:[function(t,i){!function(t){function n(t,e,i,n,r){this._listener=e,this._isOnce=i,this.context=n,this._signal=t,this._priority=r||0}function r(t,e){if("function"!=typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function o(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){o.prototype.dispatch.apply(t,arguments)}}n.prototype={active:!0,params:null,execute:function(t){var e,i;return this.active&&this._listener&&(i=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,i),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},o.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,i,r){var o,s=this._indexOfListener(t,i);if(-1!==s){if(o=this._bindings[s],o.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else o=new n(this,t,e,i,r),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(t){var e=this._bindings.length;do--e;while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){for(var i,n=this._bindings.length;n--;)if(i=this._bindings[n],i._listener===t&&i.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,i){return r(t,"add"),this._registerListener(t,!1,e,i)},addOnce:function(t,e,i){return r(t,"addOnce"),this._registerListener(t,!0,e,i)},remove:function(t,e){r(t,"remove");var i=this._indexOfListener(t,e);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),t},removeAll:function(){for(var t=this._bindings.length;t--;)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var t,e=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=e),i){t=this._bindings.slice(),this._shouldPropagate=!0;do i--;while(t[i]&&this._shouldPropagate&&t[i].execute(e)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var s=o;s.Signal=o,"function"==typeof e&&e.amd?e(function(){return s}):"undefined"!=typeof i&&i.exports?i.exports=s:t.signals=s}(this)},{}],3:[function(t,e){"use strict";function i(t){this._context=t||new s,this._destination=null,this._nodeList=[],this._sourceNode=null}var n=t("./effect/analyser.js"),r=t("./effect/distortion.js"),o=t("./effect/echo.js"),s=t("./effect/fake-context.js"),a=t("./effect/filter.js"),u=t("./effect/flanger.js"),h=t("./effect/panner.js"),c=t("./effect/phaser.js"),f=t("./effect/recorder.js"),l=t("./effect/reverb.js");i.prototype.add=function(t){return t?(this._nodeList.push(t),this._updateConnections(),t):void 0},i.prototype.remove=function(t){for(var e=this._nodeList.length,i=0;e>i;i++)if(t===this._nodeList[i]){this._nodeList.splice(i,1);break}var n=t._output||t;return n.disconnect(),this._updateConnections(),t},i.prototype.removeAll=function(){for(;this._nodeList.length;)this._nodeList.pop().disconnect();return this._updateConnections(),this},i.prototype.destroy=function(){this._context=null,this._destination=null,this._nodeList=[],this._sourceNode=null},i.prototype._connect=function(t,e){var i=t._output||t;i.disconnect(),i.connect(e)},i.prototype._connectToDestination=function(t){var e=this._nodeList.length,i=e?this._nodeList[e-1]:this._sourceNode;i&&this._connect(i,t),this._destination=t},i.prototype._updateConnections=function(){if(this._sourceNode){for(var t,e,i=0;i<this._nodeList.length;i++)t=this._nodeList[i],e=0===i?this._sourceNode:this._nodeList[i-1],this._connect(e,t);this._destination&&this._connectToDestination(this._destination)}},Object.defineProperty(i.prototype,"panning",{get:function(){return this._panning||(this._panning=new h(this._context)),this._panning}}),i.prototype.analyser=function(t,e,i,r){var o=new n(this._context,t,e,i,r);return this.add(o)},i.prototype.compressor=function(t){t=t||{};var e=this._context.createDynamicsCompressor();return e.update=function(t){e.threshold.value=void 0!==t.threshold?t.threshold:-24,e.knee.value=void 0!==t.knee?t.knee:30,e.ratio.value=void 0!==t.ratio?t.ratio:12,e.reduction.value=void 0!==t.reduction?t.reduction:-10,e.attack.value=void 0!==t.attack?t.attack:3e-4,e.release.value=void 0!==t.release?t.release:.25},e.update(t),this.add(e)},i.prototype.convolver=function(t){var e=this._context.createConvolver();return e.buffer=t,this.add(e)},i.prototype.delay=function(t){var e=this._context.createDelay();return void 0!==t&&(e.delayTime.value=t),this.add(e)},i.prototype.echo=function(t,e){var i=new o(this._context,t,e);return this.add(i)},i.prototype.distortion=function(t){var e=new r(this._context,t);return this.add(e)},i.prototype.filter=function(t,e,i,n){var r=new a(this._context,t,e,i,n);return this.add(r)},i.prototype.lowpass=function(t,e,i){return this.filter("lowpass",t,e,i)},i.prototype.highpass=function(t,e,i){return this.filter("highpass",t,e,i)},i.prototype.bandpass=function(t,e,i){return this.filter("bandpass",t,e,i)},i.prototype.lowshelf=function(t,e,i){return this.filter("lowshelf",t,e,i)},i.prototype.highshelf=function(t,e,i){return this.filter("highshelf",t,e,i)},i.prototype.peaking=function(t,e,i){return this.filter("peaking",t,e,i)},i.prototype.notch=function(t,e,i){return this.filter("notch",t,e,i)},i.prototype.allpass=function(t,e,i){return this.filter("allpass",t,e,i)},i.prototype.flanger=function(t){var e=new u(this._context,t);return this.add(e)},i.prototype.gain=function(t){var e=this._context.createGain();return void 0!==t&&(e.gain.value=t),e},i.prototype.panner=function(){var t=new h(this._context);return this.add(t)},i.prototype.phaser=function(t){var e=new c(this._context,t);return this.add(e)},i.prototype.recorder=function(t){var e=new f(this._context,t);return this.add(e)},i.prototype.reverb=function(t,e,i){var n=new l(this._context,t,e,i);return this.add(n)},i.prototype.script=function(t){t=t||{};var e=t.bufferSize||1024,i=void 0===t.inputChannels?0:i,n=void 0===t.outputChannels?1:n,r=this._context.createScriptProcessor(e,i,n),o=t.thisArg||t.context||r,s=t.callback||function(){};return r.onaudioprocess=s.bind(o),this.add(r)},i.prototype.setSource=function(t){return this._sourceNode=t,this._updateConnections(),t},i.prototype.setDestination=function(t){return this._connectToDestination(t),t},e.exports=i},{"./effect/analyser.js":4,"./effect/distortion.js":5,"./effect/echo.js":6,"./effect/fake-context.js":7,"./effect/filter.js":8,"./effect/flanger.js":9,"./effect/panner.js":10,"./effect/phaser.js":11,"./effect/recorder.js":12,"./effect/reverb.js":13}],4:[function(t,e){"use strict";function i(t,e,i,n,r){e=e||32;var o,s,a=t.createAnalyser();a.fftSize=e,void 0!==i&&(a.smoothingTimeConstant=i),void 0!==n&&(a.minDecibels=n),void 0!==r&&(a.maxDecibels=r);var u=function(){(e!==a.fftSize||void 0===o)&&(o=new Uint8Array(a.fftSize),s=new Uint8Array(a.frequencyBinCount),e=a.fftSize)};return u(),a.getWaveform=function(){return u(),this.getByteTimeDomainData(o),o},a.getFrequencies=function(){return u(),this.getByteFrequencyData(s),s},Object.defineProperties(a,{smoothing:{get:function(){return a.smoothingTimeConstant},set:function(t){a.smoothingTimeConstant=t}}}),a}e.exports=i},{}],5:[function(t,e){"use strict";function i(t,e){e=e||1;var i=t.createWaveShaper();return i.update=function(t){e=t;for(var i,n=100*t,r=22050,o=new Float32Array(r),s=Math.PI/180,a=0;r>a;a++)i=2*a/r-1,o[a]=(3+n)*i*20*s/(Math.PI+n*Math.abs(i));this.curve=o},Object.defineProperties(i,{amount:{get:function(){return e},set:function(t){this.update(t)}}}),void 0!==e&&i.update(e),i}e.exports=i},{}],6:[function(t,e){"use strict";function i(t,e,i){var n=t.createGain(),r=t.createDelay(),o=t.createGain(),s=t.createGain();o.gain.value=i||.5,r.delayTime.value=e||.5,n.connect(r),n.connect(s),r.connect(o),o.connect(r),o.connect(s);var a=n;return a.name="Echo",a._output=s,Object.defineProperties(a,{delay:{get:function(){return r.delayTime.value},set:function(t){r.delayTime.value=t}},feedback:{get:function(){return o.gain.value},set:function(t){o.gain.value=t}}}),a}e.exports=i},{}],7:[function(t,e){"use strict";function i(){var t=Date.now(),e=function(){},i=function(){return{value:1,defaultValue:1,linearRampToValueAtTime:e,setValueAtTime:e,exponentialRampToValueAtTime:e,setTargetAtTime:e,setValueCurveAtTime:e,cancelScheduledValues:e}},n=function(){return{connect:e,disconnect:e,frequencyBinCount:0,smoothingTimeConstant:0,fftSize:0,minDecibels:0,maxDecibels:0,getByteTimeDomainData:e,getByteFrequencyData:e,getFloatTimeDomainData:e,getFloatFrequencyData:e,gain:i(),panningModel:0,setPosition:e,setOrientation:e,setVelocity:e,distanceModel:0,refDistance:0,maxDistance:0,rolloffFactor:0,coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,type:0,frequency:i(),delayTime:i(),buffer:0,threshold:i(),knee:i(),ratio:i(),attack:i(),release:i(),reduction:i(),oversample:0,curve:0,sampleRate:1,length:0,duration:0,numberOfChannels:0,getChannelData:function(){return[]},copyFromChannel:e,copyToChannel:e,dopplerFactor:0,speedOfSound:0,start:e}};return window.Uint8Array||(window.Int8Array=window.Uint8Array=window.Uint8ClampedArray=window.Int16Array=window.Uint16Array=window.Int32Array=window.Uint32Array=window.Float32Array=window.Float64Array=Array),{createAnalyser:n,createBuffer:n,createBiquadFilter:n,createChannelMerger:n,createChannelSplitter:n,createDynamicsCompressor:n,createConvolver:n,createDelay:n,createGain:n,createOscillator:n,createPanner:n,createScriptProcessor:n,createWaveShaper:n,listener:n(),get currentTime(){return(Date.now()-t)/1e3}}}e.exports=i},{}],8:[function(t,e){"use strict";function i(t,e,i,n,r){var o=40,s=t.sampleRate/2,a=t.createBiquadFilter();a.type=e,void 0!==i&&(a.frequency.value=i),void 0!==n&&(a.Q.value=n),void 0!==r&&(a.gain.value=r);var u=function(t){var e=Math.log(s/o)/Math.LN2,i=Math.pow(2,e*(t-1));return s*i};return a.update=function(t,e){void 0!==t&&(this.frequency.value=t),void 0!==e&&(this.gain.value=e)},a.setByPercent=function(t,e,i){a.frequency.value=u(t),void 0!==e&&(a.Q.value=e),void 0!==i&&(a.gain.value=i)},a}e.exports=i},{}],9:[function(t,e){"use strict";function i(t,e){var i=e.feedback||.5,n=e.delay||.005,r=e.gain||.002,o=e.frequency||.25,s=t.createGain(),a=t.createDelay(),u=t.createGain(),h=t.createOscillator(),c=t.createGain(),f=t.createGain();a.delayTime.value=n,u.gain.value=i,h.type="sine",h.frequency.value=o,c.gain.value=r,s.connect(f),s.connect(a),a.connect(f),a.connect(u),u.connect(s),h.connect(c),c.connect(a.delayTime),h.start(0);var l=s;return l.name="Flanger",l._output=f,Object.defineProperties(l,{delay:{get:function(){return a.delayTime.value},set:function(t){a.delayTime.value=t}},lfoFrequency:{get:function(){return h.frequency.value},set:function(t){h.frequency.value=t}},lfoGain:{get:function(){return c.gain.value},set:function(t){c.gain.value=t}},feedback:{get:function(){return u.gain.value},set:function(t){u.gain.value=t}}}),l}function n(t,e){var i=e.feedback||.5,n=e.delay||.003,r=e.gain||.005,o=e.frequency||.5,s=t.createGain(),a=t.createChannelSplitter(2),u=t.createChannelMerger(2),h=t.createGain(),c=t.createGain(),f=t.createOscillator(),l=t.createGain(),d=t.createGain(),p=t.createDelay(),v=t.createDelay(),_=t.createGain();h.gain.value=c.gain.value=i,p.delayTime.value=v.delayTime.value=n,f.type="sine",f.frequency.value=o,l.gain.value=r,d.gain.value=0-r,s.connect(a),a.connect(p,0),a.connect(v,1),p.connect(h),v.connect(c),h.connect(v),c.connect(p),p.connect(u,0,0),v.connect(u,0,1),u.connect(_),s.connect(_),f.connect(l),f.connect(d),l.connect(p.delayTime),d.connect(v.delayTime),f.start(0);var m=s;return m.name="StereoFlanger",m._output=_,Object.defineProperties(m,{delay:{get:function(){return p.delayTime.value},set:function(t){p.delayTime.value=v.delayTime.value=t}},lfoFrequency:{get:function(){return f.frequency.value},set:function(t){f.frequency.value=t}},lfoGain:{get:function(){return l.gain.value},set:function(t){l.gain.value=d.gain.value=t}},feedback:{get:function(){return h.gain.value},set:function(t){h.gain.value=c.gain.value=t}}}),m}function r(t,e){return e=e||{},e.stereo?new n(t,e):new i(t,e)}e.exports=r},{}],10:[function(t,e){"use strict";function i(t){var e=t.createPanner();e.panningModel=i.defaults.panningModel,e.distanceModel=i.defaults.distanceModel,e.refDistance=i.defaults.refDistance,e.maxDistance=i.defaults.maxDistance,e.rolloffFactor=i.defaults.rolloffFactor,e.coneInnerAngle=i.defaults.coneInnerAngle,e.coneOuterAngle=i.defaults.coneOuterAngle,e.coneOuterGain=i.defaults.coneOuterGain,e.setPosition(0,0,0),e.setOrientation(0,0,0);var n={pool:[],get:function(t,e,i){var n=this.pool.length?this.pool.pop():{x:0,y:0,z:0};return void 0!==t&&isNaN(t)&&"x"in t&&"y"in t&&"z"in t?(n.x=t.x||0,n.y=t.y||0,n.z=t.z||0):(n.x=t||0,n.y=e||0,n.z=i||0),n},dispose:function(t){this.pool.push(t)}},r=n.get(0,1,0),o=function(t,e){var i=n.get(e.x,e.y,e.z);u(i,r),u(i,e),h(i),h(e),t.setOrientation(e.x,e.y,e.z,i.x,i.y,i.z),n.dispose(e),n.dispose(i)},s=function(t,e){t.setPosition(e.x,e.y,e.z),n.dispose(e)},a=function(t,e){t.setVelocity(e.x,e.y,e.z),n.dispose(e)},u=function(t,e){var i=t.x,n=t.y,r=t.z,o=e.x,s=e.y,a=e.z;t.x=n*a-r*s,t.y=r*o-i*a,t.z=i*s-n*o},h=function(t){if(0===t.x&&0===t.y&&0===t.z)return t;var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=1/e;return t.x*=i,t.y*=i,t.z*=i,t};return e.setX=function(t){var i=Math.PI/4,n=2*i,r=t*i,o=r+n;o>n&&(o=Math.PI-o),r=Math.sin(r),o=Math.sin(o),e.setPosition(r,0,o)},e.setSourcePosition=function(t,i,r){s(e,n.get(t,i,r))},e.setSourceOrientation=function(t,i,r){o(e,n.get(t,i,r))},e.setSourceVelocity=function(t,i,r){a(e,n.get(t,i,r))},e.setListenerPosition=function(e,i,r){s(t.listener,n.get(e,i,r))},e.setListenerOrientation=function(e,i,r){o(t.listener,n.get(e,i,r))},e.setListenerVelocity=function(e,i,r){a(t.listener,n.get(e,i,r))},e.calculateVelocity=function(t,e,i){var r=t.x-e.x,o=t.y-e.y,s=t.z-e.z;return n.get(r/i,o/i,s/i)},e.setDefaults=function(t){Object.keys(t).forEach(function(e){i.defaults[e]=t[e]})},e}i.defaults={panningModel:"HRTF",distanceModel:"linear",refDistance:1,maxDistance:1e3,rolloffFactor:1,coneInnerAngle:360,coneOuterAngle:0,coneOuterGain:0},e.exports=i},{}],11:[function(t,e){"use strict";function i(t,e){e=e||{};var i,n=e.stages||8,r=e.frequency||.5,o=e.gain||300,s=e.feedback||.5,a=[],u=t.createGain(),h=t.createGain(),c=t.createOscillator(),f=t.createGain(),l=t.createGain();h.gain.value=s,c.type="sine",c.frequency.value=r,f.gain.value=o;for(var d=0;n>d;d++)i=t.createBiquadFilter(),i.type="allpass",i.frequency.value=1e3*d,d>0&&a[d-1].connect(i),f.connect(i.frequency),a.push(i);var p=a[0],v=a[a.length-1];u.connect(p),u.connect(l),v.connect(l),v.connect(h),h.connect(p),c.connect(f),c.start(0);var _=u;return _.name="Phaser",_._output=l,Object.defineProperties(_,{lfoFrequency:{get:function(){return c.frequency.value},set:function(t){c.frequency.value=t}},lfoGain:{get:function(){return f.gain.value},set:function(t){f.gain.value=t}},feedback:{get:function(){return h.gain.value},set:function(t){h.gain.value=t}}}),_}e.exports=i},{}],12:[function(t,e){"use strict";function i(t,e){var i=[],n=[],r=0,o=0,s=t.createGain(),a=t.createGain(),u=t.createScriptProcessor(4096,2,2);s.connect(u),u.connect(t.destination),u.connect(a);var h=s;h.name="Recorder",h._output=a,h.isRecording=!1;var c=function(){if(!i.length)return t.createBuffer(2,4096,t.sampleRate);var e=t.createBuffer(2,i.length,t.sampleRate);return e.getChannelData(0).set(i),e.getChannelData(1).set(n),e};return h.start=function(){i.length=0,n.length=0,r=t.currentTime,o=0,this.isRecording=!0},h.stop=function(){return o=t.currentTime,this.isRecording=!1,c()},h.getDuration=function(){return this.isRecording?t.currentTime-r:o-r},u.onaudioprocess=function(t){var r=t.inputBuffer.getChannelData(0),o=t.inputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(0),a=t.outputBuffer.getChannelData(0);if(e&&(s.set(r),a.set(o)),h.isRecording)for(var u=0;u<r.length;u++)i.push(r[u]),n.push(o[u])},h}e.exports=i},{}],13:[function(t,e){"use strict";function i(t,e){e=e||{};var i,n,r=e.time||1,o=e.decay||5,s=!!e.reverse,a=t.sampleRate,u=t.createGain(),h=t.createConvolver(),c=t.createGain();u.connect(h),u.connect(c),h.connect(c);var f=u;return f.name="Reverb",f._output=c,f.update=function(e){void 0!==e.time&&(r=e.time,i=a*r,n=t.createBuffer(2,i,a)),void 0!==e.decay&&(o=e.decay),void 0!==e.reverse&&(s=e.reverse);for(var u,c,f=n.getChannelData(0),l=n.getChannelData(1),d=0;i>d;d++)u=s?i-d:d,c=Math.pow(1-u/i,o),f[d]=(2*Math.random()-1)*c,l[d]=(2*Math.random()-1)*c;h.buffer=n},f.update({time:r,decay:o,reverse:s}),Object.defineProperties(f,{time:{get:function(){return r},set:function(t){t!==r&&this.update({time:r})}},decay:{get:function(){return o},set:function(t){t!==o&&this.update({decay:o})}},reverse:{get:function(){return s},set:function(t){t!==s&&this.update({reverse:!!t})}}}),f}e.exports=i},{}],14:[function(t,e){"use strict";function i(t,e){this._sounds=[],this._context=t,this._effect=new n(this._context),this._gain=this._effect.gain(),this._context&&(this._effect.setSource(this._gain),this._effect.setDestination(e||this._context.destination))}var n=t("./effect.js");i.prototype.add=function(t){t.gain.disconnect(),t.gain.connect(this._gain),this._sounds.push(t)},i.prototype.remove=function(t){this._sounds.some(function(e,i,n){return e===t||e.id===t?(n.splice(i,1),!0):void 0})},i.prototype.play=function(t,e){this._sounds.forEach(function(i){i.play(t,e)})},i.prototype.pause=function(){this._sounds.forEach(function(t){t.playing&&t.pause()})},i.prototype.resume=function(){this._sounds.forEach(function(t){t.paused&&t.play()})},i.prototype.stop=function(){this._sounds.forEach(function(t){t.stop()})},i.prototype.seek=function(t){this._sounds.forEach(function(e){e.seek(t)})},i.prototype.mute=function(){this._preMuteVolume=this.volume,this.volume=0},i.prototype.unMute=function(){this.volume=this._preMuteVolume||1},Object.defineProperty(i.prototype,"volume",{get:function(){return this._gain.gain.value},set:function(t){isNaN(t)||(this._context?(this._gain.gain.cancelScheduledValues(this._context.currentTime),this._gain.gain.value=t,this._gain.gain.setValueAtTime(t,this._context.currentTime)):this._gain.gain.value=t,this._sounds.forEach(function(e){e.context||(e.volume=t)}))}}),i.prototype.fade=function(t,e){if(this._context){var i=this._gain.gain,n=this._context.currentTime;i.cancelScheduledValues(n),i.setValueAtTime(i.value,n),i.linearRampToValueAtTime(t,n+e)}else this._sounds.forEach(function(i){i.fade(t,e)});return this},i.prototype.destroy=function(){for(;this._sounds.length;)this._sounds.pop().destroy()},Object.defineProperties(i.prototype,{effect:{get:function(){return this._effect}},gain:{get:function(){return this._gain}},sounds:{get:function(){return this._sounds}}}),e.exports=i},{"./effect.js":3}],15:[function(t,e){"use strict";function i(t,e){this.id="",this._context=t,this._data=null,this._endedCallback=null,this._isTouchLocked=!1,this._loop=!1,this._pausedAt=0,this._playbackRate=1,this._playWhenReady=null,this._source=null,this._startedAt=0,this._effect=new r(this._context),this._gain=this._effect.gain(),this._context&&(this._effect.setDestination(this._gain),this._gain.connect(e||this._context.destination))
}var n=t("./source/buffer-source.js"),r=t("./effect.js"),o=t("./utils/file.js"),s=t("./source/media-source.js"),a=t("./source/microphone-source.js"),u=t("./source/oscillator-source.js"),h=t("./source/script-source.js");i.prototype.play=function(t,e){return!this._source||this._isTouchLocked?(this._playWhenReady=function(){this.play(t,e)}.bind(this),this):(this._playWhenReady=null,this._effect.setSource(this._source.sourceNode),this._source.loop=this._loop,this._context||(this.volume=this._gain.gain.value),this._source.play(t,e),this)},i.prototype.pause=function(){return this._source?(this._source.pause(),this):this},i.prototype.stop=function(){return this._source?(this._source.stop(),this):this},i.prototype.seek=function(t){return this._source?(this.stop(),this.play(0,this._source.duration*t),this):this},i.prototype.fade=function(t,e){if(!this._source)return this;if(this._context){var i=this._gain.gain,n=this._context.currentTime;i.cancelScheduledValues(n),i.setValueAtTime(i.value,n),i.linearRampToValueAtTime(t,n+e)}else"function"==typeof this._source.fade&&this._source.fade(t,e);return this},i.prototype.onEnded=function(t,e){return this._endedCallback=t?t.bind(e||this):null,this},i.prototype._endedHandler=function(){"function"==typeof this._endedCallback&&this._endedCallback(this)},i.prototype.destroy=function(){this._source&&this._source.destroy(),this._effect&&this._effect.destroy(),this._gain&&this._gain.disconnect(),this._gain=null,this._context=null,this._data=null,this._endedCallback=null,this._playWhenReady=null,this._source=null,this._effect=null},i.prototype._createSource=function(t){if(o.isAudioBuffer(t))this._source=new n(t,this._context);else if(o.isMediaElement(t))this._source=new s(t,this._context);else if(o.isMediaStream(t))this._source=new a(t,this._context);else if(o.isOscillatorType(t))this._source=new u(t,this._context);else{if(!o.isScriptConfig(t))throw new Error("Cannot detect data type: "+t);this._source=new h(t,this._context)}this._effect.setSource(this._source.sourceNode),"function"==typeof this._source.onEnded&&this._source.onEnded(this._endedHandler,this),this._playWhenReady&&this._playWhenReady()},Object.defineProperties(i.prototype,{context:{get:function(){return this._context}},currentTime:{get:function(){return this._source?this._source.currentTime:0},set:function(t){this.stop(),this.play(0,t)}},data:{get:function(){return this._data},set:function(t){t&&(this._data=t,this._createSource(this._data))}},duration:{get:function(){return this._source?this._source.duration:0}},effect:{get:function(){return this._effect}},ended:{get:function(){return this._source?this._source.ended:!1}},frequency:{get:function(){return this._source?this._source.frequency:0},set:function(t){this._source&&(this._source.frequency=t)}},gain:{get:function(){return this._gain}},isTouchLocked:{set:function(t){this._isTouchLocked=t,!t&&this._playWhenReady&&this._playWhenReady()}},loop:{get:function(){return this._loop},set:function(t){this._loop=!!t,this._source&&(this._source.loop=this._loop)}},paused:{get:function(){return this._source?this._source.paused:!1}},playing:{get:function(){return this._source?this._source.playing:!1}},playbackRate:{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate=this._playbackRate)}},progress:{get:function(){return this._source?this._source.progress:0}},volume:{get:function(){return this._context?this._gain.gain.value:this._data&&void 0!==this._data.volume?this._data.volume:1},set:function(t){if(!isNaN(t)){var e=this._gain.gain;if(this._context){var i=this._context.currentTime;e.cancelScheduledValues(i),e.value=t,e.setValueAtTime(t,i)}else e.value=t,this._source&&window.clearTimeout(this._source.fadeTimeout),this._data&&void 0!==this._data.volume&&(this._data.volume=t)}}}}),e.exports=i},{"./effect.js":3,"./source/buffer-source.js":16,"./source/media-source.js":17,"./source/microphone-source.js":18,"./source/oscillator-source.js":19,"./source/script-source.js":20,"./utils/file.js":22}],16:[function(t,e){"use strict";function i(t,e){this.id="",this._buffer=t,this._context=e,this._ended=!1,this._endedCallback=null,this._loop=!1,this._paused=!1,this._pausedAt=0,this._playbackRate=1,this._playing=!1,this._sourceNode=null,this._startedAt=0}i.prototype.play=function(t,e){if(!this._playing){for(void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),void 0===e&&(e=0),e>0&&(this._pausedAt=0),this._pausedAt>0&&(e=this._pausedAt);e>this.duration;)e%=this.duration;this.sourceNode.loop=this._loop,this.sourceNode.onended=this._endedHandler.bind(this),this.sourceNode.start(t,e),this.sourceNode.playbackRate.value=this._playbackRate,this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime-e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!0}},i.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},i.prototype.stop=function(){if(this._sourceNode){this._sourceNode.onended=null;try{this._sourceNode.disconnect(),this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},i.prototype.onEnded=function(t,e){this._endedCallback=t?t.bind(e||this):null},i.prototype._endedHandler=function(){this.stop(),this._ended=!0,"function"==typeof this._endedCallback&&this._endedCallback(this)},i.prototype.destroy=function(){this.stop(),this._buffer=null,this._context=null,this._endedCallback=null,this._sourceNode=null},Object.defineProperties(i.prototype,{currentTime:{get:function(){if(this._pausedAt)return this._pausedAt;if(this._startedAt){var t=this._context.currentTime-this._startedAt;return t>this.duration&&(t%=this.duration),t}return 0}},duration:{get:function(){return this._buffer?this._buffer.duration:0}},ended:{get:function(){return this._ended}},loop:{get:function(){return this._loop},set:function(t){this._loop=!!t}},paused:{get:function(){return this._paused}},playbackRate:{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._sourceNode&&(this._sourceNode.playbackRate.value=this._playbackRate)}},playing:{get:function(){return this._playing}},progress:{get:function(){return this.duration?this.currentTime/this.duration:0}},sourceNode:{get:function(){return this._sourceNode||(this._sourceNode=this._context.createBufferSource(),this._sourceNode.buffer=this._buffer),this._sourceNode}}}),e.exports=i},{}],17:[function(t,e){"use strict";function i(t,e){this.id="",this._context=e,this._el=t,this._ended=!1,this._endedCallback=null,this._endedHandlerBound=this._endedHandler.bind(this),this._loop=!1,this._paused=!1,this._playbackRate=1,this._playing=!1,this._sourceNode=null}i.prototype.play=function(t,e){clearTimeout(this._delayTimeout),this.playbackRate=this._playbackRate,e&&(this._el.currentTime=e),t?this._delayTimeout=setTimeout(this.play.bind(this),t):this._el.play(),this._ended=!1,this._paused=!1,this._playing=!0,this._el.removeEventListener("ended",this._endedHandlerBound),this._el.addEventListener("ended",this._endedHandlerBound,!1)},i.prototype.pause=function(){clearTimeout(this._delayTimeout),this._el&&(this._el.pause(),this._playing=!1,this._paused=!0)},i.prototype.stop=function(){if(clearTimeout(this._delayTimeout),this._el){this._el.pause();try{this._el.currentTime=0,this._el.currentTime>0&&this._el.load()}catch(t){}this._playing=!1,this._paused=!1}},i.prototype.fade=function(t,e){if(!this._el)return this;if(this._context)return this;var i=function(t,e,n){var r=n._el;n.fadeTimeout=setTimeout(function(){return r.volume=r.volume+.2*(t-r.volume),Math.abs(r.volume-t)>.05?i(t,e,n):void(r.volume=t)},1e3*e)};return window.clearTimeout(this.fadeTimeout),i(t,e/10,this),this},i.prototype.onEnded=function(t,e){this._endedCallback=t?t.bind(e||this):null},i.prototype._endedHandler=function(){this._ended=!0,this._paused=!1,this._playing=!1,this._loop?(this._el.currentTime=0,this._el.currentTime>0&&this._el.load(),this.play()):"function"==typeof this._endedCallback&&this._endedCallback(this)},i.prototype.destroy=function(){this.stop(),this._el=null,this._context=null,this._endedCallback=null,this._endedHandlerBound=null,this._sourceNode=null},Object.defineProperties(i.prototype,{currentTime:{get:function(){return this._el?this._el.currentTime:0}},duration:{get:function(){return this._el?this._el.duration:0}},ended:{get:function(){return this._ended}},loop:{get:function(){return this._loop},set:function(t){this._loop=!!t}},paused:{get:function(){return this._paused}},playbackRate:{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._el&&(this._el.playbackRate=this._playbackRate)}},playing:{get:function(){return this._playing}},progress:{get:function(){return this.duration?this.currentTime/this.duration:0}},sourceNode:{get:function(){return!this._sourceNode&&this._context&&(this._sourceNode=this._context.createMediaElementSource(this._el)),this._sourceNode}}}),e.exports=i},{}],18:[function(t,e){"use strict";function i(t,e){this.id="",this._context=e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0,this._stream=t}i.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.start(t),this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._playing=!0,this._paused=!1,this._pausedAt=0},i.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},i.prototype.stop=function(){if(this._sourceNode){try{this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},i.prototype.destroy=function(){this.stop(),this._context=null,this._sourceNode=null,this._stream=null,window.mozHack=null},Object.defineProperties(i.prototype,{currentTime:{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}},duration:{get:function(){return 0}},ended:{get:function(){return this._ended}},frequency:{get:function(){return this._frequency},set:function(t){this._frequency=t,this._sourceNode&&(this._sourceNode.frequency.value=t)}},paused:{get:function(){return this._paused}},playing:{get:function(){return this._playing}},progress:{get:function(){return 0}},sourceNode:{get:function(){return this._sourceNode||(this._sourceNode=this._context.createMediaStreamSource(this._stream),navigator.mozGetUserMedia&&(window.mozHack=this._sourceNode)),this._sourceNode}}}),e.exports=i},{}],19:[function(t,e){"use strict";function i(t,e){this.id="",this._context=e,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0,this._type=t,this._frequency=200}i.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.start(t),this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._playing=!0,this._paused=!1,this._pausedAt=0},i.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},i.prototype.stop=function(){if(this._sourceNode){try{this._sourceNode.stop(0)}catch(t){}this._sourceNode=null}this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},i.prototype.destroy=function(){this.stop(),this._context=null,this._sourceNode=null},Object.defineProperties(i.prototype,{currentTime:{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}},duration:{get:function(){return 0}},ended:{get:function(){return this._ended}},frequency:{get:function(){return this._frequency},set:function(t){this._frequency=t,this._sourceNode&&(this._sourceNode.frequency.value=t)}},paused:{get:function(){return this._paused}},playing:{get:function(){return this._playing}},progress:{get:function(){return 0}},sourceNode:{get:function(){return!this._sourceNode&&this._context&&(this._sourceNode=this._context.createOscillator(),this._sourceNode.type=this._type,this._sourceNode.frequency.value=this._frequency),this._sourceNode}}}),e.exports=i},{}],20:[function(t,e){"use strict";function i(t,e){this.id="",this._bufferSize=t.bufferSize||1024,this._channels=t.channels||1,this._context=e,this._ended=!1,this._onProcess=t.callback.bind(t.thisArg||this),this._paused=!1,this._pausedAt=0,this._playing=!1,this._sourceNode=null,this._startedAt=0}i.prototype.play=function(t){void 0===t&&(t=0),t>0&&(t=this._context.currentTime+t),this.sourceNode.onaudioprocess=this._onProcess,this._startedAt=this._pausedAt?this._context.currentTime-this._pausedAt:this._context.currentTime,this._ended=!1,this._paused=!1,this._pausedAt=0,this._playing=!0},i.prototype.pause=function(){var t=this._context.currentTime-this._startedAt;this.stop(),this._pausedAt=t,this._playing=!1,this._paused=!0},i.prototype.stop=function(){this._sourceNode&&(this._sourceNode.onaudioprocess=this._onPaused),this._ended=!0,this._paused=!1,this._pausedAt=0,this._playing=!1,this._startedAt=0},i.prototype._onPaused=function(t){for(var e=t.outputBuffer,i=0,n=e.numberOfChannels;n>i;i++)for(var r=e.getChannelData(i),o=0,s=r.length;s>o;o++)r[o]=0},i.prototype.destroy=function(){this.stop(),this._context=null,this._onProcess=null,this._sourceNode=null},Object.defineProperties(i.prototype,{currentTime:{get:function(){return this._pausedAt?this._pausedAt:this._startedAt?this._context.currentTime-this._startedAt:0}},duration:{get:function(){return 0}},ended:{get:function(){return this._ended}},paused:{get:function(){return this._paused}},playing:{get:function(){return this._playing}},progress:{get:function(){return 0}},sourceNode:{get:function(){return!this._sourceNode&&this._context&&(this._sourceNode=this._context.createScriptProcessor(this._bufferSize,0,this._channels)),this._sourceNode}}}),e.exports=i},{}],21:[function(t,e){"use strict";var i={};i.handlePageVisibility=function(t,e,i){function n(){document[r]?t.call(i):e.call(i)}var r,o;"undefined"!=typeof document.hidden?(r="hidden",o="visibilitychange"):"undefined"!=typeof document.mozHidden?(r="mozHidden",o="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(r="msHidden",o="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(r="webkitHidden",o="webkitvisibilitychange"),void 0!==o&&document.addEventListener(o,n,!1)},i.handleTouchLock=function(t,e){var i=navigator.userAgent,n=!!i.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i),r=function(){if(document.body.removeEventListener("touchstart",r),this._context){var i=this._context.createBuffer(1,1,22050),n=this._context.createBufferSource();n.buffer=i,n.connect(this._context.destination),n.start(0)}t.call(e)}.bind(this);return n&&document.body.addEventListener("touchstart",r,!1),n},e.exports=i},{}],22:[function(t,e){"use strict";var i={extensions:[],canPlay:{}},n=[{ext:"ogg",type:'audio/ogg; codecs="vorbis"'},{ext:"mp3",type:"audio/mpeg;"},{ext:"opus",type:'audio/ogg; codecs="opus"'},{ext:"wav",type:'audio/wav; codecs="1"'},{ext:"m4a",type:"audio/x-m4a;"},{ext:"m4a",type:"audio/aac;"}],r=document.createElement("audio");r&&n.forEach(function(t){var e=!!r.canPlayType(t.type);e&&i.extensions.push(t.ext),i.canPlay[t.ext]=e}),i.getFileExtension=function(t){t=t.split("?")[0],t=t.substr(t.lastIndexOf("/")+1);var e=t.split(".");return 1===e.length||""===e[0]&&2===e.length?"":e.pop().toLowerCase()},i.getSupportedFile=function(t){var e;return Array.isArray(t)?t.some(function(t){e=t;var i=this.getFileExtension(t);return this.extensions.indexOf(i)>-1},this):"object"==typeof t&&Object.keys(t).some(function(i){e=t[i];var n=this.getFileExtension(e);return this.extensions.indexOf(n)>-1},this),e||t},i.isAudioBuffer=function(t){return!!(t&&window.AudioBuffer&&t instanceof window.AudioBuffer)},i.isMediaElement=function(t){return!!(t&&window.HTMLMediaElement&&t instanceof window.HTMLMediaElement)},i.isMediaStream=function(t){return!!(t&&"function"==typeof t.getAudioTracks&&t.getAudioTracks().length&&window.MediaStreamTrack&&t.getAudioTracks()[0]instanceof window.MediaStreamTrack)},i.isOscillatorType=function(t){return!(!t||"string"!=typeof t||"sine"!==t&&"square"!==t&&"sawtooth"!==t&&"triangle"!==t)},i.isScriptConfig=function(t){return!!(t&&"object"==typeof t&&t.bufferSize&&t.channels&&t.callback)},i.isURL=function(t){return!!(t&&"string"==typeof t&&t.indexOf(".")>-1)},i.containsURL=function(t){if(!t)return!1;var e=t.url||t;return this.isURL(e)||Array.isArray(e)&&this.isURL(e[0])},e.exports=i},{}],23:[function(t,e){"use strict";function i(t){var e,i,r,o,s,a=new n.Signal,u=new n.Signal,h=new n.Signal,c=new n.Signal,f=0,l=function(){e?d():p()},d=function(){r=new XMLHttpRequest,r.open("GET",t,!0),r.responseType="arraybuffer",r.onprogress=function(t){t.lengthComputable&&(f=t.loaded/t.total,a.dispatch(f))},r.onload=function(){e.decodeAudioData(r.response,function(t){s=t,r=null,f=1,a.dispatch(1),u.dispatch(t),h.dispatch(t)},function(t){c.dispatch(t)})},r.onerror=function(t){c.dispatch(t)},r.send()},p=function(){s=new Audio,s.preload="auto",s.src=t,i?(a.dispatch(1),u.dispatch(s),h.dispatch(s)):(window.clearTimeout(o),o=window.setTimeout(v,4e3),s.addEventListener("canplaythrough",v,!1),s.onerror=function(t){window.clearTimeout(o),c.dispatch(t)},s.load())},v=function(){window.clearTimeout(o),s&&(s.removeEventListener("canplaythrough",v),f=1,a.dispatch(1),u.dispatch(s),h.dispatch(s))},_=function(){r&&4!==r.readyState&&r.abort(),s&&"function"==typeof s.removeEventListener&&s.removeEventListener("canplaythrough",v),window.clearTimeout(o)},m=function(){_(),a.removeAll(),h.removeAll(),u.removeAll(),c.removeAll(),r=null,s=null,e=null},g={start:l,cancel:_,destroy:m,onProgress:a,onComplete:h,onBeforeComplete:u,onError:c};return Object.defineProperties(g,{data:{get:function(){return s}},progress:{get:function(){return f}},audioContext:{set:function(t){e=t}},isTouchLocked:{set:function(t){i=t}}}),Object.freeze(g)}var n=t("signals");i.Group=function(){var t=[],e=0,i=0,r=new n.Signal,o=new n.Signal,s=new n.Signal,a=function(e){return t.push(e),i++,e},u=function(){i=t.length,h()},h=function(){if(0===t.length)return void r.dispatch();var e=t.pop();e.onProgress.add(c),e.onBeforeComplete.addOnce(f),e.onError.addOnce(l),e.start()},c=function(t){var n=e+t;o.dispatch(n/i)},f=function(){e++,o.dispatch(e/i),h()},l=function(t){s.dispatch(t),h()};return Object.freeze({add:a,start:u,onProgress:o,onComplete:r,onError:s})},e.exports=i},{signals:2}],24:[function(t,e){"use strict";function i(t,e,i,n){navigator.getUserMedia_=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this._isSupported=!!navigator.getUserMedia_,this._stream=null,this._onConnected=t.bind(n||this),this._onDenied=e?e.bind(n||this):function(){},this._onError=i?i.bind(n||this):function(){}}i.prototype.connect=function(){if(this._isSupported){var t=this;return navigator.getUserMedia_({audio:!0},function(e){t._stream=e,t._onConnected(e)},function(e){"PermissionDeniedError"===e.name||"PERMISSION_DENIED"===e?t._onDenied():t._onError(e.message||e)}),this}},i.prototype.disconnect=function(){return this._stream&&(this._stream.stop(),this._stream=null),this},Object.defineProperties(i.prototype,{stream:{get:function(){return this._stream}},isSupported:{get:function(){return this._isSupported}}}),e.exports=i},{}],25:[function(t,e){"use strict";function i(t,e){n.call(this,t,e),this._src=null}var n=t("../group.js");i.prototype=Object.create(n.prototype),i.prototype.constructor=i,i.prototype.add=function(t){n.prototype.add.call(this,t),this._getSource()},i.prototype.remove=function(t){n.prototype.remove.call(this,t),this._getSource()},i.prototype._getSource=function(){this._sounds.length&&(this._sounds.sort(function(t,e){return e.duration-t.duration}),this._src=this._sounds[0])},Object.defineProperties(i.prototype,{currentTime:{get:function(){return this._src?this._src.currentTime:0},set:function(t){this.stop(),this.play(0,t)}},duration:{get:function(){return this._src?this._src.duration:0}},loop:{get:function(){return this._loop},set:function(t){this._loop=!!t,this._sounds.forEach(function(t){t.loop=this._loop})}},paused:{get:function(){return this._src?this._src.paused:!1}},progress:{get:function(){return this._src?this._src.progress:0}},playbackRate:{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._sounds.forEach(function(t){t.playbackRate=this._playbackRate})}},playing:{get:function(){return this._src?this._src.playing:!1}}}),e.exports=i},{"../group.js":14}],26:[function(t,e){"use strict";var i=t("./microphone.js"),n=t("./waveform.js"),r={};r.setContext=function(t){this._context=t},r.cloneBuffer=function(t){if(!this._context)return t;for(var e=t.numberOfChannels,i=this._context.createBuffer(e,t.length,t.sampleRate),n=0;e>n;n++)i.getChannelData(n).set(t.getChannelData(n));return i},r.reverseBuffer=function(t){for(var e=t.numberOfChannels,i=0;e>i;i++)Array.prototype.reverse.call(t.getChannelData(i));return t},r.ramp=function(t,e,i,n){this._context&&(t.setValueAtTime(e,this._context.currentTime),t.linearRampToValueAtTime(i,this._context.currentTime+n))},r.getFrequency=function(t){if(!this._context)return 0;var e=40,i=this._context.sampleRate/2,n=Math.log(i/e)/Math.LN2,r=Math.pow(2,n*(t-1));return i*r},r.microphone=function(t,e,n,r){return new i(t,e,n,r)},r.timeCode=function(t,e){void 0===e&&(e=":");var i=Math.floor(t/3600),n=Math.floor(t%3600/60),r=Math.floor(t%3600%60),o=0===i?"":10>i?"0"+i+e:i+e,s=(10>n?"0"+n:n)+e,a=10>r?"0"+r:r;return o+s+a},r.waveform=function(t,e){return new n(t,e)},e.exports=r},{"./microphone.js":24,"./waveform.js":27}],27:[function(t,e){"use strict";function i(){var t,e,i=function(i,n){if(!window.Float32Array||!window.AudioBuffer)return[];var r=i===t,o=e&&e.length===n;if(r&&o)return e;var s=new Float32Array(n),a=Math.floor(i.length/n),u=5,h=Math.floor(a/u),c=0;1>h&&(h=1);for(var f=0,l=i.numberOfChannels;l>f;f++)for(var d=i.getChannelData(f),p=0;n>p;p++)for(var v=p*a,_=v+a;_>v;v+=h){var m=d[v];0>m&&(m=-m),m>s[p]&&(s[p]=m),m>c&&(c=m)}var g=1/c,x=s.length;for(f=0;x>f;f++)s[f]*=g;return t=i,e=s,s},n=function(e){var i,n,r=e.canvas||document.createElement("canvas"),o=e.width||r.width,s=e.height||r.height,a=e.color||"#333333",u=e.bgColor||"#dddddd",h=e.sound?e.sound.data:e.buffer||t,c=this.compute(h,o),f=r.getContext("2d");f.strokeStyle=a,f.fillStyle=u,f.fillRect(0,0,o,s),f.beginPath();for(var l=0;l<c.length;l++)i=l+.5,n=s-Math.round(s*c[l]),f.moveTo(i,n),f.lineTo(i,s);return f.stroke(),r};return Object.freeze({compute:i,draw:n})}e.exports=i},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1]);